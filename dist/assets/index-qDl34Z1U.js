import{r as t,j as e,a as sr}from"./react-DShcIP8I.js";import{c as ar}from"./react-dom-xS-mgzEG.js";import{L as St,B as rr}from"./react-router-dom-Dr8YoiKC.js";import{a as U}from"./axios-Cm0UX6qg.js";import{u as gt,a as te,P as or}from"./react-redux-CqKOC3Qd.js";import{c as fs,a as lr}from"./@reduxjs-DVdFRU_h.js";import{u as ma,G as nr}from"./@react-oauth-BtmqNxGM.js";import{F as pa,I as $e,G as fa,a as Pt,b as It,c as ir,M as Ht,d as wt,A as cr,V as dr,e as Yt,L as Be,f as ga,g as xr,T as ur,h as hr,i as ja,j as ba,k as Ts,l as ya,m as mr,n as pr,o as fr,p as gr,q as Zt,P as jr,r as br}from"./react-icons-C9UidDMD.js";import{S as X}from"./sweetalert2-BlpH7Vtj.js";import{u as yr,F as st,a as at,b as Dt,c as va}from"./formik-yY4mcLwa.js";import{c as ut,a as Ne,b as vr,d as wa,e as Na,f as wr}from"./yup-Dt1-G-vV.js";import{l as Nr}from"./socket.io-client-DFi9RC7o.js";import{b as ye,d as gs,e as js,f as Pe,a as Ee,O as rt}from"./react-router-bnfcf_6y.js";import{_ as Cr,a as kr,b as Sr,c as Dr,I as Se,T as Lr,B as Tr,d as $r,A as Ca,e as ka,F as Er,f as Pr,g as Ir,h as _r,C as bs,U as Ar,i as qt,j as Gt,k as ys,W as Fr,l as Mr,m as Jt,n as vs,o as Sa,p as Da,q as La,D as Rr,L as Ta,r as zr,s as $a,t as Ea,u as ws,v as _t,w as Pa,x as Ur,y as $s,R as Br,z as Or,E as Wr,G as Hr,H as Ia,J as Yr,K as qr,M as Gr,N as Jr,O as Xr,P as _a,Q as Qr,S as Aa,V as Fa,X as Ma,Y as Zr,Z as Kr,$ as Vr,a0 as eo,a1 as to}from"./@ricons-Cuutmtcn.js";import{S as _e,B as Bt,P as Ce}from"./react-spinners-DGPQVzIw.js";import"./d3-transition-CT0P4Hy_.js";import{d as so}from"./d3-zoom-BYD4FFZ1.js";import{h as ao,c as ro}from"./d3-hierarchy-_Fih5j0Y.js";import{s as Kt}from"./d3-selection-DSeOx27A.js";import{l as oo}from"./d3-maatluEd.js";import{H as At}from"./@uiw-B0bNlYrA.js";import{T as he,A as Xe,a as Q,C as ot,D as Fe,b as Me,c as Re,d as Ze,e as ze,B as xe,f as jt,g as Ns,h as Cs,i as bt,F as ht,I as mt,S as Ie,M as J,L as Ve,j as Te,k as ce,l as pt,m as Ke,n as tt,s as lo,P as no,o as io,p as cs,q as Ra,r as co,t as yt,u as Ft,v as Es,w as Ps,x as ds,y as Is,z as xo,E as Nt}from"./@mui-DnVyVFsU.js";import{c as uo}from"./clsx-B-dksMZM.js";import{t as ho}from"./tailwind-merge-3VKOpVsw.js";import{u as mo,a as _s,b as As,m as Ue,A as Qe}from"./framer-motion-C8IFtl4e.js";import{f as po,a as Fs,b as Ms,c as Rs,d as zs,e as fo,g as Ct,h as Us,i as Vt,j as Bs,k as Os,l as go,m as Mt,n as Ws,o as jo,p as Je,q as bo,r as yo,s as vo,t as wo,u as No,v as $t,F as Hs,w as Co,x as ko,y as So}from"./@fortawesome-Cw3XWQ6a.js";import{S as nt,d as it}from"./react-syntax-highlighter-B_AZBLiT.js";import{I as Do}from"./@tabler-B6bwjIry.js";/* empty css                            */import{M as Xt}from"./react-markdown-BN7Xz9Rj.js";import{h as Lo}from"./moment-Cl4UOzQZ.js";import{F as To}from"./react-file-icon-D31-YPvO.js";import{T as $o}from"./react-d3-tree-B7_hivYh.js";import{d as Ys}from"./react-vertical-timeline-component-B2ggbE59.js";/* empty css                     */import"./@babel-AtFDC0j3.js";import"./scheduler-CzFDRTuY.js";import"./@remix-run-CcLa13UN.js";import"./use-sync-external-store-Dah2eIT9.js";import"./redux-DITMfSWq.js";import"./immer-BWU1mfoO.js";import"./reselect-BeKUwQU7.js";import"./redux-thunk-ClJT1hhx.js";import"./deepmerge-DhIoniG1.js";import"./lodash-es-DCVZfR6c.js";import"./react-fast-compare-BSScw1w7.js";import"./hoist-non-react-statics-DYJZ9X0p.js";import"./property-expr-DEi1ZLzV.js";import"./tiny-case-BJ7jYKNY.js";import"./toposort-0jXcZ2oA.js";import"./engine.io-client-DBBxzneW.js";import"./engine.io-parser-BiEtp6m2.js";import"./@socket.io-Dkula2eQ.js";import"./socket.io-parser-BBkuslX-.js";import"./@xicons-B4d3ivy3.js";import"./css-render-Blri6xsi.js";import"./d3-dispatch-kxCwF96_.js";import"./d3-timer-DdKHrDhs.js";import"./d3-interpolate-B6xYU604.js";import"./d3-color-9lF95FHy.js";import"./d3-ease-DRPgKoYJ.js";import"./d3-drag-_qOI58SM.js";import"./d3-path-CimkQT29.js";import"./react-is-DcfIKM1A.js";import"./react-transition-group-BhUYuH8Q.js";import"./@emotion-BKavt8ix.js";import"./stylis-NkKAe6Bn.js";import"./@popperjs-BQBsAJpH.js";import"./prop-types-Cx_m7Er_.js";import"./refractor-ByHYCCC_.js";import"./hastscript-CNav0U-G.js";import"./property-information-d_1UYrTS.js";import"./xtend-CeaPpq3n.js";import"./space-separated-tokens-CMBzgJJ4.js";import"./comma-separated-tokens-DgTuumFk.js";import"./hast-util-parse-selector-Cqsfuk9Y.js";import"./parse-entities-BPS6ijZJ.js";import"./character-entities-legacy-BW45UVHJ.js";import"./character-reference-invalid-AKrgFUtc.js";import"./is-decimal-Dxw1ZLrO.js";import"./is-hexadecimal-Bc6OsCR9.js";import"./is-alphanumerical-BsviXVJV.js";import"./is-alphabetical-BlcIJk-E.js";import"./devlop-Cl3hj7Sz.js";import"./unified-MsPVXQd8.js";import"./bail-FqpXQuLt.js";import"./extend-Zt7ocrVN.js";import"./is-plain-obj-C1gvLhAf.js";import"./trough-B_b8ryxu.js";import"./vfile-D1_tGWGU.js";import"./vfile-message-Bq256rVA.js";import"./unist-util-stringify-position-Ch_qCilz.js";import"./remark-parse-BcO66UuX.js";import"./mdast-util-from-markdown-CxqJRZL1.js";import"./micromark-util-decode-numeric-character-reference-CNs1qBpV.js";import"./micromark-util-decode-string-strjl-tx.js";import"./decode-named-character-reference-C3-224fz.js";import"./micromark-util-normalize-identifier-C9ANKk3v.js";import"./micromark-C8-o9avM.js";import"./micromark-util-combine-extensions-Bka6Sc1c.js";import"./micromark-util-chunked-DrRIdSP-.js";import"./micromark-factory-space-CA-Wq7KA.js";import"./micromark-util-character-Ch8j4vtg.js";import"./micromark-core-commonmark-LZ9hfcFB.js";import"./micromark-util-classify-character-GCpR5yWH.js";import"./micromark-util-resolve-all-PQCKh0dx.js";import"./micromark-util-subtokenize-QwsxNXk2.js";import"./micromark-factory-destination-CkgxUJuk.js";import"./micromark-factory-label-U15tx9Nh.js";import"./micromark-factory-title-reCpaPbc.js";import"./micromark-factory-whitespace-_v4v79HM.js";import"./micromark-util-html-tag-name-DbKNfynz.js";import"./mdast-util-to-string-DzL_e8Nz.js";import"./remark-rehype-wumJmxua.js";import"./mdast-util-to-hast-BfaRxxVW.js";import"./@ungap-DDJC10qW.js";import"./micromark-util-sanitize-uri-WGc3xW3f.js";import"./unist-util-position-60F3QETU.js";import"./trim-lines-D8znQY54.js";import"./unist-util-visit-DGoE-dKL.js";import"./unist-util-visit-parents-BC5uWo4u.js";import"./unist-util-is-D9KQvrmg.js";import"./hast-util-to-jsx-runtime-CBwOUO0Z.js";import"./style-to-object-CnAOdGdN.js";import"./inline-style-parser-D--Rb2MU.js";import"./hast-util-whitespace-D4Wp6AEg.js";import"./estree-util-is-identifier-name-Dp6szD92.js";import"./html-url-attributes-D46m5wfe.js";import"./colord-fQzusUms.js";import"./lodash.uniqueid-CmZfY-Ub.js";import"./dequal-CnqicUFC.js";import"./@bkrem-B-yLnVFm.js";import"./chain-function-CRlyLveg.js";import"./warning-BtSIKe8E.js";import"./react-lifecycles-compat-DMqWUqNa.js";import"./d3-shape-0Bul5OOZ.js";import"./uuid-8I8R7izr.js";import"./classnames-BarBPuyi.js";import"./react-intersection-observer-eInkB2gX.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const i of c)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function l(c){const i={};return c.integrity&&(i.integrity=c.integrity),c.referrerPolicy&&(i.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?i.credentials="include":c.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(c){if(c.ep)return;c.ep=!0;const i=l(c);fetch(c.href,i)}})();const Eo=a=>{const[s,l]=t.useState(a);return{...s,formState:s,onInputChange:({target:i})=>{const{name:d,value:g}=i;l({...s,[d]:g})},onResetForm:()=>{l(a)}}},Po={status:"not-authenticated",uid:"",email:"",username:"",photoUrl:"",description:"",followers:0,topProjects:[],website:"",github:"",linkedin:"",twitter:"",gitlabAuth:!1,errorMessage:"",state:!0},za=fs({name:"auth",initialState:Po,reducers:{login:(a,{payload:s})=>{console.log(s),a.status="authenticated",a.uid=s.uid,a.email=s.email,a.username=s.username,a.photoUrl=s.photoUrl||null,a.description=s.description||null,a.topProjects=s.topProjects||[],a.website=s.website||null,a.github=s.github||null,a.linkedin=s.linkedin||null,a.twitter=s.twitter||null,a.followers=s.followers||0,a.errorMessage=null,a.state=s.state},setGitlabAuth:(a,{payload:s})=>{a.gitlabAuth=s},logout:(a,{payload:s})=>{a.status="not-authenticated",a.uid=null,a.email=null,a.username=null,a.photoUrl=null,a.errorMessage=(s==null?void 0:s.msg)||null,a.state=(s==null?void 0:s.b)??null},checkingCredentials:a=>{a.status="checking"},setTopProjects:(a,{payload:s})=>{a.topProjects=s}}}),{login:ks,logout:ct,setGitlabAuth:yx,checkingCredentials:Io,setTopProjects:_o}=za.actions,Ss=()=>async a=>{a(Io())},Ua=a=>async s=>{if(s(Ss()),!a.status)return s(ct({errorMessage:"Email o Passwords Incorrectos"}));setTimeout(()=>{s(ks(a.user))},3e3)},Ba=a=>async s=>{if(s(Ss()),!a.status)return s(ct({msg:"Email o Passwords Incorrectos"}));setTimeout(()=>{s(ks(a.user))},2e3)},Ao=a=>async s=>{s(ks(a.user))},es="http://localhost:3000/api",Fo=()=>{const a=gt(),{errorMessage:s}=te(g=>g.auth),{onInputChange:l,email:o,password:c}=Eo({email:"",password:""}),i=async g=>{g.preventDefault();try{const h=await U.post(`${es}/auth/login`,{email:o,password:c});localStorage.setItem("x-token",h.data.tokenJWT),a(Ua(h.data))}catch(h){console.error(h.message),a(ct({msg:h.response.data.msg,b:!1}))}},d=ma({flow:"auth-code",onSuccess:async({code:g})=>{const{data:h}=await U.post(`${es}/auth/google`,{code:g});try{const f=await U.post(`${es}/auth/glogin`,{email:h.payload.email});localStorage.setItem("x-token",f.data.token),a(Ba(f.data))}catch(f){console.error("LoginForm Error message:",f.response.data.msg),a(ct({msg:f.response.data.msg,b:!1}))}},onError:g=>console.log(g)});return t.useEffect(()=>{s!==null&&(X.fire({title:"Error en la autenticación",text:s,icon:"error",customClass:{confirmButton:"my-confirm-button-class",cancelButton:"my-cancel-button-class"}}),a(ct({b:null})))},[s,a]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full bg-white p-8 rounded-lg shadow-md space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"PrJManager"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Please, login to continue."})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:i,children:[e.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"sr-only",children:"Nombre de usuario"}),e.jsx("input",{id:"email",name:"email",type:"text",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email",value:o,onChange:g=>l(g)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only",children:"Contraseña"}),e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password",value:c,onChange:g=>l(g)})]})]}),e.jsx("span",{className:"mr-2",children:"¿You don't have an account?"}),e.jsx(St,{to:"/register",className:"text-indigo-600 hover:text-indigo-800",children:"Register"}),e.jsxs("div",{className:"button-container",children:[e.jsx("button",{className:"btn-e",type:"submit",children:"Login"}),e.jsx("button",{className:"btn-g",onClick:d,children:e.jsx(pa,{className:"google-icon",size:20,style:{marginRight:"8px"}})})]})]})]})})},ts="http://localhost:3000/api",Mo=()=>{const a=gt(),s=ut({username:Ne().required("Required"),email:Ne().email("Invalid email").required("Required"),password:Ne().required("Required"),confirmPassword:Ne().oneOf([vr("password")],"Passwords must match").required("Required")}),l=yr({initialValues:{username:"",email:"",password:"",confirmPassword:""},validationSchema:s,onSubmit:async c=>{try{const i=await U.post(`${ts}/auth/register`,c);localStorage.setItem("x-token",i.data.token),a(Ua(i.data))}catch(i){console.error(i)}}}),o=ma({flow:"auth-code",onSuccess:async({code:c})=>{const{data:i}=await U.post(`${ts}/auth/google`,{code:c});try{const{data:d}=await U.post(`${ts}/auth/gregister`,{email:i.payload.email,username:i.payload.name,photoUrl:i.payload.picture,status:!0,google:!0});localStorage.setItem("x-token",d.token),a(Ba(d))}catch(d){console.error(d)}},onError:c=>console.log(c)});return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full bg-white p-8 rounded-lg shadow-md space-y-8",children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Register"}),e.jsxs("form",{onSubmit:l.handleSubmit,className:"mt-8 space-y-6",children:[e.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"sr-only",children:"Nombre de usuario"}),l.touched.username&&l.errors.username?e.jsx("div",{className:"text-red-500 text-sm mt-2 fade-in",children:l.errors.username}):null,e.jsx("input",{id:"username",type:"text",autoComplete:"username",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Username",...l.getFieldProps("username")})]}),l.touched.email&&l.errors.email?e.jsx("div",{className:"text-red-500 text-sm mt-2 fade-in",children:l.errors.email}):null,e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"sr-only",children:"Correo electrónico"}),e.jsx("input",{id:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email",...l.getFieldProps("email")})]}),l.touched.password&&l.errors.password?e.jsx("div",{className:"text-red-500 text-sm mt-2 fade-in",children:l.errors.password}):null,e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only",children:"Contraseña"}),e.jsx("input",{id:"password",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password",...l.getFieldProps("password")})]}),l.touched.confirmPassword&&l.errors.confirmPassword?e.jsx("div",{className:"text-red-500 text-sm mt-2 fade-in",children:l.errors.confirmPassword}):null,e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"sr-only",children:"Confirmar contraseña"}),e.jsx("input",{id:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Repeat Password",...l.getFieldProps("confirmPassword")})]})]}),e.jsx("span",{className:"mr-2",children:"¿You already have an account?"}),e.jsx(St,{to:"/login",className:"text-indigo-600 hover:text-indigo-800",children:"Log In"}),e.jsxs("div",{className:"button-container",children:[e.jsx("button",{className:"btn-e",type:"submit",children:"Login"}),e.jsx("button",{className:"btn-g",onClick:o,children:e.jsx(pa,{className:"google-icon",size:20,style:{marginRight:"8px"}})})]})]})]})})},Tt=()=>e.jsx("div",{className:"loader-container",children:e.jsx("div",{className:"loader"})}),Ro=a=>{const s=new URLSearchParams(a),l=s.get("code"),o=s.get("state");let c,i,d;if(o){const g=decodeURIComponent(o),h=JSON.parse(g);c=h.npmsocket,i=h.type,d=h.port}return{authCode:l,npmsocketid:c,type:i,port:d}},zo="http://localhost:3000/api",Oa=()=>{const[a,s]=t.useState(!0),l=t.useRef(null),[o,c]=t.useState(null),[i,d]=t.useState(!1),[g,h]=t.useState(null),f=ye(),{authCode:r,npmsocketid:S,type:T,port:L}=Ro(f.search),C=async N=>{if(!o||!i){console.log("Socket no está conectado");return}try{await U.post(`http://localhost:${L}/receive-code`,{code:N,FRONTENDTID:o.id}),o.on("authenticationResult",j=>{console.log(j),h(j.status.authStatus||j.status),s(!1),clearTimeout(l.current),o.close()}),l.current=setTimeout(()=>{a&&(h({success:!1,message:"Network error or timed out"}),s(!1),o.close())},6e4)}catch(j){console.error("Error al enviar el código:",j),h({success:!1,message:"Network error or timed out"}),s(!1)}},y=async()=>{if(!(!o||!i))try{const N=await U.post(`${zo}/auth/extension-auth-user`,{code:r}),{data:j}=N;j.status===!0?o.emit("onPrJCUPersistance",{type:"NPM",success:!0,npmsocketid:S,user:j.user,pat:j.pat,token:j.token},p=>{h(p),s(!1),clearTimeout(l.current),o.close()}):(o.emit("onPrJCUPersistance",{npmsocketid:S,success:!1,message:j.msg}),h({success:!1,message:j.msg||"There was an error during authentication"}),s(!1),clearTimeout(l.current),o.close()),l.current=setTimeout(()=>{a&&(h({success:!1,message:"Network error or timed out"}),s(!1),o.close())},6e4)}catch(N){const j=N;j.response?(o.emit("onPrJCUPersistance",{npmsocketid:S,success:!1,message:j.response.data.msg||"There was an error during authentication"}),h({success:!1,message:j.response.data.msg||"There was an error during authentication"}),s(!1),o.close()):(o.emit("onPrJCUPersistance",{npmsocketid:S,success:!1,message:"There was an error during authentication"}),h({success:!1,message:"There was an error during authentication"}),s(!1),o.close())}};return t.useEffect(()=>{const N=Nr("http://localhost:8081");return c(N),N.on("connect",()=>{d(!0)}),()=>{N.close()}},[]),t.useEffect(()=>{!g||typeof g.success>"u"||(g.success?(X.fire("Done!",g.message,"success"),setTimeout(()=>{window.close()},5e3)):X.fire("Error",g.message,"error"))},[g]),t.useEffect(()=>{switch(T){case"NPMAUTH":r&&i&&y();break;case"EXTAUTH":r&&i&&C(r);break}},[r,i]),r?e.jsx("div",{className:"flex w-screen h-screen justify-center items-center",children:e.jsx("div",{className:"flex glass2 w-[95%] h-[95%] rounded-extra border-1 border-gray-400 justify-center items-center",children:a?e.jsx(Tt,{}):e.jsx(e.Fragment,{children:g!=null&&g.success?e.jsxs("div",{className:"flex flex-col justify-center items-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-700",children:"Successful authentication"}),e.jsx("p",{className:"text-lg font-semibold text-gray-700",children:"You can now close this window"})]}):e.jsxs("div",{className:"flex flex-col justify-center items-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-700",children:"Ups! There was an error authenticating"}),e.jsx("p",{className:"text-lg font-semibold text-gray-700",children:"please try again."})]})})})}):e.jsx(gs,{to:"/register"})},Uo=()=>e.jsxs(js,{children:[e.jsx(Pe,{path:"/login",element:e.jsx(Fo,{})}),e.jsx(Pe,{path:"/register",element:e.jsx(Mo,{})}),e.jsx(Pe,{path:"/callback",element:e.jsx(Oa,{})})]}),Ds=()=>{const[a,s]=t.useState(!0),{status:l,uid:o,email:c}=te(d=>d.auth),i=gt();return t.useEffect(()=>{if(s(!1),!o&&!c){i(ct({}));return}},[i,c,o]),{status:l,isLoading:a}},Bo=({children:a})=>{const{status:s}=Ds();return s==="authenticated"?a:e.jsx(gs,{to:"/user/login"})},Oo=({children:a})=>{const{status:s}=Ds();return s==="not-authenticated"?a:e.jsx(gs,{to:"/projects"})},Wo=({children:a})=>e.jsx("div",{id:"panel",className:"flex flex-grow main-panel min-h-screen  xl:w-4/5 lg:flex-nowrap",children:a}),xs="/assets/platy-BfAmCbc7.jpg",ft="/assets/projectbg-DJ1AM0Vm.jpg",Ho="http://localhost:3000/api",Yo=a=>{const[s,l]=t.useState([]),[o,c]=t.useState(!0),[i,d]=t.useState(null),[g,h]=t.useState(!1),f=()=>{c(!0),U.get(`${Ho}/notis/${a}`,{params:{limit:15,type:"general"},headers:{Authorization:localStorage.getItem("x-token")}}).then(r=>{l(r.data.notis),c(!1)}).catch(r=>{console.error("Error fetching notifications:",r),d(r.response.data.message||"An error occurred while fetching data"),h(!0),c(!1)})};return t.useEffect(()=>{f()},[]),{notifications:s,fetchingNotifications:o,errorMessage:i,errorWhileFetching:g}},we=a=>a.replace(/\./g,"").replace(/\s+/g,"-"),lt=a=>new Date(a).toLocaleDateString(),Ye=a=>{const s=a.match(/\b\w/g)||[],l=((s.shift()||"")+(s.pop()||"")).toUpperCase();return`data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 36 36">
            <rect width="36" height="36" fill="#000000" />
            <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="#ffffff" font-size="18px" font-family="Arial, sans-serif">${l}</text>
        </svg>`)}`},dt=a=>{if(a<1e3)return a.toString();const s=["K","M","B","T"],l=Math.floor(Math.log10(a)/3),o=s[l-1],c=a/Math.pow(1e3,l);return c.toFixed(c>=100?0:1)+o},us=a=>{const s=a.match(/\b\w/g)||[],l=((s.shift()||"")+(s.pop()||"")).toUpperCase();return`data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 36 36">
            <rect width="36" height="36" fill="#000000" />
            <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="#ffffff" font-size="18px" font-family="Arial, sans-serif">${l}</text>
        </svg>`)}`},Ot=a=>a.replace(/\./g,"").replace(/\s+/g,"-"),Wa=a=>new Date(a).toLocaleDateString(),xt=a=>a.charAt(0).toUpperCase()+a.slice(1),qs="http://localhost:3000/api",qo=({setIsOpen:a})=>{const s=Ee(),{uid:l,photoUrl:o,username:c}=te(p=>p.auth),{notifications:i,fetchingNotifications:d,errorMessage:g,errorWhileFetching:h}=Yo(l),[f,r]=t.useState({}),[S,T]=t.useState(!1),L=t.useRef(null),C=async(p,x,b,n,m,k)=>{try{switch(m){case"friend-request":{y(p),await U.put(`${qs}/friends/handle-friend-request/${b}`,{requestStatus:n,uid:x,notiID:p,ref:k.ref},{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}).then(u=>{r(D=>({...D,[p]:u.data.accepted?"accepted":"rejected"}))}).catch(u=>{r(D=>{const{[p]:I,...F}=D;return F}),X.fire({title:u.response.data.message||"Error handling friend request",icon:"error",timer:2e3,showConfirmButton:!1})});break}case"project-invitation":{y(p),await U.put(`${qs}/projects/handle-invitation/${k.projectID}`,{requestStatus:n,uid:x,name:c,photoUrl:o,accessLevel:k.accessLevel,notiID:p},{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}).then(u=>{r(D=>({...D,[p]:u.data.accepted?"accepted":"rejected"}))}).catch(u=>{r(D=>{const{[p]:I,...F}=D;return F}),X.fire({title:u.response.data.message||"Error handling project invitation",icon:"error",timer:2e3,showConfirmButton:!1})});break}default:break}}catch(u){console.log(u)}},y=p=>{r(x=>({...x,[p]:"loading"}))},N=(p,x)=>{switch(p){case"friend-request":return e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 justify-between w-full",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:x.from.photoUrl||Ye(x.from.name),className:"border-[1px] border-gray-400 rounded-full",style:{width:"50px",height:"50px"}}),e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("p",{className:"text-[9px] text-black",children:x.type}),e.jsxs("p",{className:"w-[200px] text-black text-xs font-semibold cursor-pointer",children:["@",x.from.name]}),e.jsx("p",{className:"text-black text-xs",children:"Sent you a friend request."})]})]}),Object.keys(f).includes(x._id)&&f[x._id]==="loading"?e.jsx("div",{className:"flex items-center space-x-3 pr-5",children:e.jsx(Bt,{color:"#0c4a6e",size:8,loading:!0})}):f[x._id]==="accepted"?e.jsx("div",{className:"flex items-center space-x-3 pr-5",children:e.jsx("p",{className:"text-green-500",children:"Accepted"})}):f[x._id]==="rejected"?e.jsx("div",{className:"flex items-center space-x-3 pr-5",children:e.jsx("p",{className:"text-red-500",children:"Rejected"})}):e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>C(x._id,x.recipient,x.from.ID,"accept","friend-request",x.additionalData),className:"text-[10px] text-black w-14 h-8 rounded-xl glassi border-1 border-black hover:bg-blue-500/40 transition-colors duration-150",children:"Accept"}),e.jsx("button",{onClick:()=>C(x._id,x.recipient,x.from.ID,"reject","friend-request",x.additionalData),className:"text-[10px] text-black w-14 h-8 rounded-xl glassi border-1 border-black hover:bg-blue-500/40 transition-colors duration-150",children:"Reject"})]})]}),e.jsx("div",{className:"border-[1px] border-gray-300 w-full"})]});case"project-invitation":return e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-3 w-full",children:[e.jsxs("div",{className:"flex items-center space-x-3 ",children:[e.jsx("img",{src:ft,className:"border-[1px] border-gray-400 rounded-lg",style:{width:"60px",height:"60px"}}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-[9px] text-black",children:x.type}),e.jsx("p",{className:"text-black",children:x.additionalData.project_name}),e.jsxs("p",{className:"w-[200px] text-black text-xs",children:[" ",e.jsxs("span",{onClick:()=>s(`/profile/${Ot(x.from.name)}`,{state:{user:{uid:x.from.ID,username:x.from.name}}}),className:"font-semibold cursor-pointer",children:["@",x.from.name]}),"  invited you to join this project as ",e.jsxs("span",{className:"font-bold text-green-600",children:[" ",x.additionalData.accessLevel," "]})," "]})]})]}),Object.keys(f).includes(x._id)&&f[x._id]==="loading"?e.jsx("div",{className:"flex items-center space-x-3 pr-5",children:e.jsx(Bt,{color:"#0c4a6e",size:8,loading:!0})}):f[x._id]==="accepted"?e.jsx("div",{className:"flex items-center space-x-3 pr-5",children:e.jsx("p",{className:"text-green-500",children:"Accepted"})}):f[x._id]==="rejected"?e.jsx("div",{className:"flex items-center space-x-3 pr-5",children:e.jsx("p",{className:"text-red-500",children:"Rejected"})}):e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>C(x._id,x.recipient,x.from.ID,"accept","project-invitation",x.additionalData),className:"text-[10px] text-black w-14 h-8 rounded-xl glassi border-1 border-black hover:bg-blue-500/40 transition-colors duration-150",children:"Accept"}),e.jsx("button",{onClick:()=>C(x._id,x.recipient,x.from.ID,"reject","project-invitation",x.additionalData),className:"text-[10px] text-black w-14 h-8 rounded-xl glassi border-1 border-black hover:bg-blue-500/40 transition-colors duration-150",children:"Reject"})]})]}),e.jsx("div",{className:"border-[1px] border-gray-300 w-full"})]});case"new-follower":return e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 justify-between w-full",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:x.from.photoUrl||Ye(x.from.name),className:"border-[1px] border-gray-400 rounded-full",style:{width:"50px",height:"50px"}}),e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("p",{className:"text-[9px] text-black",children:x.type}),e.jsxs("p",{className:"w-[200px] text-black text-xs font-semibold cursor-pointer",onClick:()=>{a(!1),s(`/profile/${Ot(x.from.name)}`,{state:{user:{uid:x.from.ID,username:x.from.name}}})},children:["@",x.from.name]}),e.jsx("p",{className:"text-black text-xs",children:"Started following you."})]})]}),e.jsx("div",{className:"flex flex-grow h-full justify-end  px-3",children:e.jsx("p",{className:"text-black font-semibold text-[12px]",children:Wa(x.createdAt)})})]}),e.jsx("div",{className:"border-[1px] border-gray-300 w-full"})]});default:return e.jsx("p",{children:"Unidentified Type"})}};t.useEffect(()=>{const p=setTimeout(()=>{T(!0)},50);return()=>{clearTimeout(p)}},[]);const j=S?"opacity-100":"opacity-0";return e.jsxs("div",{ref:L,"data-popover":!0,id:"popover-notications",role:"tooltip",className:`absolute flex flex-col space-y-2 px-2 pt-2 w-[460px] h-[690px] border-[1px]
           border-gray-400 transition-opacity duration-300 ease-in-out ${j}
            bg-blue-50 glassi  z-10 text-sm text-white rounded-lg shadow-sm bottom-3 left-[270px]`,children:[e.jsx("p",{className:"text-sky-950 font-bold mb-1 mt-2 ml-3",children:"General Notifications"}),e.jsx("div",{className:"flex flex-col space-y-5 flex-grow max-h-[640px] overflow-y-auto p-3",children:d?e.jsx("div",{className:"flex h-full w-full justify-center items-center",children:e.jsx(_e,{color:"#0c4a6e",loading:!0})}):h?e.jsx("div",{className:"flex flex-grow justify-center items-center",children:e.jsx("p",{className:"text-red-500 font-semibold",children:g})}):i.length===0?e.jsx("div",{className:"flex flex-grow justify-center items-center",children:e.jsx("p",{className:"text-blue-500 font-semibold",children:"No notifications yet"})}):i.map((p,x)=>e.jsx(t.Fragment,{children:N(p.type,p)},x))})]})},Go=()=>{const s=ye().pathname,[l,o]=t.useState(!1),{username:c}=te(i=>i.auth);return e.jsxs("div",{id:"Nav",className:"flex flex-col items-center bg-[#0a1128] text-white min-h-screen w-64",children:[l&&e.jsx(qo,{setIsOpen:o}),e.jsxs("div",{className:"flex space-x-2 logo p-5 w-full items-center ",children:[e.jsx("img",{src:xs,alt:"Logo",className:"ml-2 h-14 w-14 mr-3 rounded-lg border-[1px] border-black"}),e.jsx("span",{className:"text-sm nav-button",children:"PrJManager"})]}),e.jsx("span",{className:"w-[80%] border-[1px] border-gray-500 mt-2"}),e.jsxs("div",{className:"navigation w-full py-10 px-4",children:[e.jsx(St,{to:"dashboard",children:e.jsxs("button",{className:`${s.startsWith("/dashboard")?"bg-blue-50 rounded-2xl text-[#0c4a6e]":"text-white"} hover:text-[#0c4a6e] nav-button minimal-button hover:rounded-2xl flex items-center mb-4 mt-2 px-8 w-full  hover:bg-blue-50`,children:[e.jsx(Cr,{className:"w-9 h-9 mr-3",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),"Dashboard"]})}),e.jsx(St,{to:"projects",children:e.jsxs("button",{className:`${s.startsWith("/projects")?"bg-blue-50 rounded-2xl text-[#0c4a6e]":"text-white"} hover:text-[#0c4a6e] nav-button minimal-button hover:rounded-2xl flex items-center mb-4 mt-2 px-8 w-full  hover:bg-blue-50`,children:[e.jsx(kr,{className:"w-9 h-9 mr-3",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),"Projects"]})}),e.jsx(St,{to:"searcher",children:e.jsxs("button",{className:`${s.startsWith("/searcher")?"bg-blue-50 rounded-2xl text-[#0c4a6e]":"text-white"} hover:text-[#0c4a6e] nav-button minimal-button hover:rounded-2xl flex items-center mb-4 mt-2 px-8 w-full  hover:bg-blue-50`,children:[e.jsx(Sr,{className:"w-9 h-9 mr-3",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),"Searcher"]})})]}),e.jsx("div",{className:"user-info flex flex-grow items-end  pb-10 p-5 w-full  pl-9",children:e.jsxs("div",{className:"flex flex-col  space-y-6 ",children:[e.jsx("button",{className:`ml-[16px] flex items-center justify-center ${l?"bg-blue-50 text-sky-950":""} glassi w-8 h-8 rounded-full transition-all duration-150 ease-in-out transform active:translate-y-[2px]`,onClick:()=>o(!l),children:e.jsx(Dr,{className:"w-5 h-5",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx(St,{to:`personal-area/${c}`,children:e.jsx("img",{src:xs,alt:"User",className:"cursor-pointer h-[65px] w-[65px] rounded-full mr-3 border-[2px] border-transparent hover:border-blue-50 transition-colors duration-200"})}),e.jsx("span",{className:"flex-grow text-[13px] nav-button2",children:c})]})]})})]})},Jo=({children:a})=>e.jsxs("div",{id:"prjmanager",className:"flex min-h-screen min-w-screen h-full w-full bg-gray-100",children:[e.jsx(Go,{}),e.jsx(Wo,{children:a})]}),Xo="http://localhost:3000/api",Qo=a=>{const[s,l]=t.useState(0),[o,c]=t.useState(0),[i,d]=t.useState(0),g=()=>{U.get(`${Xo}/users/my-monthly-activity/${a}`,{params:{currentMonth:new Date().getMonth()+1,currentYear:new Date().getFullYear()},headers:{Authorization:localStorage.getItem("x-token")}}).then(h=>{l(h.data.projectsLength),c(h.data.commitsLength),d(h.data.completedTasksLength)}).catch(h=>{console.log(h)})};return t.useEffect(()=>{g()},[]),{totalProjects:s,totalCommits:o,totalCompletedTasks:i}},Zo=({setRender:a,render:s})=>{const l=Ee(),{uid:o}=te(g=>g.auth),{totalProjects:c,totalCommits:i,totalCompletedTasks:d}=Qo(o);return e.jsxs("div",{className:"flex w-full h-36 rounded-extra",children:[e.jsxs("div",{className:"h-full w-[40%] rounded-extra  pl-7",children:[e.jsx("h2",{className:"text-2xl font-bold text-sky-950  mt-5",children:"Dashboard"}),e.jsxs("div",{id:"dashboard-nav-buttons",className:"flex  justify-center items-center w-[92%] h-12  mt-5 ",children:[e.jsx("button",{onClick:()=>{a(""),l(".")},className:`${s===""?"glassi-hover dashboard-buttons":"dashboard-buttons bg-[#ffffff26]"} general text-sm h-full w-[35%]  rounded-l-xl
                                transition-colors duration-150 ease-in-out transform active:translate-y-[2px] hover:glassi-hover`,children:"General"}),e.jsx("button",{onClick:()=>{a("workspace"),l("workspace")},className:`${s==="workspace"?"glassi-hover dashboard-buttons":"dashboard-buttons bg-[#ffffff26]"} general text-sm h-full w-[35%]
                                   transition-colors duration-150 ease-in-out transform active:translate-y-[2px] hover:glassi-hover`,children:"Workspace"}),e.jsx("button",{onClick:()=>{a("resources"),l("resources")},className:`${s==="resources"?"glassi-hover dashboard-buttons":"dashboard-buttons bg-[#ffffff26]"} general text-sm h-full w-[35%] rounded-r-xl
                                   transition-colors duration-150 ease-in-out transform active:translate-y-[2px] hover:glassi-hover`,children:"Resources"})]})]}),e.jsxs("div",{className:"flex h-full w-[60%] justify-end rounded-extra space-x-2 pr-[10px] max-h-[120px] min-h-[120px]",children:[e.jsxs("div",{className:"flex h-full w-40",children:[e.jsxs("div",{className:"mt-7 mr-3",children:[e.jsx("p",{className:"text-2xl font-bold text-sky-950 text-end",children:d}),e.jsx("p",{className:"text-sm text-end",children:"Tasks"}),e.jsx("p",{className:"text-[10px] text-end",children:"this month"})]}),e.jsx("div",{className:"flex justify-center items-center w-10 h-16 rounded-extra border-[1px] border-gray-400 bg-green-500/50 glassi my-auto",children:e.jsx(Se,{size:24,children:e.jsx(Lr,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})})]}),e.jsxs("div",{className:"flex h-full w-40",children:[e.jsxs("div",{className:"mt-7 mr-3",children:[e.jsx("p",{className:"text-2xl font-bold text-sky-950 text-end",children:i}),e.jsx("p",{className:"text-sm text-end",children:"Commits"}),e.jsx("p",{className:"text-[10px] text-end",children:"this month"})]}),e.jsx("div",{className:"flex w-10 h-16 justify-center items-center rounded-extra border-[1px] border-gray-400 bg-yellow-500/50 glassi my-auto ",children:e.jsx(Se,{size:24,children:e.jsx(Tr,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})})]}),e.jsxs("div",{className:"flex h-full w-40",children:[e.jsxs("div",{className:"mt-7 mr-3",children:[e.jsx("p",{className:"text-2xl font-bold text-sky-950 text-end",children:c}),e.jsx("p",{className:"text-sm text-end",children:"Projects"}),e.jsx("p",{className:"text-[10px] text-end",children:"underway"})]}),e.jsx("div",{className:"flex justify-center items-center w-10 h-16 rounded-extra my-auto border-[1px] border-gray-400 glassi",children:e.jsx(Se,{size:24,children:e.jsx($r,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})})]})]})]})},Ko=({data:a,id:s,position:l,visible:o,type:c})=>{var S,T;const[i,d]=t.useState(null),g=(L,C)=>{if(L.id===C)return L;if(L.children)for(const y of L.children){const N=g(y,C);if(N)return N}return null},h=L=>L.replace(/^[^-]+-/,""),f=L=>L?L.charAt(0).toUpperCase()+L.slice(1):"";if(t.useEffect(()=>{o&&(()=>{let C;switch(c){case"project":C=g(a,s);break;case"task":C=g(a,s);break;case"layer":C=g(a,s);break;case"repo":C=g(a,s);break;case"user":C=g(a,s);break}d(C)})()},[c,s,o,a]),!o)return null;const r=L=>new Date(L).toLocaleDateString();if((i==null?void 0:i.type)!=="user")return e.jsxs("div",{className:`absolute p-3 z-50 min-w-[400px] max-w-[450px] rounded-lg shadow-lg bg-black border-[1px] ${c==="project"?"border-blue-400":c==="layer"?"border-pink-400":c==="repo"?"border-green-400":"border-blue-600"}`,style:{top:l.top+10,left:l.left-250},children:[c==="project"&&i&&e.jsxs("div",{className:"flex flex-col space-y-2 p-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-blue-400 font-bold",children:h(i.name)}),e.jsxs("div",{className:"text-[12px] text-white",children:["#",i.id]})]}),e.jsx("div",{className:"text-sm text-white",children:i.description}),e.jsxs("div",{className:"flex space-x-2 text-white",children:[e.jsxs("div",{className:"text-sm",children:["Start Date: ",r(i.startDate)]}),e.jsxs("div",{className:"text-sm",children:["End Date: ",r(i.endDate)]})]}),e.jsx("div",{className:"text-[12px] text-slate-600 font-mono",children:(S=i.tags)==null?void 0:S.join(", ")})]}),c==="task"&&i&&e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-blue-500 font-bold truncate w-[200px] cursor-pointer",children:h(i.name)}),e.jsxs("div",{className:"text-[12px] text-white",children:["#",i.id]})]}),e.jsxs("div",{className:"flex space-x-2 text-white",children:[e.jsx("div",{className:"text-[12px]",children:f(i.status)}),e.jsx("div",{className:"text-[12px]",children:f(i.priority)})]})]}),e.jsx("div",{className:"text-sm text-white",children:i.description}),e.jsxs("div",{className:"text-[12px] text-white",children:["Estimated hours: ",(T=i==null?void 0:i.additional_info)==null?void 0:T.estimated_hours,"h"]}),e.jsxs("div",{className:"flex justify-between mb-3",children:[e.jsxs("div",{className:"flex -space-x-2",children:[i!=null&&i.contributorsIds&&(i==null?void 0:i.contributorsIds.length)>0?i==null?void 0:i.contributorsIds.sort((L,C)=>L.photoUrl&&!C.photoUrl?-1:!L.photoUrl&&C.photoUrl?1:0).slice(0,3).map(L=>e.jsx("img",{className:"w-5 h-5 border-2 border-white rounded-full dark:border-gray-800",src:L.photoUrl||`https://dummyimage.com/500x500/000/fff&text=${L.username.charAt(0).toUpperCase()}`,alt:`${L.username}'s profile`,onError:C=>{const y=C.target;y.onerror=null,y.src=`https://dummyimage.com/500x500/000/fff&text=${L.username.charAt(0).toUpperCase()}`}},L._id)):null,(i==null?void 0:i.contributorsIds)&&(i==null?void 0:i.contributorsIds.length)>3&&e.jsxs("a",{className:"flex items-center justify-center w-5 h-5 text-xs font-medium text-white bg-gray-400 border-2 border-white rounded-full hover:bg-gray-500 dark:border-gray-800",href:"#",children:["+",i.contributorsIds.length-3]})]}),e.jsxs("div",{className:"text-sm",children:["Deadline: ",e.jsx("span",{className:"text-red-500",children:r(i.deadline)})," "]})]})]}),c==="repo"&&i&&e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex  justify-between",children:[e.jsx("div",{className:"text-green-500 font-bold",children:h(i.name)}),e.jsxs("div",{className:"text-[12px] text-white",children:["#",i.id]})]}),e.jsx("div",{className:"text-sm text-white",children:i.description})]}),c==="layer"&&i&&e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex min-w-[] justify-between",children:[e.jsx("div",{className:"text-pink-400 font-bold",children:h(i.name)}),e.jsxs("div",{className:"text-[12px] text-white",children:["#",i.id]})]}),e.jsx("div",{className:"text-sm text-white",children:i.description})]})]})},Vo=({data:a})=>{const s=t.useRef(null),[l,o]=t.useState(null),[c,i]=t.useState({id:"",type:"",top:0,left:0,visible:!1});return t.useEffect(()=>{const d=()=>{l&&(o(null),i(g=>({...g,visible:!1})))};return document.body.addEventListener("click",d),()=>{document.body.removeEventListener("click",d)}},[a,c,l]),t.useEffect(()=>{tl(a,s.current,i,c,l,o)},[a,c,l]),e.jsx("div",{ref:s,style:{width:"100%",height:"100%"},children:e.jsx(Ko,{data:a,id:c.id,position:{top:c.top,left:c.left},visible:c.visible,type:c.type})})},el=a=>a.data.name.startsWith("user")?"black":a.data.name.startsWith("project")?"#abc4ff":a.data.name.startsWith("layer")?"#ff82a9":a.data.status==="pending"?"#FE0000":a.data.status==="approval"?"#FFD700":a.data.status==="completed"?"#0000B8":a.data.name.startsWith("repo")?"#52b788":a.data.name.startsWith("commit")?"#ffafcc":"black",tl=(a,s,l,o,c,i)=>{if(!s)return;Kt(s).select("svg").node()||Kt(s).append("svg");const d=s.clientWidth,g=s.clientHeight,h=so().scaleExtent([.5,3]).on("zoom",p=>{f.select("g").attr("transform",p.transform)}),f=Kt(s).select("svg").attr("viewBox",`0 0 ${d} ${g}`).attr("preserveAspectRatio","xMidYMid meet").on("mousedown",()=>{o.visible&&l({...o,visible:!1})});o.visible?f.on(".zoom",null):f.call(h);const r=f.selectAll("g").data([null]).join("g"),S=ao(a);ro().size([g,d])(S);const L=S.x,y=g/2-L,N=oo().x(p=>p[0]).y(p=>p[1]),j=S.links().map(p=>({source:[p.source.y,p.source.x],target:[p.target.y,p.target.x]}));r.attr("data-initialized")||(r.attr("transform",`translate(20, ${y})`),r.attr("data-initialized","true")),r.selectAll(".link").data(j).join("path").attr("class","link").attr("d",p=>N({source:p.source,target:p.target})).attr("stroke","black").attr("fill","none"),r.selectAll(".node").data(S.descendants()).join("circle").attr("class","node").attr("r",5).attr("cx",p=>p.y).attr("cy",p=>p.x).attr("fill",el).on("mouseenter",(p,x)=>{p.preventDefault(),c||l({type:x.data.type,id:x.data.id,top:p.clientY,left:p.clientX,visible:!0})}).on("mouseleave",()=>{c||l({id:"",type:"",top:0,left:0,visible:!1})}).on("mousemove",p=>{p.preventDefault(),c||l(x=>({...x,top:p.clientY+10,left:p.clientX+10}))}).on("click",(p,x)=>{if(p.stopPropagation(),c===x.data.id)i(null),l({...o,visible:!1});else{if(!x.data.id)return null;i(x.data.id),l({type:x.data.type,id:x.data.id,top:p.clientY,left:p.clientX,visible:!0})}}),r.selectAll(".label").data(S.descendants()).join("text").attr("class","label").attr("x",p=>p.y-5).attr("y",p=>p.x-10).text(p=>p.data.name).attr("text-anchor","start").attr("alignment-baseline","middle").attr("font-size","10px")},Gs="http://localhost:3000/api",sl=a=>{const s=new Date;s.setHours(23,59,59,999);const l=new Date(s);l.setMonth(s.getMonth()-6);const[o,c]=t.useState([]),[i,d]=t.useState([]),[g,h]=t.useState(s),[f,r]=t.useState(l),[S,T]=t.useState(new Map),[L,C]=t.useState(new Map),[y,N]=t.useState(!0),[j,p]=t.useState(!1),[x,b]=t.useState(null),n=u=>{const D=u.split("/"),I=D[0],F=D[1].padStart(2,"0"),R=D[2].padStart(2,"0");return`${I}-${F}-${R}`},m=(u,D)=>{const I=(R,Y)=>{const A=`${Y.getUTCFullYear()}-${String(Y.getUTCMonth()+1).padStart(2,"0")}-${String(Y.getUTCDate()).padStart(2,"0")}`;R[A]?R[A].count+=1:R[A]={date:A,count:1}},F=(R,Y,A,_)=>{const $={};R.forEach(w=>{const v=new Date(w[Y]);I($,v)});const E=Object.values($);A(E),_(new Map(Object.entries($)))};if(N(!0),!D.length&&!u.length){N(!1);return}D.length&&u.length?(F(D,"completed_at",d,T),F(u,"createdAt",c,C)):D.length?F(D,"completed_at",d,T):u.length&&F(u,"createdAt",c,C),N(!1)},k=async()=>{try{const{data:{tasks:u}}=await U.get(`${Gs}/tasks/get-tasks-for-dashboard/${a}`,{params:{startDate:f,endDate:g,uid:a},headers:{Authorization:localStorage.getItem("x-token")}}),{data:{commits:D}}=await U.get(`${Gs}/commits/get-commits-for-dashboard/${a}`,{params:{startDate:f,endDate:g,uid:a},headers:{Authorization:localStorage.getItem("x-token")}});m(D,u)}catch(u){const D=u;D.response?(b(D.response.data.message),p(!0)):(b("An error occurred while fetching data"),p(!0))}finally{N(!1)}};return t.useEffect(()=>{N(!0),k()},[f,g]),{startDate:f,endDate:g,setStartDate:r,setEndDate:h,currentDate:s,sixMonthsAgo:l,errorMessage:x,errorWhileFetching:j,commits:o,tasks:i,isLoading:y,setIsLoading:N,tasksDetailsByDay:S,commitsDetailsByDay:L,formatDateFromHeatMap:n}},al=()=>{const[a,s]=t.useState(!1),{uid:l}=te(b=>b.auth),{startDate:o,setStartDate:c,endDate:i,setEndDate:d,currentDate:g,formatDateFromHeatMap:h,tasks:f,commits:r,tasksDetailsByDay:S,commitsDetailsByDay:T,isLoading:L,errorWhileFetching:C,errorMessage:y}=sl(l),N=()=>{const b=o.getFullYear(),n=i.getFullYear();return b===n?b:`${b} - ${n}`},j=()=>{const b=new Date(o);b.setDate(o.getDate()-1);const n=new Date(b);n.setMonth(b.getMonth()-6),n.getFullYear()!==b.getFullYear()&&(n.setFullYear(b.getFullYear()),n.setMonth(0),n.setDate(1),b.setFullYear(b.getFullYear()),b.setMonth(5),b.setDate(30)),c(n),d(b)},p=()=>{const b=new Date(i);b.setDate(i.getDate()+1);const n=new Date(b);if(n.setMonth(b.getMonth()+6),n.setHours(23,59,59,999),n>g){n.setTime(g.getTime());const m=new Date(g);m.setMonth(g.getMonth()-6),b.setTime(m.getTime())}c(b),d(n)},x=({formattedDate:b,details:n,type:m})=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("h3",{children:[b," |"]}),m==="tasks"?e.jsxs("button",{className:"hover:text-blue-200 transition-colors duration-100",children:["Completed Tasks: ",n.count]}):e.jsxs("button",{className:"hover:text-yellow-200 transition-colors duration-100",children:["Commits: ",n.count]})]});return e.jsxs("div",{className:"flex flex-col flex-grow  justify-center space-y-4 ",children:[e.jsxs("div",{className:"flex items-center w-full justify-between px-10",children:[e.jsx("h3",{className:"text-xl w-[30%] font-bold text-sky-950",children:"Activity"}),e.jsx("h3",{className:"text-sm text-sky-950 font-bold mt-[2px]",children:N()})]}),e.jsx("div",{className:"flex flex-col h-full w-full rounded-extra space-y-2",children:e.jsxs("div",{id:"heatMap",className:"flex flex-col w-full ",children:[e.jsxs("div",{id:"heatMapOpt",className:"flex w-full h-10 space-x-3 justify-center rounded-extra px-7",children:[e.jsx("button",{onClick:j,className:"dashboard-buttons hover:bg-[#1f26870e] rounded-l-extra flex items-center justify-center w-[10%] h-8 transition-all duration-300 ease-in-out transform active:translate-y-[2px]",children:e.jsx(Se,{size:22,children:e.jsx(Ca,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})}),e.jsx("button",{onClick:()=>s(!a),className:"h-8 w-[70%] text-sm  dashboard-buttons transition-transform duration-150 ease-in-out transform active:translate-y-[2px]",children:a?"Commits":"Tasks"}),e.jsx("button",{onClick:p,className:"dashboard-buttons hover:bg-[#1f26870e] rounded-r-extra flex items-center justify-center w-[10%] h-8 transition-all duration-300 ease-in-out transform active:translate-y-[2px]",children:e.jsx(Se,{size:22,children:e.jsx(ka,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})})]}),e.jsx("div",{id:"calendar",className:"flex w-full mt-4 overflow-visible justify-center",children:L?e.jsx("div",{className:"flex justify-center items-center  min-h-[150px]",children:e.jsx(_e,{color:"#0c4a6e",loading:!0})}):C?e.jsx("div",{className:"flex justify-center items-center  min-h-[150px]",children:e.jsx("p",{className:"text-red-500 text-[14px] text-center font-semibold",children:y})}):e.jsx(At,{panelColors:{0:"#eff7ff",2:"#caf0f8",4:"#90e0ef",10:"#00b4d8",20:"#0077b6",30:"#03045e"},value:a?r:f,width:410,startDate:o,endDate:i,rectSize:13,rectProps:{rx:2,ry:2,stroke:"gray",strokeWidth:.2},space:1,rectRender:(b,n)=>{const m=h(n.date);let k=a?T.get(m):S.get(m);k=k||{count:0,date:m};const u=a?"commits":"tasks";return e.jsx(he,{title:e.jsx(x,{formattedDate:m,details:k,type:u}),placement:"right",children:e.jsx("rect",{...b})})}})})]})})]})},Js="http://localhost:3000/api",rl=({uid:a,isModalOpen:s,setIsModalOpen:l})=>{const o=gt(),{topProjects:c}=te(n=>n.auth),[i,d]=t.useState(!0),[g,h]=t.useState([]),[f,r]=t.useState([]),[S,T]=t.useState([]),[L,C]=t.useState(!1),y=(n,m)=>{if(n.length<=3){r(n);const k=n.map(u=>u.value);m("currentTopProjects",k)}else X.fire({title:"Error",text:"You can only select up to 3 projects, delete one to add another one.",icon:"error",confirmButtonText:"Ok"})},N=n=>{const m=n.map(k=>({value:k.pid,label:`${k.name}`}));h(m),d(!1)},j=({values:n})=>(t.useEffect(()=>{const k=((u,D)=>{if(u.length!==D.length)return!1;for(let I=0;I<u.length;I++)if(u[I]!==D[I])return!1;return!0})(n.currentTopProjects,S);C(k)},[n.currentTopProjects]),null),p=async()=>{try{const n=await U.get(`${Js}/projects/get-projects/${a}`,{params:{type:"id_name"},headers:{Authorization:localStorage.getItem("x-token")}});N(n.data)}catch(n){console.log(n)}},x=()=>{const n=document.getElementById("topProjectsModal");n&&(n.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{l(!1)},500))},b=async(n,{setSubmitting:m})=>{m(!0),d(!0);try{const{data:{response:k,user:u}}=await U.put(`${Js}/users/update-top-projects/${a}`,n,{headers:{Authorization:localStorage.getItem("x-token")}});m(!1),d(!1),o(_o(u.topProjects)),X.fire({title:"Success",text:k,icon:"success",confirmButtonText:"Ok"}),setTimeout(()=>{x()},3e3)}catch(k){console.log(k)}};return t.useEffect(()=>{if(d(!0),p(),c.length>0){const n=c.map(k=>({value:k._id,label:`${k.name}`})),m=c.map(k=>k._id);r(n),T(m)}},[c]),t.useEffect(()=>{if(s){const n=setTimeout(()=>{var m,k;(m=document.getElementById("topProjectsModal"))==null||m.classList.remove("opacity-0"),(k=document.getElementById("topProjectsModal"))==null||k.classList.add("opacity-100")},20);return()=>clearTimeout(n)}},[s]),e.jsx("div",{className:"fixed flex w-screen h-full pb-5 top-0 right-0 justify-center items-center z-10 bg-black/30",children:e.jsx("div",{id:"topProjectsModal",className:"flex flex-col w-[70%] bg-gray-200 md:w-[600px] h-[300px] rounded-extra glassi transition-opacity duration-300 ease-in-out opacity-0",children:i?e.jsx("div",{className:"flex flex-grow justify-center items-center",children:e.jsx(_e,{color:"#0c4a6e",loading:!0})}):e.jsx(st,{initialValues:{currentTopProjects:S},onSubmit:b,children:({values:n,setFieldValue:m,isSubmitting:k})=>e.jsxs(at,{className:"flex flex-col flex-grow",children:[e.jsx(j,{values:n}),e.jsxs("div",{className:"flex justify-between w-[90%] h-12 ml-auto mr-auto mt-2 py-2 px-1 border-b-2 border-b-gray-500",children:[e.jsx("p",{className:"text-xl text-black",children:"Top Projects"}),e.jsx("button",{type:"button",onClick:x,children:e.jsx($e,{})})]}),e.jsx("p",{className:"w-[90%] pl-8 mt-4 text-md text-sky-950",children:"Top projects will be tracked in the TreeChart of the dashboard, you can choose up to 3 projects."}),e.jsxs("div",{className:"flex flex-col space-y-7 w-[90%]  ml-auto mr-auto my-5",children:[e.jsx("div",{children:e.jsx(Xe,{multiple:!0,id:"tags-outlined",options:g,value:f,isOptionEqualToValue:(u,D)=>u.value===D.value,onChange:(u,D)=>y(D,m),renderInput:u=>e.jsx(Q,{...u,label:"projects"}),renderTags:(u,D)=>u.map((I,F)=>e.jsx(ot,{label:I.label.length>10?`${I.label.substring(0,10)}...`:I.label,...D({index:F})}))})}),e.jsx("div",{className:"flex w-full justify-center items-end ",children:e.jsx("button",{type:"submit",disabled:L||k,className:`w-[95%] h-[50px] rounded-extra ${L?"backdrop-blur-sm":"backdrop-blur-sm bg-green-400/20 shadow-sm"} border-[1px] border-gray-400 transition-colors duration-300 ease-in-out transform active:translate-y-[2px]`,children:"Save Changes"})})]})]})})})})},ol="http://localhost:3000/api",ll=a=>{const[s,l]=t.useState(!0),[o,c]=t.useState([]),[i,d]=t.useState(null),[g,h]=t.useState(!1),f=async()=>{try{const{data:{notis:r}}=await U.get(`${ol}/notis/${a}`,{params:{limit:10,type:"activity"},headers:{Authorization:localStorage.getItem("x-token")}});c(r),l(!1)}catch(r){const S=r;S.response?(console.error("Error fetching notifications:",r),d(S.response.data.message),h(!0),l(!1)):(d("An error occurred while fetching data"),h(!0),l(!1))}};return t.useEffect(()=>{l(!0),f()},[]),{notifications:o,isLoading:s,errorMessage:i,errorWhileFetching:g}},nl="http://localhost:3000/api",il=({uid:a})=>{const s=Ee(),{notifications:l,isLoading:o,errorMessage:c,errorWhileFetching:i}=ll(a),d=(f,r)=>{switch(f){case"new-task-commit":return e.jsxs("div",{className:"flex flex-col space-y-1 rounded-r-lg  p-2 pr-3 text-[12px] border-[1px] border-gray-400 glassi",children:[e.jsx("p",{className:"font-semibold text-[11px]",children:lt(r.createdAt)}),e.jsxs("p",{children:[e.jsxs("span",{className:"font-semibold",children:["@",r.additionalData.username]})," has pushed new commits to the task ",e.jsx("span",{className:"font-semibold transition-colors duration-200 hover:text-blue-500 text-blue-600 cursor-pointer",children:r.additionalData.taskName})," in the repository ",e.jsx("span",{className:"font-semibold text-green-600",children:r.additionalData.repositoryName}),"."]})]});case"task-assignation":return e.jsxs("div",{className:"flex flex-col space-y-1 rounded-r-lg  p-2 pr-3 text-[12px] border-[1px] border-gray-400 glassi",children:[e.jsx("p",{className:"font-semibold text-[11px]",children:lt(r.createdAt)}),e.jsxs("p",{children:["The task ",e.jsx("span",{onClick:()=>s(`workspace/${we(r.additionalData.taskName)}`,{state:{task:{taskId:r.additionalData.taskId,new:!0}}}),className:"font-semibold transition-colors duration-200 hover:text-blue-500 text-blue-600 cursor-pointer",children:r.additionalData.taskName})," in the repository ",e.jsx("span",{className:"font-semibold text-green-600",children:r.additionalData.repositoryName}),", has been assigned to you."]})]});case"task-invitation":return e.jsxs("div",{className:"flex flex-col space-y-1 rounded-r-lg  p-2 pr-3 text-[12px] border-[1px] border-gray-400 glassi",children:[e.jsx("p",{className:"font-semibold text-[11px]",children:lt(r.createdAt)}),e.jsxs("p",{children:[r.description," ",e.jsx("span",{onClick:()=>h(r._id,r.additionalData.taskId,r.additionalData.taskName),className:"cursor-pointer font-semibold transition-colors duration-200 hover:text-blue-500 text-blue-600",children:r.additionalData.taskName})," in the repository ",e.jsxs("span",{className:"font-semibold text-green-600",children:[r.additionalData.repositoryName,"."]})]})]});case"task-approved":return e.jsxs("div",{className:"flex flex-col space-y-1 rounded-r-lg  p-2 pr-3 text-[12px] border-[1px] border-gray-400 glassi",children:[e.jsx("p",{className:"font-semibold text-[11px]",children:lt(r.additionalData.date)}),e.jsxs("p",{children:["The task ",e.jsx("span",{onClick:()=>s(`workspace/${we(r.additionalData.taskName)}`,{state:{task:{taskId:r.additionalData.taskId,new:!0}}}),className:"font-semibold transition-colors duration-200 hover:text-blue-500 text-blue-600 cursor-pointer",children:r.additionalData.taskName})," has been ",e.jsx("span",{className:"text-green-700",children:"approved."})," "]})]});case"task-rejected":return e.jsxs("div",{className:"flex flex-col space-y-1 rounded-r-lg p-2 pr-3 text-[12px] border-[1px] border-gray-400 glassi",children:[e.jsx("p",{className:"font-semibold text-[11px]",children:lt(r.additionalData.date)}),e.jsxs("p",{children:["The task ",e.jsx("span",{onClick:()=>s(`workspace/${we(r.additionalData.taskName)}`,{state:{task:{taskId:r.additionalData.taskId,new:!0}}}),className:"font-semibold transition-colors duration-200 hover:text-blue-500 text-blue-600 cursor-pointer",children:r.additionalData.taskName})," has been ",e.jsx("span",{className:"text-red-500",children:"rejected"}),", see the reason ",e.jsx("span",{onClick:()=>s(`workspace/${we(r.additionalData.taskName)}`,{state:{task:{taskId:r.additionalData.taskId,new:!0,reasons:!0}}}),className:"cursor-pointer font-semibold underline",children:"here"}),". "]})]});case"added-to-repo":return e.jsxs("div",{className:"flex flex-col space-y-1 rounded-r-lg p-2 pr-3 text-[12px] border-[1px] border-gray-400 glassi",children:[e.jsx("p",{className:"font-semibold text-[11px]",children:lt(r.createdAt)}),e.jsxs("p",{children:["You have been added to the repository ",e.jsx("span",{onClick:()=>s(`/projects/${we(r.additionalData.projectName)}/${we(r.additionalData.layerName)}/${we(r.additionalData.repoName)}`,{state:{project:{ID:r.from.ID,name:r.additionalData.projectName,accessLevel:r.additionalData.accessLevel||null},layer:{layerID:r.additionalData.layerId,layerName:r.additionalData.layerName},repository:{repoID:r.additionalData.repoId,repoName:r.additionalData.repoName}}}),className:"font-semibold transition-colors duration-200 hover:text-green-500 text-green-600 cursor-pointer",children:r.additionalData.repoName})," in the project ",e.jsx("span",{className:"font-semibold text-blue-600",children:r.additionalData.projectName}),"  with a ",e.jsx("span",{className:"font-bold",children:r.additionalData.accessLevel})," access level."]})]});case"added-to-layer":return e.jsxs("div",{className:"flex flex-col space-y-1 rounded-r-lg p-2 pr-3 text-[12px] border-[1px] border-gray-400 glassi",children:[e.jsx("p",{className:"font-semibold text-[11px]",children:lt(r.createdAt)}),e.jsxs("p",{children:["You have been added to the layer ",e.jsx("span",{onClick:()=>s(`/projects/${we(r.additionalData.projectName)}/${we(r.additionalData.layerName)}`,{state:{project:{ID:r.from.ID,name:r.additionalData.projectName},layer:{layerID:r.additionalData.layerId,layerName:r.additionalData.layerName}}}),className:"font-semibold transition-colors duration-200 hover:text-pink-500 text-pink-600 cursor-pointer",children:r.additionalData.layerName})," in the project ",e.jsx("span",{className:"font-semibold text-blue-600",children:r.additionalData.projectName}),"."]})]});default:return e.jsx("p",{children:"Unidentified Type"})}},g=(f,r,S,T)=>{U.put(`${nl}/tasks/handle-task-invitation/${r}`,{uid:a,accepted:f,notiId:S},{headers:{Authorization:localStorage.getItem("x-token")}}).then(L=>{X.fire({title:L.data.message||"Invitation Handled.",icon:"success",timer:2e3,showConfirmButton:!1}),L.data.message==="Invitation accepted"&&setTimeout(()=>{s(`workspace/${we(T)}`,{state:{task:{taskId:r,new:!0}}})},2e3)}).catch(L=>{X.fire({title:L.response.data.message||"Error handling invitation",icon:"error",timer:2e3,showConfirmButton:!1})})},h=(f,r,S)=>{X.fire({title:"You have been invited to a task",text:"If you accept, you can contribute to the task and collaborate with other users. Do you want to accept the invitation?",icon:"info",showCancelButton:!0,confirmButtonText:"Accept",cancelButtonText:"Reject",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",reverseButtons:!0}).then(T=>{T.isConfirmed?g(!0,r,f,S):g(!1,r,f,S)})};return e.jsx("div",{className:"flex flex-col space-y-4 flex-grow max-h-[300px] overflow-y-auto  rounded-b-extra",children:o?e.jsx("div",{className:"flex flex-grow justify-center items-center  min-h-[150px]",children:e.jsx(_e,{color:"#0c4a6e",loading:!0})}):i?e.jsx("div",{className:"flex flex-grow justify-center items-center  min-h-[150px]",children:e.jsx("p",{className:"text-red-500 font-semibold",children:c})}):l.length===0?e.jsx("div",{className:"flex flex-grow justify-center items-center  min-h-[150px]",children:e.jsx("p",{className:"text-blue-500 font-semibold",children:"No notifications yet"})}):l.map((f,r)=>e.jsxs("div",{className:"flex space-x-2 w-full px-5",children:[e.jsx("img",{className:"w-6 h-6 border-[1px] border-white rounded-full dark:border-gray-800",src:xs,alt:"",onError:S=>{const T=S.target;T.onerror=null,T.src="https://dummyimage.com/500x500/000/fff&text=S"}}),d(f.type,f)]},r))})};function Le(...a){return ho(uo(a))}const Ha=t.createContext(void 0),cl=({children:a,className:s,containerClassName:l})=>{const o=t.useRef(null),[c,i]=t.useState(!1),d=f=>{if(!o.current)return;const{left:r,top:S,width:T,height:L}=o.current.getBoundingClientRect(),C=(f.clientX-r-T/2)/25,y=(f.clientY-S-L/2)/25;o.current.style.transform=`rotateY(${C}deg) rotateX(${y}deg)`},g=()=>{i(!0),o.current},h=()=>{o.current&&(i(!1),o.current.style.transform="rotateY(0deg) rotateX(0deg)")};return e.jsx(Ha.Provider,{value:[c,i],children:e.jsx("div",{className:Le("h-full flex items-center justify-center",l),style:{perspective:"1000px"},children:e.jsx("div",{ref:o,onMouseEnter:g,onMouseMove:d,onMouseLeave:h,className:Le("h-full flex items-center justify-center relative transition-all duration-200 ease-linear",s),style:{transformStyle:"preserve-3d"},children:a})})})},dl=({children:a,className:s})=>e.jsx("div",{className:Le("h-96 w-96 [transform-style:preserve-3d]  [&>*]:[transform-style:preserve-3d]",s),children:a}),Rt=({as:a="div",children:s,className:l,translateX:o=0,translateY:c=0,translateZ:i=0,rotateX:d=0,rotateY:g=0,rotateZ:h=0,...f})=>{const r=t.useRef(null),[S]=xl();t.useEffect(()=>{T()},[S]);const T=()=>{r.current&&(S?r.current.style.transform=`translateX(${o}px) translateY(${c}px) translateZ(${i}px) rotateX(${d}deg) rotateY(${g}deg) rotateZ(${h}deg)`:r.current.style.transform="translateX(0px) translateY(0px) translateZ(0px) rotateX(0deg) rotateY(0deg) rotateZ(0deg)")};return e.jsx(a,{ref:r,className:Le("w-fit transition duration-200 ease-linear",l),...f,children:s})},xl=()=>{const a=t.useContext(Ha);if(a===void 0)throw new Error("useMouseEnter must be used within a MouseEnterProvider");return a},Ya="/assets/sea-DCYa7wb7.jpg",qa="/assets/stars-CTL5UzJx.jpg",ul="http://localhost:3000/api",hl=()=>{const{uid:a,username:s}=te(n=>n.auth),[l,o]=t.useState(!0),[c,i]=t.useState(null),[d,g]=t.useState(null),[h,f]=t.useState(!1),[r,S]=t.useState(!1),[T,L]=t.useState("You haven't set any project as 'Top Project', highlight one in the 'Top Projects' panel to track it."),C=n=>{const m={};return n.forEach(k=>{m[k.id]||(m[k.id]=k)}),Object.values(m)},y=n=>({name:`task-${n.task_name}`,type:"task",id:n._id,children:[],description:n.task_description,deadline:n.deadline,assigned_to:n.assigned_to,status:n.status,priority:n.priority,additional_info:n.additional_info,contributorsIds:n.contributorsIds}),N=(n,m)=>{const k={};return n.filter(u=>u.repository_related_id.layerID===m).forEach(u=>{const D=u.repository_related_id._id;k[D]||(k[D]={name:`repo-${u.repository_related_id.name}`,type:"repo",children:[],id:D,description:u.repository_related_id.description}),k[D].children.push(y(u))}),C(Object.values(k))},j=(n,m)=>{const k={};return n.filter(u=>u.layer_related_id.project===m).forEach(u=>{const D=u.layer_related_id._id;k[D]||(k[D]={name:`layer-${u.layer_related_id.name}`,type:"layer",children:[],id:D,description:u.layer_related_id.description,updatedAt:u.layer_related_id.updatedAt}),k[D].children=N(n,D)}),C(Object.values(k))},p=n=>{const m={};return n.forEach(k=>{const u=k.project._id;m[u]||(m[u]={name:`project-${k.project.name}`,type:"project",children:[],id:u,description:k.project.description,startDate:k.project.startDate,endDate:k.project.endDate,tags:k.project.tags}),m[u].children=j(n,u)}),C(Object.values(m))},x=n=>({name:s||"user",id:a,type:"user",children:p(n)}),b=async()=>{try{const m=(await U.get(`${ul}/tasks/top-projects-tasks/${a}`,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}})).data.tasks,k=x(m);i(k),o(!1)}catch(n){o(!1);const m=n;if(m.response)if(m.response.data.type==="no-top-projects"){S(!0),L(m.response.data.message);return}else g(m.response.data.message||"An error occurred while fetching data"),f(!0);else g("An error occurred while fetching data"),f(!0)}};return t.useEffect(()=>{b()},[]),{data:c,isLoading:l,errorMessage:d,errorWhileFetching:h,noData:r,noDataMessage:T}},Xs=()=>{var p;const a=Ee(),s=ye(),{data:l,isLoading:o,errorWhileFetching:c,errorMessage:i,noData:d,noDataMessage:g}=hl(),{uid:h,topProjects:f}=te(x=>x.auth),[r,S]=t.useState(!1),[T,L]=t.useState(0),C=(p=s.state)==null?void 0:p.task,y=[{title:"PrJManager",description:"Discover how to reduce entropy in a chaotic world.",image:ft,styles:"text-black"},{title:"PrJExtension",description:"Explore the dynamic use of the PrJManager extension that mimics the Git system.",image:Ya,styles:"text-white"},{title:"PrJConsole",description:"An introduction to the PrJManager interactive console commands.",image:qa,styles:"text-white"}],N=()=>{L(x=>(x+1)%y.length)};t.useEffect(()=>{const x=setTimeout(()=>{L(b=>(b+1)%y.length)},1e4);return()=>clearTimeout(x)},[T]);const j=y[T];return C!=null&&C.taskId?e.jsx(rt,{}):e.jsxs("div",{id:"general",className:"flex flex-grow flex-col w-full h-full",children:[e.jsx("div",{id:"charts",className:"flex w-full px-7",children:e.jsxs("div",{className:"flex treechart-container w-full rounded-extra min-h-[390px] max-h-[390px]",children:[e.jsx("div",{className:"flex h-full w-[35%] items-center",children:e.jsx(al,{})}),e.jsx("div",{id:"chart-container",className:"info-box-shadow-treechart h-full w-[65%]  rounded-extra  overflow-hidden",children:o?e.jsx("div",{className:"flex h-full justify-center items-center",children:e.jsx(_e,{color:"#0c4a6e",loading:!0})}):c||d?e.jsx("div",{className:"flex h-full justify-center items-center font-semibold",children:e.jsx("p",{className:c?"text-red-500":"text-blue-500",children:c?i:g})}):e.jsx(Vo,{data:l})})]})}),e.jsxs("div",{id:"extra-info",className:"flex flex-grow w-full space-x-4 items-center px-7",children:[e.jsxs("div",{id:"quickNotis",className:"flex flex-col h-[90%] space-y-3  ml-1 overflow-hidden w-[30%] glassi rounded-extra bg-[#ffffff26] border-[1px] border-gray-400",children:[e.jsx("h3",{className:"font-bold text-sky-950 mt-5 ml-6 text-[14px]",children:"Activity Notifications"}),e.jsx(il,{uid:h})]}),e.jsxs("div",{id:"topProjects",className:"h-[90%] flex flex-col w-1/3 glassi  bg-[#ffffff26] rounded-extra border-[1px] border-gray-400",children:[e.jsxs("div",{className:"flex items-center justify-between w-full mt-5 pl-7 ",children:[e.jsx("h3",{className:"font-bold text-sky-950 text-[14px]",children:"Top Projects"}),e.jsx("button",{className:"flex items-center justify-center w-[20%] transition-transform duration-150 ease-in-out transform active:translate-y-[2px]",onClick:()=>S(!r),children:e.jsx(Se,{size:25,color:"#0c4a6e",children:e.jsx(Er,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})}),r&&e.jsx(rl,{uid:h,isModalOpen:r,setIsModalOpen:S})]}),e.jsx("div",{className:"w-full h-full flex flex-col mt-10 space-y-5",children:f.length>0?f.map(x=>e.jsxs("div",{className:"glassi flex w-[90%] py-2 justify-end items-center border-1 border-gray-400  pr-2 ml-auto mr-auto rounded-extra transition-all duration-150 ease-in-out transform hover:translate-y-[-2px]",children:[e.jsx("button",{onClick:()=>a(`../projects/${we(x.name)}`,{state:{project:{ID:x._id,name:x.name}}}),className:"flex justify-center items-center w-11 h-11 rounded-extra border-[1px] border-gray-400 hover:glassi-hover glassi transition-all duration-200 ease-in-out transform hover:rotate-[-90deg]",children:e.jsx(Se,{size:24,children:e.jsx(Pr,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})}),e.jsx("div",{className:"flex w-[80%] h-full items-center justify-end",children:e.jsx("p",{className:"text-sm font-bold text-sky-950 mr-5",children:x==null?void 0:x.name})})]})):e.jsx("div",{className:"glass flex w-[90%] h-14 justify-end items-center border-1 border-gray-400  pr-2 ml-auto mr-auto rounded-extra",children:e.jsx("div",{className:"flex w-[80%] h-full items-center justify-end",children:e.jsx("p",{className:"text-sm font-bold text-sky-950 mr-5",children:"No Top Projects added"})})})})]}),e.jsx("div",{id:"articles-updates",className:"h-[90%]  flex flex-col w-1/3 rounded-extra glassi",children:e.jsx(cl,{className:"inter-var w-full h-full bg-[#ffffff26] rounded-extra",children:e.jsx(dl,{className:"relative group/card w-auto sm:w-full h-full rounded-extra",children:e.jsxs("div",{style:{backgroundImage:`url(${j.image})`,backgroundSize:"cover",backgroundPosition:"center"},className:"pt-10 px-8 h-full w-full object-cover rounded-extra group-hover/card:shadow-xl border-[1px] border-gray-400 ",children:[e.jsx(Rt,{as:"h1",translateZ:"30",className:`text-4xl font-bold ${j.styles}`,children:j.title}),e.jsx(Rt,{as:"p",translateZ:"20",className:`text-2xl max-w-sm mt-2 font-semibold  ${j.styles}`,children:j.description}),e.jsxs("div",{className:"absolute flex justify-between w-full items-center left-0 bottom-6 px-7",children:[e.jsx(Rt,{translateZ:20,as:"button",onClick:N,className:`px-4 py-2 rounded-xl text-xs font-normal ${j.styles}`,children:"Next  →"}),e.jsx(Rt,{translateZ:20,as:"button",className:"px-4 py-2 rounded-xl bg-black dark:bg-white dark:text-black text-white text-xs font-bold border-[1px] border-gray-400 hover:bg-blue-200",children:"Read"})]})]})})})})]})]})},ml=()=>{var i;const a=ye(),s=a.pathname.split("/").pop(),[l,o]=t.useState(s||"general"),c=()=>{switch(l){case"general":return e.jsx(Xs,{});case"workspace":return e.jsx(rt,{});case"resources":return e.jsx(rt,{});default:return e.jsx(Xs,{})}};return t.useEffect(()=>{var d,g,h;(d=a==null?void 0:a.state)!=null&&d.task&&((h=(g=a==null?void 0:a.state)==null?void 0:g.task)!=null&&h.new)&&o("workspace")},[a.state,s]),(i=a==null?void 0:a.state)!=null&&i.repository?e.jsx(rt,{}):e.jsxs("div",{className:"flex flex-grow flex-col space-y-2 items-center",children:[e.jsx(Zo,{setRender:o,render:l}),c()]})},Ae="/assets/formbg-PRb6PHVo.jpg";function pl({navigate:a,taskSet:s,uid:l}){const o=c=>new Date(c).toLocaleDateString();return e.jsx("div",{className:"min-w-80 max-w-80 h-full",children:e.jsx("div",{className:"relative h-full rounded-b-2xl transition duration-200 group bg-white hover:shadow-x border-[1px] border-gray-400",style:{background:`url(${Ae})`,backgroundSize:"cover",backgroundPosition:"bottom center",backgroundRepeat:"no-repeat"},children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("h2",{className:"font-bold text-[12px] text-zinc-700",children:["#",s.repository_number_task||0]}),s.type==="assigned"&&s.assigned_to===l?e.jsx(he,{title:"Assigned to you",placement:"bottom",arrow:!0,enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("span",{children:e.jsx(fa,{className:"text-2xl text-black"})})}):null]}),e.jsx("h2",{className:"font-bold mb-2 text-lg text-zinc-700 truncate w-[285px]",children:s.task_name}),e.jsxs("div",{className:"flex flex-row space-x-2",children:[e.jsx("div",{className:`${s.type==="open"?"bg-pink-300 text-black":"bg-black text-white"} max-h-6 flex flex-row space-x-2 items-center border-[1px] border-gray-400 px-3 py-1 rounded-2xl`,children:e.jsx("p",{className:"text-[11px]",children:s.type})}),e.jsx("div",{className:`${s.status==="pending"?"bg-red-400":s.status==="approval"?"bg-yellow-600":s.status==="completed"?"bg-blue-500 text-white":""} max-h-6  flex flex-row space-x-2 items-center border-[1px] border-gray-400 px-3 py-1 rounded-2xl`,children:e.jsx("p",{className:"text-[11px]",children:s.status})}),e.jsx("div",{className:`${s.priority==="Critical"?"bg-red-400":s.priority==="High"?"bg-orange-400":s.priority==="Medium"?"bg-yellow-400":"bg-green-400 "} max-h-6  flex flex-row space-x-2 items-center border-[1px] border-gray-400 px-3 py-1 rounded-2xl`,children:e.jsx("p",{className:"text-[11px]",children:s.priority})}),e.jsx("div",{className:"max-h-6  bg-white flex flex-row space-x-2 items-center border-[1px] border-gray-400 px-3 py-1 rounded-2xl",children:e.jsxs("p",{className:"text-[11px] text-black",children:["G: ",s.goals.length]})})]}),e.jsx("p",{className:"font-normal my-4 text-sm text-black glassi p-2",children:s.task_description}),e.jsxs("div",{className:"absolute left-0 bottom-5 w-full flex flex-row justify-between items-center px-4",children:[e.jsx("span",{className:"text-sm text-black",children:o(s.deadline)}),e.jsx("button",{onClick:()=>a(`${we(s.task_name)}`,{state:{task:{taskId:s._id}}}),className:"relative z-10 px-6 py-2 bg-black text-white font-bold rounded-xl block text-xs transition-all duration-150 ease-in-out transform hover:translate-y-[-2px] active:translate-y-[2px]",children:"Full Details"})]})]})})})}const fl="http://localhost:3000/api",gl=()=>{var D,I;const a=Ee(),l=(I=(D=ye().state)==null?void 0:D.task)==null?void 0:I.taskId,[o,c]=t.useState([]),{uid:i}=te(F=>F.auth),[d,g]=t.useState(!0),[h,f]=t.useState(null),[r,S]=t.useState(!1),[T,L]=t.useState(!1),[C,y]=t.useState(""),N=t.useRef(null),[j,p]=t.useState(!1),[x,b]=t.useState(!0),n=()=>{const{scrollLeft:F,scrollWidth:R,clientWidth:Y}=N.current;p(F>0),b(F<R-Y)},m=()=>{N.current&&N.current.scrollBy({left:-400,behavior:"smooth"})},k=()=>{N.current&&N.current.scrollBy({left:400,behavior:"smooth"})};t.useEffect(()=>{if(T&&N.current){const F=N.current;return F.addEventListener("scroll",n),n(),()=>{F.removeEventListener("scroll",n)}}},[T]),t.useEffect(()=>{g(!0),U.get(`${fl}/tasks/get-user-tasks/${i}`,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}).then(F=>{c(F.data.tasks),g(!1),L(!0)}).catch(F=>{console.log(F),g(!1),S(!0),f(F.response.data.message||"An error occurred while fetching the task data")})},[]);const u=t.useMemo(()=>C===""?o:o.filter(F=>{const R=C.toLowerCase(),Y=F.repository_number_task.toString().toLowerCase().includes(R),A=F.task_name.toLowerCase().includes(R);return Y||A}),[C,o]);return l?e.jsx(rt,{}):e.jsxs("div",{className:"flex  flex-col w-[95%] h-[80%] overflow-x-auto   rounded-2xl treechart-container bg-white/40",children:[e.jsxs("div",{className:"flex items-center justify-between w-full h-20  bg-white/40 rounded-t-2xl px-4",children:[e.jsx("h1",{className:"text-xl nav-button",children:"Select a task"}),e.jsx(Q,{name:"set",label:"Number task Or Task Name",size:"small",value:C,onChange:F=>y(F.target.value),sx:{width:240}})]}),d?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(_e,{color:"#32174D"})}):r?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx("h1",{className:"text-red-500",children:h})}):e.jsxs("div",{className:"relative flex flex-grow",children:["  ",e.jsx("div",{ref:N,className:"flex flex-grow space-x-2 overflow-x-auto rounded-b-2xl max-w-[81vw]",onScroll:n,children:u.map(F=>e.jsx(pl,{navigate:a,taskSet:F,uid:i}))}),j&&e.jsx(Pt,{size:30,className:"absolute z-50 top-1/2 left-0 transform -translate-y-1/2 cursor-pointer transition-transform duration-150 ease-in-out active:translate-y-[1px]",onClick:m}),x&&e.jsx(It,{size:30,className:"absolute z-50 top-1/2 right-0 transform -translate-y-1/2 cursor-pointer transition-transform duration-150 ease-in-out active:translate-y-[1px]",onClick:k})]})]})},jl=({data:a,commitsDetailsByDay:s,createdAt:l})=>{const o=new Date(l);o.setHours(23,59,59,999);const c=new Date(o);c.setMonth(o.getMonth()+6);const i=c,d=o,g=f=>{const r=f.split("/"),S=r[0],T=r[1].padStart(2,"0"),L=r[2].padStart(2,"0");return`${S}-${T}-${L}`},h=({formattedDate:f,details:r})=>e.jsxs("div",{className:"flex flex-col items-center",children:[r.count===872349287928342?e.jsx("h2",{className:"font-mono",children:"Task Started At:"}):r.count===772349287928342?e.jsx("h2",{className:"font-mono",children:"Task Deadline:"}):null,e.jsx("h3",{children:f}),r.count===872349287928342||r.count===772349287928342?e.jsxs("p",{children:["commits: ",e.jsx("span",{className:"",children:r.commits})]}):e.jsxs("p",{children:["commits: ",e.jsx("span",{className:"",children:r.count})]})]});return e.jsx("div",{className:"flex pl-6 pt-5 w-[95%] rounded-2xl mx-auto justify-center",children:e.jsx(At,{panelColors:{0:"#eff7ff",2:"#caf0f8",4:"#90e0ef",10:"#00b4d8",20:"#0077b6",30:"#03045e",872349287928342:"#FFFF00"},width:380,value:a,startDate:d,endDate:i,rectSize:11,rectProps:{rx:2,ry:2,stroke:"gray",strokeWidth:.2},space:1,rectRender:(f,r)=>{const S=g(r.date);let T=s.get(S);return T=T||{count:0},e.jsx(he,{title:e.jsx(h,{formattedDate:S,details:T}),placement:"top",children:e.jsx("rect",{...f})})}})})},bl=({items:a,commits:s})=>{const[l,o]=t.useState(null),c={stiffness:100,damping:5},i=mo(0),d=_s(As(i,[-100,100],[-45,45]),c),g=_s(As(i,[-100,100],[-50,50]),c),h=r=>{const T=r.target.offsetWidth/2;i.set(r.nativeEvent.offsetX-T)},f=r=>s.filter(S=>S.author.uid===r).length;return e.jsx(e.Fragment,{children:a.map(r=>e.jsxs("div",{className:"-mr-4  relative group ",onMouseEnter:()=>o(r._id),onMouseLeave:()=>o(null),children:[l===r._id&&e.jsxs(Ue.div,{initial:{opacity:0,y:20,scale:.6},animate:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:260,damping:10}},exit:{opacity:0,y:20,scale:.6},style:{translateX:g,rotate:d,whiteSpace:"nowrap"},className:"absolute -top-16 -left-1/2 translate-x-1/2 flex text-xs  flex-col items-center justify-center rounded-md bg-black z-50 shadow-xl px-4 py-2",children:[e.jsx("div",{className:"absolute inset-x-10 z-30 w-[20%] -bottom-px bg-gradient-to-r from-transparent via-emerald-500 to-transparent h-px "}),e.jsx("div",{className:"absolute left-10 w-[40%] z-30 -bottom-px bg-gradient-to-r from-transparent via-sky-500 to-transparent h-px "}),e.jsx("div",{className:"font-bold text-white relative z-30 text-base",children:r.uid.username}),e.jsx("div",{className:"font-semibold text-white text-[12px] relative z-30",children:"finished his contributions."}),e.jsxs("div",{className:"text-green-300 text-xs",children:["Commits: ",f(r.uid._id)]})]}),e.jsx("img",{onMouseMove:h,height:100,width:100,src:r.uid.photoUrl||Ye(r.uid.username),alt:r.uid.username,className:"object-cover !m-0 !p-0 object-top rounded-full h-9 w-9 border-2 group-hover:scale-105 group-hover:z-30 border-white relative transition duration-500",onError:S=>{const T=S.target;T.onerror=null,T.src=Ye(r.uid.username)}})]},r._id))})},Ga="http://localhost:3000/api",yl=async(a,s,l,o,c)=>{try{const i=await U.get(`${Ga}/gitlab/loadContentFile/${s._id}`,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")},params:{branch:a,filePath:l}});o(i.data),c(l)}catch(i){const d=i;d.response&&d.response.status===404?(o("This file is empty."),c(l)):console.error("Error fetching file content:",i)}},Ja=(a,s,l)=>a.map(o=>{if(o.path===s&&o.type==="tree"){const c=o.files||[];return l.forEach(i=>{c.some(d=>d.path===i.path)||c.push({...i})}),{...o,files:c}}else return o.type==="tree"&&o.files?{...o,files:Ja(o.files,s,l)}:o}),vl=async(a,s,l,o)=>{try{const c=await U.get(`${Ga}/gitlab/loadFolderContents/${a._id}`,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")},params:{folderPath:s}});console.log("CARPETA",c);const i=c.data.files;o(d=>Ja(d,s,i))}catch(c){console.error("Error fetching folder contents:",c)}},Lt=a=>{const s=a.slice(a.lastIndexOf("."));return wl[s]||"javascript"},wl={".py":"python",".js":"javascript",".jsx":"jsx",".ts":"typescript",".tsx":"tsx",".java":"java",".html":"html",".css":"css",".scss":"scss",".sass":"sass",".less":"less",".c":"c",".cpp":"cpp",".cs":"csharp",".php":"php",".sql":"sql",".json":"json",".xml":"xml",".md":"markdown",".r":"r",".sh":"bash",".bat":"batch",".go":"go",".rs":"rust",".dart":"dart",".lua":"lua",".pl":"perl",".rb":"ruby",".ipynb":"json",".yml":"yaml",".yaml":"yaml",".dockerfile":"dockerfile",".gitignore":"plaintext",".config":"plaintext",".ini":"ini"},Nl={pdf:{icon:po,color:"#FF0000"},txt:{icon:Fs,color:"#000000"},md:{icon:Fs,color:"#000000"},doc:{icon:Ms,color:"#2B579A"},docx:{icon:Ms,color:"#2B579A"},xls:{icon:Rs,color:"#217346"},xlsx:{icon:Rs,color:"#217346"},ppt:{icon:zs,color:"#D24726"},pptx:{icon:zs,color:"#D24726"},csv:{icon:fo,color:"#CCCC00"},png:{icon:Ct,color:"#DB7100"},jpg:{icon:Ct,color:"#DB7100"},jpeg:{icon:Ct,color:"#DB7100"},gif:{icon:Ct,color:"#DB7100"},bmp:{icon:Ct,color:"#DB7100"},svg:{icon:Ct,color:"#FF9900"},mp3:{icon:Us,color:"#008000"},wav:{icon:Us,color:"#008000"},mp4:{icon:Vt,color:"#800080"},mov:{icon:Vt,color:"#800080"},avi:{icon:Vt,color:"#800080"},js:{icon:Bs,color:"#F0DB4F"},jsx:{icon:Os,color:"#61DAFB"},ts:{icon:Bs,color:"#007ACC"},tsx:{icon:Os,color:"#61DAFB"},html:{icon:go,color:"#E34C26"},css:{icon:Mt,color:"#264DE4"},scss:{icon:Mt,color:"#CC6699"},sass:{icon:Mt,color:"#CC6699"},less:{icon:Mt,color:"#1D365D"},py:{icon:Ws,color:"#3776AB"},ipynb:{icon:Ws,color:"#3776AB"},java:{icon:jo,color:"#F89820"},c:{icon:Je,color:"#A8B9CC"},cpp:{icon:Je,color:"#00599C"},cs:{icon:Je,color:"#178600"},php:{icon:bo,color:"#787CB5"},sql:{icon:yo,color:"#F80000"},json:{icon:Je,color:"#000000"},xml:{icon:Je,color:"#000000"},dockerfile:{icon:vo,color:"#2496ED"},yml:{icon:Je,color:"#CB171E"},yaml:{icon:Je,color:"#CB171E"},gitignore:{icon:wo,color:"#F05032"},sh:{icon:Je,color:"#4EAA25"},bat:{icon:Je,color:"#4EAA25"},rb:{icon:Je,color:"#701516"},r:{icon:No,color:"#276DC3"},go:{icon:Je,color:"#00ADD8"},rs:{icon:Je,color:"#FF5733"},dart:{icon:Je,color:"#00B4AB"},lua:{icon:Je,color:"#000080"},zip:{icon:$t,color:"#A52A2A"},tar:{icon:$t,color:"#A52A2A"},gz:{icon:$t,color:"#A52A2A"},rar:{icon:$t,color:"#A52A2A"},"7z":{icon:$t,color:"#A52A2A"}},Cl="http://localhost:3000/api",kl=({isDiffModalOpen:a,setIsDiffModalOpen:s,commits:l,selecteDiffData:o})=>{const[c,i]=t.useState(null),[d,g]=t.useState(!1),[h,f]=t.useState(!1),[r,S]=t.useState(70),[T,L]=t.useState({hash:o.hash||"",new:o.new||void 0}),[C,y]=t.useState({hash:"",new:void 0}),[N,j]=t.useState(null),[p,x]=t.useState(null),[b,n]=t.useState(null),[m,k]=t.useState(0),[u,D]=t.useState(0),[I,F]=t.useState(0),[R,Y]=t.useState(null),A=t.useRef(null),_=v=>new Date(v).toLocaleDateString(),$=()=>{const v=document.getElementById("diffModal");v&&(v.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{s(!1)},500))},E=v=>{T.hash===v?L({hash:"",new:void 0}):C.hash===v?y({hash:"",new:void 0}):T.new===void 0?L({hash:v,new:!0}):T.new?y({hash:v,new:!0}):L({hash:v,new:!0})},w=()=>{x(null),n(null),j(null),T.hash||C.hash?(f(!0),U.get(`${Cl}/gitlab/diff`,{params:{uuid1:T.hash||"",uuid2:C.hash||""}}).then(v=>{if(console.log(v),v.data.type==="one-diff"){const{commit1:P}=v.data;x({hash:P.hash,diffs:P.diffs}),S(100)}else if(v.data.type=="no-diff"){const{commit1:P,commit2:M}=v.data;x({hash:P.hash,diffs:P.diffs}),n({hash:M.hash,diffs:M.diffs}),S(95)}else j(v.data);L(P=>({...P,new:!1})),y(P=>({...P,new:!1})),f(!1)}).catch(v=>{console.log(v),f(!1),g(!0),i(v.response.data.message||"There was an error while fetching repository tasks.")})):X.fire({icon:"error",title:"Oops...",text:"Select at least 1 commit."})};return t.useEffect(()=>{if(A.current){Y(A.current.offsetWidth);const v=()=>{var P;return Y((P=A==null?void 0:A.current)==null?void 0:P.offsetWidth)};return window.addEventListener("resize",v),()=>window.removeEventListener("resize",v)}},[r]),t.useEffect(()=>{if(a){const v=setTimeout(()=>{var P,M;(P=document.getElementById("diffModal"))==null||P.classList.remove("opacity-0"),(M=document.getElementById("diffModal"))==null||M.classList.add("opacity-100")},20);return()=>clearTimeout(v)}},[a]),t.useEffect(()=>{const v=document.getElementById("resizer"),P=v==null?void 0:v.parentNode;let M=0,B=r;const W=oe=>{M=oe.clientX,B=r,document.addEventListener("mousemove",q),document.addEventListener("mouseup",G),oe.preventDefault()},q=oe=>{if(!P)return;const ge=oe.clientX-M,ae=365,le=853;let ee=B+ge/P.offsetWidth*100;const K=100-ee;P.offsetWidth*(K/100)>ae?ee=100-ae/P.offsetWidth*100:P.offsetWidth*(ee/100)<le&&(ee=le/P.offsetWidth*100),S(ee),oe.preventDefault()},G=()=>{document.removeEventListener("mousemove",q),document.removeEventListener("mouseup",G)};return v==null||v.addEventListener("mousedown",W),()=>{v==null||v.removeEventListener("mousedown",W)}},[r]),t.useEffect(()=>{o.hash!==""&&w()},[o]),e.jsx("div",{className:"fixed flex w-screen h-full pb-5 top-0 right-0 justify-center items-center bg-black/30 z-50",children:e.jsxs("div",{id:"diffModal",className:`overflow-hidden flex flex-col w-[70%] md:w-[80%] md:max-h-[735px] md:h-[735px] items-center rounded-2xl glassi bg-white border-[1px] border-gray-400 transition-opacity duration-300 ease-in-out opacity-0 ${a?"":"pointer-events-none"}`,children:[e.jsxs("div",{className:"flex justify-between w-[95%] h-12 ml-auto mr-auto mt-2 p-2",children:[e.jsx("p",{className:"text-xl text-black",children:"Hashes Reviewer"}),e.jsx("button",{onClick:$,children:e.jsx($e,{})})]}),e.jsxs("div",{className:"flex w-full h-full relative",children:[e.jsx("div",{id:"left-panel",style:{width:`${r}%`},className:"flex bg-[#282a36]",children:h?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(_e,{color:"#FFFFFF"})}):d?e.jsx("div",{className:"flex w-full h-full items-center justify-center",children:e.jsx("h1",{className:"text-red-500",children:c})}):N?e.jsxs("div",{className:"relative flex flex-col flex-grow overflow-x-auto",children:[e.jsxs("div",{className:"flex flex-col pl-4 py-2",children:[e.jsxs("h2",{className:"flex items-center font-mono text-yellow-200 text-[14px] rounded",children:["Differences found between the hashes:",e.jsx("p",{className:"font-bold text-white text-[12px] truncate w-[120px] ml-2 mr-2",children:N.uuid1}),"-",e.jsx("p",{className:"font-bold text-white text-[12px] truncate w-[120px] ml-2",children:N.uuid2})]}),e.jsx("h2",{className:"text-green-400 text-lg font-semibold",children:N.diffData.diffs[m].new_path===N.diffData.diffs[m].old_path?`${N.diffData.diffs[m].new_path}`:`${N.diffData.diffs[m].old_path} => ${N.diffData.diffs[m].new_path}`})]}),e.jsx("div",{className:"flex flex-grow max-h-[623px] overflow-y-auto pl-2",children:e.jsx(nt,{language:Lt(N.diffData.diffs[m].new_path),style:it,customStyle:{marginTop:"0px",padding:"15px",borderRadius:"0px",height:"100%",fontSize:"12px",width:"100%"},children:`${N.diffData.diffs[m].diff}`})}),N.diffData.diffs.length>0&&e.jsxs("div",{className:`absolute flex ${m>0?"justify-between":"justify-end"} bottom-0 w-full px-5 py-5`,children:[m>0&&e.jsx("button",{onClick:()=>k(m-1),children:e.jsx(Pt,{size:25,className:"text-white hover:text-blue-200 transition-all duration-150 ease-in-out transform active:translate-y-[2px]"})}),m!==N.diffData.diffs.length-1&&e.jsx("button",{onClick:()=>k(m+1),children:e.jsx(It,{size:25,className:"text-white hover:text-blue-200 transition-all duration-150 ease-in-out transform active:translate-y-[2px]"})})]})]}):p&&!b?e.jsxs("div",{className:"relative flex flex-col flex-grow overflow-x-auto",children:[e.jsxs("div",{className:"flex flex-col pl-4 py-2",children:[e.jsx("h2",{className:"font-bold text-white text-[12px]",children:p.hash}),e.jsx("h2",{className:"text-green-400 text-lg font-semibold",children:p.diffs[u].new_path===p.diffs[u].old_path?`${p.diffs[u].new_path}`:`${p.diffs[u].old_path} => ${p.diffs[u].new_path}`})]}),e.jsx("div",{className:"flex flex-grow pl-2 max-h-[618px] overflow-y-auto",children:e.jsx(nt,{language:Lt(p.diffs[u].new_path),style:it,customStyle:{marginTop:"0px",padding:"15px",borderRadius:"0px",height:"100%",fontSize:"12px",width:"100%"},children:`${p.diffs[u].diff}`})}),p.diffs.length>1&&e.jsxs("div",{className:`absolute flex ${u>0?"justify-between":"justify-end"} bottom-0 w-full px-5 py-5`,children:[u>0&&e.jsx("button",{onClick:()=>D(u-1),children:e.jsx(Pt,{size:25,className:"text-white hover:text-blue-200 transition-all duration-150 ease-in-out transform active:translate-y-[2px]"})}),u!==p.diffs.length-1&&e.jsx("button",{onClick:()=>D(u+1),children:e.jsx(It,{size:25,className:"text-white hover:text-blue-200 transition-all duration-150 ease-in-out transform active:translate-y-[2px]"})})]})]}):p&&b?e.jsxs("div",{className:"flex flex-grow",children:[e.jsxs("div",{className:"relative flex flex-col w-1/2 border-r-[1px] border-white",children:[e.jsxs("div",{className:"flex flex-col pl-4 py-2",children:[e.jsx("h2",{className:"font-bold text-white text-[12px]",children:p.hash}),e.jsx("h2",{className:"text-green-400 text-lg font-semibold",children:p.diffs[0].new_path===p.diffs[0].old_path?`${p.diffs[0].new_path}`:`${p.diffs[0].old_path} => ${p.diffs[0].new_path}`})]}),e.jsx("div",{className:"h-full pl-2 overflow-auto max-h-[623px]",children:e.jsx(nt,{language:Lt(p.diffs[0].new_path),style:it,customStyle:{marginTop:"0px",padding:"15px",borderRadius:"0px",height:"100%",fontSize:"12px",width:"100%"},children:`${p.diffs[0].diff}`})}),p.diffs.length>1&&e.jsxs("div",{className:`absolute flex ${u>0?"justify-between":"justify-end"} bottom-0 w-full px-5 py-5`,children:[u>0&&e.jsx("button",{onClick:()=>D(u-1),children:e.jsx(Pt,{size:25,className:"text-white hover:text-blue-200 transition-all duration-150 ease-in-out transform active:translate-y-[2px]"})}),u!==p.diffs.length-1&&e.jsx("button",{onClick:()=>D(u+1),children:e.jsx(It,{size:25,className:"text-white hover:text-blue-200 transition-all duration-150 ease-in-out transform active:translate-y-[2px]"})})]})]}),e.jsxs("div",{className:"relative flex flex-col w-1/2",children:[e.jsxs("div",{className:"flex flex-col pl-4 py-2",children:[e.jsx("h2",{className:"font-bold text-white text-[12px]",children:b.hash}),e.jsx("h2",{className:"text-green-400 text-lg font-semibold",children:b.diffs[0].new_path===b.diffs[0].old_path?`${b.diffs[0].new_path}`:`${b.diffs[0].old_path} => ${b.diffs[0].new_path}`})]}),e.jsx("div",{className:"h-full pl-2 overflow-auto max-h-[623px]",children:e.jsx(nt,{language:Lt(b.diffs[0].new_path),style:it,customStyle:{marginTop:"0px",padding:"15px",borderRadius:"0px",height:"100%",fontSize:"12px",width:"100%"},children:`${b.diffs[0].diff}`})}),b.diffs.length>1&&e.jsxs("div",{className:`absolute flex ${I>0?"justify-between":"justify-end"} bottom-0 w-full px-5 py-5`,children:[I>0&&e.jsx("button",{onClick:()=>F(I-1),children:e.jsx(Pt,{size:25,className:"text-white hover:text-blue-200 transition-all duration-150 ease-in-out transform active:translate-y-[2px]"})}),I!==b.diffs.length-1&&e.jsx("button",{onClick:()=>F(I+1),children:e.jsx(It,{size:25,className:"text-white hover:text-blue-200 transition-all duration-150 ease-in-out transform active:translate-y-[2px]"})})]})]})]}):e.jsx("div",{className:"flex flex-col flex-grow items-center justify-center",children:e.jsx("h2",{className:"text-xl font-semibold mb-2 text-white",children:"Select 1 or 2 hashes in the right panel to compare them or see their code."})})}),e.jsx("div",{id:"resizer",className:"bg-gray-400 cursor-col-resize min-w-2"}),e.jsx("div",{id:"right-panel",style:{width:`${100-r}%`},className:"flex flex-col glassi",children:l.length>0?e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"h-[580px] max-h-[580px] overflow-y-auto overflow-x-hidden mt-2",children:l.map((v,P)=>e.jsxs("div",{onClick:()=>E(v.uuid),className:`${T.hash===v.uuid||C.hash===v.uuid?"border-2 border-blue-500":null} flex w-full min-w-0 mx-auto items-center p-2 bg-white rounded shadow mb-2 pl-4 hover:bg-gray-300 transition-colors duration-200 cursor-pointer`,children:[e.jsx("img",{src:v.author.photoUrl||Ye(v.author.name),alt:v.author.name,className:"w-9 h-9 rounded-full mr-3",onError:M=>{const B=M.target;B.onerror=null,B.src=Ye(v.author.name)}}),e.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-center pr-2",children:[e.jsx("span",{className:"text-[14px] font-semibold overflow-hidden whitespace-nowrap text-overflow-ellipsis",children:v.author.name}),e.jsx("span",{className:"text-[12px] font-semibold",children:_(v.createdAt)})]}),e.jsxs("span",{className:"text-[14px] text-gray-600 overflow-hidden line-clamp-2  text-overflow-ellipsis",children:["committed with hash ",e.jsx("span",{className:"font-mono bg-gray-100 rounded px-1",children:v.uuid})]})]})]},P))}),e.jsx("div",{className:"flex flex-grow items-center justify-center w-full",children:e.jsx("button",{ref:A,onClick:w,className:`w-[80%] transition-opacity duration-500 ${R<=100?"opacity-0":"opacity-100"} ease-in-out transform active:translate-y-[2px] inline-flex h-12 animate-shimmer items-center justify-center rounded-md border border-slate-800 bg-[linear-gradient(110deg,#000103,45%,#1e2631,55%,#000103)] bg-[length:200%_100%] font-medium text-white transition-colors focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 focus:ring-offset-slate-50`,children:"Find"})})]}):e.jsx("div",{className:"flex flex-col flex-grow items-center justify-center",children:e.jsx("h2",{className:"text-xl font-semibold mb-2 text-slate-500",children:"No hashes to see yet."})})})]})]})})},Sl=({setIsTaskReasonsOpen:a,isTaskReasonsOpen:s,reasons:l})=>{const o=()=>{const c=document.getElementById("tasksReasons");c&&(c.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{a(!1)},500))};return t.useEffect(()=>{if(s){const c=setTimeout(()=>{var i,d;(i=document.getElementById("tasksReasons"))==null||i.classList.remove("opacity-0"),(d=document.getElementById("tasksReasons"))==null||d.classList.add("opacity-100")},20);return()=>clearTimeout(c)}},[s]),e.jsx("div",{className:"fixed flex w-screen h-full pb-5 top-0 right-0 justify-center items-center bg-black/30 z-50",children:e.jsxs("div",{id:"tasksReasons",className:`overflow-hidden flex flex-col w-[70%] md:w-[50%] md:max-h-[735px] md:min-h-[535px] items-center rounded-2xl glassi bg-white border-[1px] border-gray-400 transition-opacity duration-300 ease-in-out opacity-0 ${s?"":"pointer-events-none"}`,children:[e.jsxs("div",{className:"flex justify-between items-center w-[95%] h-12 ml-auto mr-auto mt-2",children:[e.jsx("p",{className:"text-xl font-semibold text-black",children:"Task Rejection Reasons"}),e.jsx("button",{onClick:o,className:"text-gray-500 hover:text-gray-700",children:e.jsx($e,{size:20})})]}),e.jsx("div",{className:"flex flex-col flex-grow w-full max-h-[650px] ml-auto mr-auto mt-4 p-4 overflow-y-auto",children:l.map((c,i)=>e.jsxs("div",{className:"flex flex-col w-full p-4 mb-4 shadow-lg bg-gray-100 rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("img",{src:c.uid.photoUrl||us(c.uid.username),alt:"avatar",className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-lg font-semibold text-black",children:c.uid.username}),e.jsxs("span",{className:"text-sm text-gray-600",children:["About the submitted task on ",e.jsx("span",{className:"font-semibold",children:Wa(c.taskSubmissionDate)})]})]}),"                  "]}),e.jsxs("div",{className:"relative flex flex-grow h-full space-x-2 mt-2",children:[e.jsx("p",{className:"text-[14px] font-semibold ",children:"Reason:"}),e.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:e.jsx("p",{className:"text-sm text-black",children:c.text})})]})]},i))})]})})},Dl=({open:a,setOpen:s,notes:l,setNotes:o,handleParticipation:c})=>{const[i,d]=t.useState(""),g=r=>{r.key==="Enter"&&i.trim()&&(r.preventDefault(),o(S=>[...S,i]),d(""))},h=r=>{o(S=>S.filter(T=>T!==r))},f=(r,S)=>r.length>S?r.substring(0,S)+"...":r;return e.jsxs(Fe,{open:a,onClose:()=>s(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(Me,{id:"alert-dialog-title",children:"About your contributions"}),e.jsx(Re,{children:e.jsxs("div",{className:"flex flex-col space-y-7",children:[e.jsx(Ze,{id:"alert-dialog-description",children:"Add a few notes about your contributions:"}),e.jsx(Q,{autoFocus:!0,margin:"dense",id:"name",label:"New Note",type:"text",fullWidth:!0,variant:"outlined",value:i,onChange:r=>d(r.target.value),onKeyDown:g}),e.jsx("div",{className:"flex flex-wrap max-h-[100px] overflow-y-auto",children:l.map((r,S)=>e.jsx(he,{title:r,placement:"top",children:e.jsx(ot,{label:f(r,30),onDelete:()=>h(r),color:"primary",variant:"outlined",sx:{maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginLeft:1,marginBottom:1}},S)},S))})]})}),e.jsx(ze,{children:e.jsx("div",{className:"flex justify-center w-full pb-4",children:e.jsx("button",{onClick:()=>{s(!1),c()},className:"glassi text-black p-2 rounded w-[90%] border-[1px] border-gray-400",children:"Continue"})})})]})},Qs="http://localhost:3000/api",Ll=({setIsNotesOpen:a,isNotesOpen:s,taskNotes:l,setTaskNotes:o})=>{const[c,i]=t.useState(!1),[d,g]=t.useState(!1),[h,f]=t.useState({}),[r,S]=t.useState(null),T=x=>x.reduce((b,n)=>{const m=n.uid.uid;return b[m]||(b[m]={userInfo:{username:n.uid.username,photoUrl:n.uid.photoUrl},notes:[]}),b[m].notes.push(n),b},{}),L=x=>{S(x),g(!0)},C=()=>{g(!1),S(null)},y=({note:x,isOpen:b,onSave:n,onDelete:m,onClose:k})=>{const[u,D]=t.useState(x.text);return e.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-50 z-50 ${b?"flex":"hidden"} justify-center items-center`,children:e.jsx("div",{className:"flex flex-col bg-white p-4 rounded-lg w-2/3 min-h-[235px] max-h-[235px]",children:c?e.jsx("div",{className:"flex flex-grow justify-center items-center",children:e.jsx(_e,{color:"#2563EB",loading:c,height:35,width:4,radius:2,margin:2})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between w-full px-2",children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Edit Note"}),e.jsx("button",{onClick:k,className:"hover:text-red-500 transition-colors duration-300",children:e.jsx($e,{size:18})})]}),e.jsx("textarea",{className:"w-full p-2 border rounded focus:outline-none focus:shadow-outline",rows:4,value:u,onChange:I=>D(I.target.value)}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx("button",{onClick:()=>m(x._id),className:"bg-red-500 text-white p-2 rounded",children:"Delete"}),e.jsx("button",{onClick:()=>n({noteId:x._id,text:u}),className:"bg-gray-300 p-2 rounded",children:"Save"})]})]})})})},N=x=>{i(!0),U.put(`${Qs}/tasks/update-note/${x.noteId}`,{text:x.text}).then(b=>{console.log(b),X.fire({title:"Note Updated",icon:"success",timer:1500,showConfirmButton:!1});const n=l.map(m=>m._id===x.noteId?{...m,text:x.text}:m);o(n),f(T(n)),C(),i(!1)}).catch(b=>{console.error(b),C(),i(!1),X.fire({title:"Error updating note",text:"There was an error updating the note. Please try again later.",icon:"error"})})},j=x=>{i(!0),U.delete(`${Qs}/tasks/delete-note/${x}`).then(b=>{console.log(b),X.fire({title:"Note Deleted",icon:"success",timer:1500,showConfirmButton:!1});const n=l.filter(m=>m._id!==x);o(n),f(T(n)),i(!1),C()}).catch(b=>{console.error(b),C(),i(!1),X.fire({title:"Error deleting note",text:"There was an error deleting the note. Please try again later.",icon:"error"})})},p=()=>{const x=document.getElementById("notesModal");x&&(x.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{a(!1)},300))};return t.useEffect(()=>{l&&f(T(l))},[l]),t.useEffect(()=>{s&&setTimeout(()=>{var x;(x=document.getElementById("notesModal"))==null||x.classList.add("opacity-100")},20)},[s]),e.jsx("div",{className:"fixed flex w-screen h-full pb-5 top-0 right-0 justify-center items-center bg-black/30 z-50 transition-opacity duration-500 ease-in-out",children:e.jsxs("div",{id:"notesModal",className:"bg-white glassi overflow-hidden flex flex-col w-[70%] md:w-[50%] md:max-h-[735px] md:min-h-[50%] rounded-2xl border-[1px] border-gray-400 transition-all duration-500 ease-in-out transform scale-95 opacity-0",children:[e.jsxs("div",{className:"flex justify-between w-full p-5",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Contributors Notes"}),e.jsx("button",{onClick:p,className:"text-xl p-1 hover:text-red-500 transition-colors duration-300",children:e.jsx($e,{size:22})})]}),e.jsx("div",{className:"flex flex-grow flex-col p-4 space-y-2 overflow-auto",children:Object.values(h).map((x,b)=>e.jsxs("div",{className:"flex space-x-2 p-5 shadow bg-gray-100 rounded-lg",children:[e.jsx("img",{src:x.userInfo.photoUrl||Ye(x.userInfo.username),alt:"avatar",className:"w-10 h-10 rounded-full mt-2"}),e.jsx("div",{className:"flex flex-col space-y-2 ",children:x.notes.map((n,m)=>e.jsx("div",{onClick:()=>L(n),className:"cursor-pointer flex items-center space-x-2 p-2 m-2 bg-white rounded shadow-sm hover:shadow-md hover:bg-gray-50 transition-all",children:e.jsx("p",{className:"text-sm p-1",children:n.text})},m))})]},b))}),d&&e.jsx(y,{note:r,isOpen:d,onSave:N,onDelete:j,onClose:C})]})})},Zs="http://localhost:3000/api",Tl=({setIsTaskCOpen:a,setOpen:s,taskId:l,repoID:o,currentTaskContributors:c,uid:i})=>{const[d,g]=t.useState([]),[h,f]=t.useState([]),[r,S]=t.useState(""),T=Object.keys(c),L=j=>{d.some(p=>p.uid===j.uid)||g([...d,j])},C=j=>{g(d.filter(p=>p.uid!==j))},y=j=>{S(j.target.value)},N=j=>{const p=j.map(x=>x.uid);U.put(`${Zs}/tasks/update-task-contributors/${l}`,{contributorsIds:p},{params:{uid:i},headers:{Authorization:localStorage.getItem("x-token")}}).then(x=>{X.fire({title:x.data.message||"Invitation(s) sent successfully!",icon:"success",timer:2e3,showConfirmButton:!1}),a(!1)}).catch(x=>{console.error(x),X.fire({title:x.response.data.message||"Error adding contributors",icon:"error",timer:2e3,showConfirmButton:!1}),s(!1)})};return t.useEffect(()=>{r.length>0&&U.get(`${Zs}/repos/get-repo-collaborators/${o}`,{params:{add:!0,searchQuery:r},headers:{Authorization:localStorage.getItem("x-token")}}).then(j=>{console.log("OPT",j),f(j.data.collaborators)}).catch(j=>{console.error(j)})},[r,o]),e.jsxs("div",{className:"flex flex-grow flex-col px-5",children:[e.jsx(Xe,{id:"tags-outlined",options:h,getOptionLabel:j=>j.name,getOptionDisabled:j=>T.includes(j.uid)||d.map(p=>p.uid).includes(j.uid),filterSelectedOptions:!0,onChange:(j,p)=>{p&&L(p)},renderInput:j=>e.jsx(Q,{...j,label:"Search collaborators",placeholder:"Contributors",onChange:y}),renderOption:(j,p)=>e.jsxs("li",{className:"flex p-4 w-full",...j,children:[e.jsx("img",{className:"rounded-extra h-10 w-10",src:p.photoUrl||Ye(p.name),alt:""}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsx("p",{className:"ml-2",children:p.name}),T.includes(p.uid)&&e.jsx("p",{className:"ml-2 text-[11px] text-green-500",children:"Already in the task"})]}),e.jsx("p",{className:"ml-2 text-[12px]",children:p.uid})]})]})}),e.jsx("div",{className:"flex flex-wrap min-h-[180px] max-h-[180px] min-w-[475px] max-w-[475px] p-2 overflow-y-auto",children:d.length>0?d.map((j,p)=>e.jsx(ot,{label:j.name,onDelete:()=>C(j.uid),style:{margin:"5px"}},p)):e.jsx("div",{className:"flex flex-grow justify-center items-center text-gray-500 text-center",children:e.jsx("p",{children:"Choose a collaborator from the repository to which this task belongs"})})}),e.jsxs("div",{className:"flex flex-grow justify-between py-5",children:[e.jsx(xe,{variant:"text",onClick:()=>s(!1),children:"Cancel"}),e.jsx(xe,{disabled:d.length===0,variant:"contained",color:"primary",onClick:()=>N(d),children:"Add"})]})]})},Ks="http://localhost:3000/api",$l=({setIsTaskCOpen:a,isTaskCOpen:s,repoID:l,taskId:o,task:c,uid:i})=>{const[d,g]=t.useState(!1),[h,f]=t.useState(null),[r,S]=t.useState(null),[T,L]=t.useState(!1),C=x=>(b,n)=>{S(n?x:null)},y=()=>{const x=document.getElementById("contributorsModal");x&&(x.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{a(!1)},300))},N=(x,b)=>x||`https://ui-avatars.com/api/?name=${encodeURIComponent(b)}&background=random`,j=()=>{L(!0),U.get(`${Ks}/tasks/get-task-contributors/${o}`,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}).then(x=>{f(x.data.contributorsData),L(!1)}).catch(x=>{L(!1),console.error(x)})},p=x=>{U.put(`${Ks}/tasks/delete-task-contributor/${o}`,{contributorId:x},{params:{uid:i},headers:{Authorization:localStorage.getItem("x-token")}}).then(()=>{X.fire({title:"Contributor removed",icon:"success",timer:2e3,showConfirmButton:!1}),a(!1)}).catch(b=>{console.error(b),X.fire({title:"Error removing contributor",icon:"error",timer:2e3,showConfirmButton:!1})})};return t.useEffect(()=>{s&&setTimeout(()=>{var x;(x=document.getElementById("contributorsModal"))==null||x.classList.add("opacity-100")},20)},[s]),t.useEffect(()=>{j()},[]),e.jsx("div",{className:"fixed flex w-screen h-full top-0 right-0 justify-center items-center bg-black/30 z-50 transition-opacity duration-500 ease-in-out",children:e.jsxs("div",{id:"contributorsModal",className:"bg-white overflow-hidden flex flex-col min-w-[500px] min-h-[300px] rounded-2xl border-[1px] border-gray-400 transition-all transform scale-95 opacity-0",children:[e.jsxs("div",{className:"flex justify-between w-full p-5",children:[e.jsx("h2",{className:"text-xl font-semibold",children:d?"Add Contributors":"Task Contributors"}),e.jsxs("div",{className:"flex space-x-2",children:[!d&&c.type==="assigned"&&c.assigned_to===i&&e.jsx("button",{onClick:()=>g(!0),className:"text-xl p-1 hover:text-green-500 transition-colors duration-300",children:e.jsx(Ir,{className:"w-5 h-5",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})}),e.jsx("button",{onClick:y,className:"text-xl p-1 hover:text-red-500 transition-colors duration-300",children:e.jsx($e,{size:18})})]})]}),T?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(_e,{color:"#32174D"})}):d?e.jsx(Tl,{setIsTaskCOpen:a,setOpen:g,taskId:o,repoID:l,currentTaskContributors:h,uid:i}):e.jsx("div",{className:"flex flex-col items-center p-4 max-h-[556px] overflow-y-auto",children:h&&Object.values(h).map((x,b)=>e.jsxs("div",{className:"w-full p-3 flex flex-col bg-gray-100 rounded-lg shadow mb-4 min-w-[300px]",children:[e.jsxs("div",{className:"flex items-center p-2",children:[e.jsx("img",{src:N(x.photoUrl,x.username),alt:x.username,className:"w-12 h-12 rounded-full mr-4"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between  w-full",children:[e.jsx("h3",{className:"font-bold",children:x.username}),c.type==="assigned"&&c.assigned_to===i&&e.jsx("button",{onClick:()=>p(x.id),children:e.jsx(_r,{className:"h-5 w-5 text-red-500 cursor-pointer",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})]}),e.jsxs("p",{children:["Commits: ",x.commits]})]})]}),x.firstCommit&&x.lastCommit&&e.jsxs(jt,{expanded:r===`panel${b}`,onChange:C(`panel${b}`),children:[e.jsx(Ns,{expandIcon:e.jsx(Cs,{}),children:e.jsx("p",{className:"font-semibold",children:"More Details"})}),e.jsxs(bt,{children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-green-600",children:"First Commit"}),e.jsxs("div",{className:"mt-2 ml-2 p-2 shadow",children:[e.jsxs("p",{className:"text-[13px] font-semibold",children:["Date: ",new Date(x.firstCommit.createdAt).toLocaleString()]}),e.jsxs("p",{className:"text-[13px] font-semibold",children:["Hash: ",x.firstCommit.uuid]})]})]}),e.jsxs("div",{className:"flex flex-col mt-4",children:[e.jsx("p",{className:"text-green-600",children:"Last Commit"}),e.jsxs("div",{className:"mt-2 ml-2 p-2 shadow",children:[e.jsxs("p",{className:"text-[13px] font-semibold",children:["Date:  ",e.jsx("span",{children:new Date(x.lastCommit.createdAt).toLocaleString()})," "]}),e.jsxs("p",{className:"text-[13px] font-semibold",children:["Hash: ",e.jsx("span",{children:x.lastCommit.uuid})," "]})]})]})]})]})]}))})]})})},ss="http://localhost:3000/api",El=()=>{const a=ye(),{uid:s}=te(ae=>ae.auth),[l,o]=t.useState(!1),[c,i]=t.useState(new Map),[d,g]=t.useState(null),[h,f]=t.useState([]),[r,S]=t.useState(null),[T,L]=t.useState([]),[C,y]=t.useState(!0),[N,j]=t.useState(null),[p,x]=t.useState(!1),[b,n]=t.useState(!1),[m,k]=t.useState({hash:"",new:void 0}),[u,D]=t.useState(!1),[I,F]=t.useState(!1),[R,Y]=t.useState(!1),[A,_]=t.useState(!1),[$,E]=t.useState(!1),[w,v]=t.useState([]),{taskId:P}=a.state.task,M=a.state.task,B=ae=>new Date(ae).toLocaleDateString(),W=(ae,le,ee)=>{const K={},fe=new Date(le),re=new Date(ee),de=`${fe.getUTCFullYear()}-${String(fe.getUTCMonth()+1).padStart(2,"0")}-${String(fe.getUTCDate()).padStart(2,"0")}`,Z=`${re.getUTCFullYear()}-${String(re.getUTCMonth()+1).padStart(2,"0")}-${String(re.getUTCDate()).padStart(2,"0")}`;K[de]={date:de,count:872349287928342,commits:0},K[Z]={date:Z,count:772349287928342,commits:0},ae.forEach(O=>{const H=new Date(O.createdAt),se=`${H.getUTCFullYear()}-${String(H.getUTCMonth()+1).padStart(2,"0")}-${String(H.getUTCDate()).padStart(2,"0")}`;K[se]?K[se].count===872349287928342?K[se].commits+=1:K[se].count+=1:K[se]={date:se,count:1}});const pe=Object.values(K);g(pe),i(new Map(Object.entries(K))),y(!1)},q=ae=>ae.readyContributors.filter(le=>le.uid._id===s).length>0,G=async()=>{const ae=`${ss}/tasks/get-task-commits/${P}`,le=`${ss}/tasks/get-task-notes/${P}`;try{const{data:{task:ee,commits:K}}=await U.get(ae),{data:{notes:fe}}=await U.get(le);S(ee),f(K),L(fe),o(q(ee)),W(K,ee.createdAt,ee.deadline),ee.reasons_for_rejection.length>0&&M.reasons&&_(!0)}catch(ee){console.log(ee);const K=ee;K.response?(x(!0),j(K.response.data.message||"An error occurred while fetching the task data"),y(!1)):(x(!0),j("An error occurred while fetching the task data"),y(!1))}},oe=()=>{n(!0),U.put(`${ss}/tasks/update-participation/${P}`,{uid:s,notes:w}).then(ae=>{console.log(ae),o(!0),n(!1),X.fire({icon:"success",text:ae.data.message||"Your participation was successfully updated."})}).catch(ae=>{console.log("erriquwhxoniuqwhiuqwdh",ae),n(!1),X.fire({icon:"error",text:ae.response.data.message||"There was an error updating your participation."})})},ge=()=>{(r==null?void 0:r.type)==="assigned"&&(r==null?void 0:r.assigned_to)===s?X.fire({icon:"info",title:"Do you want to continue?",text:"This task has been assigned to you, if you continue, you will submit the task for review. If you have added other contributors to this task, make sure they have all finished their contributions, otherwise they will not be able to push any more changes once in review.",showCancelButton:!0,confirmButtonText:"Continue",cancelButtonText:"Cancel",reverseButtons:!0}).then(ae=>{ae.isConfirmed&&E(!0)}):X.fire({icon:"info",title:"Do you want to continue?",text:"If you press continue it establishes that your participation has ended and you will not be able to push any more changes to this task. Once all collaborators on the task finish their participation, the task will be sent for review. This action is irreversible.",showCancelButton:!0,confirmButtonText:"Continue",cancelButtonText:"Cancel",reverseButtons:!0}).then(ae=>{ae.isConfirmed&&E(!0)})};return t.useEffect(()=>{y(!0),G()},[P]),e.jsxs("div",{className:"flex flex-col w-[95%] h-[80%] pb-1 rounded-2xl settask-container bg-white/40",style:{backgroundImage:`url(${Ae})`,backgroundPosition:"center bottom"},children:[R&&e.jsx($l,{setIsTaskCOpen:Y,isTaskCOpen:R,repoID:r==null?void 0:r.repository_related_id._id,taskId:r==null?void 0:r._id,task:r,uid:s}),I&&e.jsx(Ll,{setIsNotesOpen:F,isNotesOpen:I,taskNotes:T,setTaskNotes:L}),u&&e.jsx(kl,{isDiffModalOpen:u,setIsDiffModalOpen:D,commits:h,selecteDiffData:m}),$&&e.jsx(Dl,{open:$,setOpen:E,notes:w,setNotes:v,handleParticipation:oe}),A&&e.jsx(Sl,{reasons:r==null?void 0:r.reasons_for_rejection,setIsTaskReasonsOpen:_,isTaskReasonsOpen:A}),C?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(_e,{color:"#32174D"})}):p?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx("h1",{className:"text-red-500",children:N})}):e.jsxs("div",{className:"flex flex-grow bg-white-900 rounded-2xl glassi border border-gray-100  py-7 pr-7 ",children:[e.jsxs("div",{id:"TleftPanel",className:"relative w-[65%] h-full px-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex flex-col",children:[(r==null?void 0:r.assigned_to)===s&&e.jsxs("p",{className:"flex text-[12px] font-semibold text-center",children:[" ",e.jsx(fa,{className:"text-xl text-black mr-2"}),"  This task has been assigned to you"]}),e.jsx("h1",{className:"text-blue-700 text-3xl font-bold",children:r==null?void 0:r.task_name})]}),e.jsx("button",{onClick:()=>navigator.clipboard.writeText(r==null?void 0:r._id),children:e.jsx(he,{title:"Copy Task ID",arrow:!0,placement:"top",children:e.jsx(bs,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0,className:"w-5 h-5 cursor-pointer hover:text-blue-500 transition-all duration-200 ease-in-out transform active:translate-y-[2px]"})})}),e.jsx("button",{onClick:()=>Y(!0),children:e.jsx(he,{title:"Task contributors",arrow:!0,placement:"top",children:e.jsx(Ar,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0,className:"w-5 h-5 cursor-pointer hover:text-blue-500 transition-all duration-200 ease-in-out transform active:translate-y-[2px]"})})})]}),e.jsx("p",{className:"text-xl",children:r==null?void 0:r.task_description}),e.jsxs("div",{className:"flex space-x-[30px] w-full pl-2 items-center ",children:[e.jsxs("div",{className:"flex  items-center ",children:[e.jsx(ir,{size:28,color:"#6082B6",className:"mb-[2px]"}),e.jsxs("p",{className:"text-[12px] font-semibold ml-4",children:[" ",r==null?void 0:r.project.name]})]}),e.jsxs("div",{className:"flex   items-center  ",children:[e.jsx(Ht,{size:38,color:"#ffafcc"}),e.jsx("p",{className:"text-[12px] font-semibold ml-4",children:r==null?void 0:r.layer_related_id.name})]}),e.jsxs("div",{className:"flex   items-center  ",children:[e.jsx(wt,{size:34,color:"#80ed99"}),e.jsx("p",{className:"text-[12px] font-semibold ml-4",children:r==null?void 0:r.repository_related_id.name})]}),e.jsx("div",{className:"flex   items-center ",children:(r==null?void 0:r.status)==="completed"?e.jsxs(e.Fragment,{children:[e.jsx(qt,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0,className:"w-[26px] h-[26px] text-blue-500"}),e.jsx("p",{className:"text-[12px] font-semibold ml-4",children:xt(r==null?void 0:r.status)})]}):(r==null?void 0:r.status)==="approval"?e.jsxs(e.Fragment,{children:[e.jsx(Gt,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0,className:"w-[26px] h-[26px] text-yellow-500"}),e.jsx("p",{className:"text-[12px] font-semibold ml-4",children:"Waiting for approval"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ys,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0,className:"w-[26px] h-[26px] text-[#FF0800]"}),e.jsx("p",{className:"text-[12px] font-semibold ml-4",children:xt(r==null?void 0:r.status)})]})})]})]}),e.jsxs("div",{id:"goals",className:"flex flex-col flex-grow mt-5",children:[e.jsx("h2",{className:"font-semibold mb-2",children:"Goals"}),r==null?void 0:r.goals.map((ae,le)=>e.jsx("div",{className:"goal-item p-2 m-2 bg-white rounded shadow",children:e.jsx("p",{className:"text-gray-700 text-sm",children:ae})},le))]}),e.jsxs("div",{className:"absolute flex-grow bottom-0 w-[94%]",children:[(r==null?void 0:r.readyContributors)&&(r==null?void 0:r.readyContributors.length)>0&&e.jsx("div",{className:"flex items-center mb-2 w-full max-h-[820px]",children:e.jsx(bl,{items:r.readyContributors,commits:h})}),(r==null?void 0:r.status)==="completed"?e.jsx("div",{className:"flex items-center justify-center w-full p-4",children:e.jsx("p",{className:"text-xl font-semibold text-blue-500",children:"Task Completed."})}):(r==null?void 0:r.status)==="approval"?e.jsx("div",{className:"flex items-center justify-center w-full p-4",children:e.jsx("p",{className:"text-xl font-semibold text-yellow-600",children:"Waiting for approval."})}):l?e.jsx("div",{className:"flex items-center justify-center w-full p-4",children:e.jsx("p",{className:"text-xl font-semibold text-blue-500",children:"Contributions Finished."})}):e.jsx("button",{onClick:ge,className:"flex justify-center overflow-y-hidden  p-4 rounded-2xl border-[1px] border-gray-400 w-full  max-h-[57px] overflow-x-auto font-semibold bg-green-400/20 transition-all duration-200 ease-in-out transform active:translate-y-[2px]",children:b?e.jsx(_e,{height:20,width:3,color:"#32174D"}):e.jsx("p",{className:"w-[50%] transition-transform duration-200 ease-in-out hover:scale-110",children:(r==null?void 0:r.assigned_to)===s?"Send task for revision":"Finish contributions"})})]})]}),e.jsxs("div",{id:"TrightPanel",className:"flex flex-col flex-grow  border-[1px]  border-gray-400 rounded-2xl glassi",children:[e.jsxs("div",{className:"flex itesm-center justify-between pt-5 px-7",children:[e.jsx("h4",{className:"font-semibold",children:"Task Activity"}),e.jsxs("div",{className:"flex space-x-2",children:[(r==null?void 0:r.reasons_for_rejection)&&(r==null?void 0:r.reasons_for_rejection.length)>0&&e.jsx("button",{onClick:()=>_(!0),children:e.jsx(Fr,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0,className:"w-5 h-5 hover:text-red-600 transition-colors duration-100"})}),T.length>0&&e.jsx("button",{onClick:()=>F(!0),children:e.jsx(Mr,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0,className:"w-5 h-5 hover:text-green-600 transition-colors duration-100"})}),e.jsx("button",{onClick:()=>{k({hash:"",new:void 0}),D(!0)},children:e.jsx(cr,{size:20,className:"hover:text-yellow-500 transition-colors duration-100"})})]})]}),e.jsx(jl,{data:d,commitsDetailsByDay:c,createdAt:r==null?void 0:r.createdAt}),e.jsx("div",{id:"hashes-users",className:"flex flex-grow flex-col min-h-[460px] max-h-[460px] overflow-auto w-[92%] mx-auto border-t-[1px] pt-4 border-gray-400",children:h&&h.length>0?h.map((ae,le)=>e.jsxs("div",{onClick:()=>{k({hash:ae.uuid,new:!0}),D(!0)},className:"flex max-w-[380px] mx-auto items-center p-2 bg-white rounded shadow mb-2 pl-4 hover:bg-gray-300 transition-colors duration-200 cursor-pointer",children:[e.jsx("img",{src:ae.author.photoUrl||Ye(ae.author.name),alt:ae.author.name,className:"w-9 h-9 rounded-full mr-3",onError:ee=>{const K=ee.target;K.onerror=null,K.src=Ye(ae.author.name)}}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between pr-2",children:[e.jsx("span",{className:"text-[14px] font-semibold",children:ae.author.name}),e.jsx("span",{className:"text-[12px] font-semibold",children:B(ae.createdAt)})]}),e.jsxs("span",{className:"text-[14px] text-gray-600",children:["committed with hash ",e.jsx("span",{className:"font-mono bg-gray-100 rounded px-1",children:ae.uuid})]})]})]},le)):e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx("h1",{className:"text-gray-500",children:"No commits yet on this task"})})})]})]})]})};function Pl(){return e.jsx(Il,{className:"w-full px-7 md:auto-rows-[355px]",children:Al.map((a,s)=>e.jsx(_l,{title:a.title,description:a.description,src:a.src,textColor:a.textColor,className:a.className},s))})}const Il=({className:a,children:s})=>e.jsx("div",{className:Le("grid md:auto-rows-[18rem] grid-cols-1 md:grid-cols-3 gap-4",a),children:s}),_l=({src:a,className:s,textColor:l,title:o,description:c,header:i})=>e.jsxs("div",{style:{backgroundImage:`url(${a})`,backgroundSize:"cover",backgroundPosition:"center"},className:Le("cursor-pointer row-span-1  rounded-xl group/bento hover:shadow-xl transition duration-200 shadow-input dark:shadow-none p-4 dark:bg-black dark:border-black/[0.2] bg-white  border border-transparent flex flex-col space-y-4 justify-end pb-10 pl-5",s),children:[i,e.jsxs("div",{className:"group-hover/bento:translate-x-2 transition duration-200",children:[e.jsx(Do,{className:Le("h-4 w-4",l)}),e.jsx("div",{className:Le("font-sans font-bold mb-2 mt-2",l),children:o}),e.jsx("div",{className:Le("font-sans font-normaltext-xs",l),children:c})]})]}),as=()=>e.jsx("div",{className:"flex flex-1 w-full h-full min-h-[6rem] rounded-xl   dark:bg-dot-white/[0.2] bg-dot-black/[0.2] [mask-image:radial-gradient(ellipse_at_center,white,transparent)]  border border-transparent dark:border-white/[0.2] bg-neutral-100 dark:bg-black"}),Al=[{title:"PrJManager",textColor:"text-neutral-600 dark:text-neutral-700",src:ft,description:"Discover how to reduce entropy in a chaotic world.",header:e.jsx(as,{}),className:"md:col-span-3"},{title:"PrJExtension",textColor:"text-neutral-600 dark:text-neutral-200",src:Ya,description:"Explore the dynamic use of the PrJManager extension that mimics the Git system.",header:e.jsx(as,{}),className:"md:col-span-2"},{title:"PrJConsole",textColor:"text-neutral-600 dark:text-neutral-200",src:qa,description:"An introduction to the PrJManager interactive console commands.",header:e.jsx(as,{}),className:"md:col-span-1"}],Fl=()=>e.jsx("div",{className:"flex flex-grow w-full",children:e.jsx(Pl,{})}),Ml=({items:a,className:s,navigate:l})=>{const[o,c]=t.useState(null);return e.jsx("div",{className:Le("grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 px-9",s),children:a.map((i,d)=>e.jsxs("button",{onClick:()=>l(`${we(i.name)}`,{state:{project:{ID:i.pid,name:i.name,accessLevel:(i==null?void 0:i.accessLevel)||null}}}),className:"relative group  block p-2 h-[240px] w-full",onMouseEnter:()=>c(d),onMouseLeave:()=>c(null),children:[e.jsx(Qe,{children:o===d&&e.jsx(Ue.span,{className:"absolute inset-0 h-full w-full bg-neutral-200 dark:bg-slate-600/[0.8] block  rounded-3xl",layoutId:"hoverBackground",initial:{opacity:0},animate:{opacity:1,transition:{duration:.15}},exit:{opacity:0,transition:{duration:.15,delay:.2}}})}),e.jsxs(Rl,{children:[e.jsx(zl,{children:i.name}),e.jsx(Ul,{children:i.description})]})]}))})},Rl=({className:a,children:s})=>e.jsx("div",{className:Le("rounded-2xl h-full w-full  overflow-hidden border-[1px] border-gray-400 group-hover:border-slate-700 relative z-20",a),style:{backgroundImage:`url(${ft})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"relative z-50 h-full backdrop-blur-2xl bg-white/50",children:e.jsx("div",{className:"p-6",children:s})})}),zl=({className:a,children:s})=>e.jsx("h4",{className:Le("text-black font-bold tracking-wide mt-3 text-xl text-left",a),children:s}),Ul=({className:a,children:s})=>e.jsx("p",{className:Le("mt-5 text-black tracking-wide leading-relaxed text-sm text-left line-clamp-5",a),children:s}),Bl={projects:[],current:[],topProjects:[],loading:!1,error:null},Xa=fs({name:"auth",initialState:Bl,reducers:{startProjects:(a,{payload:s})=>{a.projects=s,a.loading=!1},barsPerProjectId:(a,{payload:s})=>{a.current=[],s.forEach(l=>{a.current.push(l)}),a.loading=!1},addProject:(a,{payload:s})=>{a.projects.push(s),a.loading=!1},addTopProject:(a,{payload:s})=>{console.log(s),a.topProjects=s,a.loading=!1},editProject:(a,{payload:s})=>{console.log(a),console.log(s)},deleteProject:(a,{payload:s})=>{console.log(a),console.log(s)},checkingProjects:(a,{payload:s})=>{a.loading=s}}}),{startProjects:Ol,barsPerProjectId:vx,addProject:wx,addTopProject:Nx,editProject:Cx,deleteProject:kx,checkingProjects:Sx}=Xa.actions,Vs="/assets/projectform-B8r-soAh.jpg",Wl=({setNextStep:a,readmeContent:s,setFieldValue:l})=>{const[o,c]=t.useState(!1),i=g=>{l("readmeContent",g.target.value)};return e.jsxs("div",{className:"flex flex-col space-y-5",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx(Jt,{className:"w-5 h-5 cursor-pointer",onClick:()=>a(!1),onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx("h1",{className:"text-2xl font-bold text-sky-950",children:"Readme Preview"})]}),e.jsx("button",{type:"button",onClick:()=>c(!o),className:"bg-sky-950 text-white rounded-md px-4 py-2",children:o?"Preview":"Edit"})]}),o?e.jsx(Q,{id:"outlined-multiline-static",label:"Readme",multiline:!0,fullWidth:!0,rows:20,value:s,onChange:i,variant:"outlined"}):e.jsx("div",{className:"markdown-body p-6 max-h-[500px] min-h-[500px] overflow-y-auto rounded-b-2xl",children:e.jsx(Xt,{children:s||`
# Nombre del Proyecto

## Descripción
Una breve descripción del proyecto, explicando su propósito, funcionalidades principales y tecnologías utilizadas.

## Tabla de Contenidos
1. [Instalación](#instalación)
2. [Uso](#uso)
3. [Contribuciones](#contribuciones)
4. [Licencia](#licencia)
5. [Contacto](#contacto)
`})}),!o&&e.jsx("div",{className:"flex w-full h-full justify-center items-center ",children:e.jsx("button",{type:"submit",className:"w-[95%] h-[55px] rounded-extra p-2 bg-blue-400/20 shadow-sm border-[1px] border-gray-400 transition-colors duration-300 ease-in-out transform active:translate-y-[2px]",children:"Create Project"})})]})},Hl="http://localhost:3000/api",Yl=({uid:a,isProjectFormOpen:s,setIsProjectFormOpen:l})=>{const[o,c]=t.useState(!1),[i,d]=t.useState(!1),[g,h]=t.useState(!0),[f,r]=t.useState(!1),[S,T]=t.useState(!1),L=(j,p)=>{if(g){const x=`
# ${j.name}
${j.description}

## Tags
${j.tags.length>0?j.tags.join(" "):"No tags specified"}
            `;p("readmeContent",x),h(!1)}},C=()=>{const j=document.getElementById("projectFormModal");j&&(j.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{l(!1)},500))},y=({values:j})=>(t.useEffect(()=>{const p=j.name.length===0||j.visibility===""||j.description.length===0||j.endDate===null;r(p)},[j]),null),N=async(j,{setSubmitting:p,resetForm:x})=>{var b;c(!0),p(!0),d(!1);try{const n=await U.post(`${Hl}/projects/create-project`,j,{params:{uid:a},headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}});x(),p(!1),C(),X.fire({title:"Project Created",text:n.data.message||"Your project has been created successfully",icon:"success",confirmButtonText:"Ok"})}catch(n){const m=n;p(!1),c(!1),m.response?((b=m==null?void 0:m.response.data)==null?void 0:b.type)==="projects-limit"?X.fire({icon:"error",title:`User Projects limit reached
 ( 3 projects )`,text:m.response.data.message}):X.fire({icon:"error",title:"Oops...",text:m.response.data.message}):X.fire({icon:"error",title:"Error",text:"An unexpected error occurred"})}};return t.useEffect(()=>{if(s){const j=setTimeout(()=>{var p,x;(p=document.getElementById("projectFormModal"))==null||p.classList.remove("opacity-0"),(x=document.getElementById("projectFormModal"))==null||x.classList.add("opacity-100")},20);return()=>clearTimeout(j)}},[s]),t.useEffect(()=>{const j=new Image;j.src=Vs,j.onload=()=>{T(!0)}},[]),e.jsx("div",{id:"projectForm",className:"fixed flex w-screen h-full pb-5 top-0 right-0 justify-center items-center bg-black/30 z-50",children:e.jsxs("div",{id:"projectFormModal",className:`flex flex-col space-y-5 w-[70%] md:w-[50%] rounded-2xl pb-4 border-[1px] glass2 border-gray-400 transition-opacity duration-300 ease-in-out opacity-0 ${s?"":"pointer-events-none"}`,style:{backgroundImage:`url(${Vs})`,backgroundPosition:"bottom right"},children:[e.jsxs("div",{className:"flex justify-between w-[95%] h-12 ml-auto mr-auto mt-2 p-2 border-b-2 border-b-gray-500",children:[e.jsx("p",{className:"text-xl text-black",children:"Create a new Project"}),e.jsx("button",{onClick:C,children:e.jsx($e,{})})]}),o||!S?e.jsx("div",{className:"flex h-[468px] items-center justify-center ",children:e.jsx(Ce,{color:"#007BFF",loading:!0,size:150})}):e.jsx("div",{className:"flex flex-col w-[95%] h-[80%] ml-auto mr-auto mt-2 p-2",children:e.jsx(st,{initialValues:{name:"",description:"",visibility:"",tags:[],endDate:null,readmeContent:""},validationSchema:ut({name:Ne().required("Required"),description:Ne().required("Required"),visibility:Ne().required("Required"),endDate:wa().required("Required")}),onSubmit:N,children:({values:j,errors:p,touched:x,isSubmitting:b,handleChange:n,setFieldValue:m,handleBlur:k})=>e.jsxs(at,{className:"flex flex-col space-y-8",children:[e.jsx(y,{values:j}),i?e.jsx(Wl,{setNextStep:d,readmeContent:j.readmeContent,setFieldValue:m}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(Q,{id:"name",name:"name",value:j.name,label:"Project Name",variant:"outlined",onChange:n,fullWidth:!0}),e.jsxs(ht,{fullWidth:!0,children:[e.jsx(mt,{id:"visibility",children:"Project Visibility"}),e.jsxs(Ie,{id:"visibility",name:"visibility",value:j.visibility,label:"Project Visibility",variant:"outlined",className:"w-full",onChange:n,children:[e.jsx(J,{value:"",children:"Select Project Visibility"}),e.jsx(J,{value:"public",children:"Public"}),e.jsx(J,{value:"private",children:"Private"})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-6",children:[e.jsx(Q,{name:"endDate",label:p.endDate&&x.endDate?"EndDate is required":"End Date",type:"date",InputLabelProps:{shrink:!0},fullWidth:!0,value:j.endDate?j.endDate:"",onChange:n,onBlur:k,error:!!p.endDate&&x.endDate}),e.jsx(Xe,{multiple:!0,id:"tags-autocomplete",options:j.tags,freeSolo:!0,value:j.tags,onChange:(u,D)=>{const I=D.map(R=>{const A=R.trim().replace(/\s+/g,"-");return A.startsWith("#")?A:`#${A}`}),F=Array.from(new Set(I));m("tags",F)},renderTags:(u,D)=>e.jsx("div",{className:"max-h-[40px] overflow-y-auto",children:u.map((I,F)=>e.jsx(ot,{variant:"outlined",label:I,...D({index:F})}))}),renderInput:u=>e.jsx(Q,{...u,label:"Tags",fullWidth:!0})})]}),e.jsx(Q,{id:"description",name:"description",label:"Description",value:j.description,onChange:n,onBlur:k,multiline:!0,fullWidth:!0,rows:4}),e.jsx("div",{className:"flex w-full h-full justify-center items-center",children:e.jsx("button",{onClick:()=>{L(j,m),d(!0)},className:`w-[95%] h-[55px] rounded-extra p-2 ${f?"backdrop-blur-sm":"backdrop-blur-sm bg-green-400/20 shadow-sm"} border-[1px] border-gray-400 transition-colors duration-300 ease-in-out transform active:translate-y-[2px]`,disabled:b||f,children:"Next"})})]})]})})})]})})},ql="http://localhost:3000/api",Gl=()=>{var C;const a=Ee(),s=ye(),l=gt(),o=(C=s.state)==null?void 0:C.project.ID,[c,i]=t.useState(!0),[d,g]=t.useState(null),{uid:h}=te(y=>y.auth),[f,r]=t.useState(!1),{projects:S}=te(y=>y.projects),T=t.useCallback(()=>{U.get(`${ql}/projects/get-projects/${h}`).then(y=>{l(Ol(y.data)),i(!1)}).catch(y=>{i(!1),console.log(y)})},[h,l]),L=t.useMemo(()=>d?S.filter(y=>y.name.toLowerCase().includes(d.toLowerCase())):S,[S,d]);return t.useEffect(()=>{T()},[T]),c?e.jsx("div",{className:"flex flex-col flex-grow items-center justify-center ",children:e.jsx(Ce,{color:"#007BFF",loading:!0,size:150})}):e.jsxs("div",{id:"projects",className:"flex flex-col flex-grow overflow-y-auto",children:[f&&e.jsx(Yl,{uid:h,isProjectFormOpen:f,setIsProjectFormOpen:r}),o?e.jsx(rt,{}):e.jsxs("div",{className:"flex flex-col w-full h-full",children:[e.jsxs("div",{className:"flex p-4 justify-between w-full h-24",children:[e.jsx("div",{className:"flex space-x-5 w-1/2 h-full ",children:e.jsx("h1",{className:"text-sky-950 font-bold mt-3 text-2xl ml-7",children:"Projects"})}),e.jsxs("div",{className:"flex space-x-6 h-full mr-7",children:[S.length!==0&&e.jsx(Q,{id:"outlined-basic",label:"Search Project",variant:"outlined",className:"w-96",onChange:y=>g(y.target.value)}),e.jsx("div",{className:"flex space-x-5  h-full justify-end",children:e.jsx("button",{onClick:()=>r(!0),className:"glassi hover:glassi-hover flex justify-center items-center px-4 h-14 rounded-2xl border-1 border-gray-400  transition-all duration-300 ease-in-out transform active:translate-y-[5px]",children:e.jsx(dr,{className:"text-2xl text-sky-950"})})})]})]}),S.length===0?e.jsxs("div",{className:"flex flex-col w-full h-full space-y-4 items-center justify-center",children:[e.jsx("h1",{className:"text-sky-950 font-bold text-2xl",children:"You do not own or are part of any project yet"}),e.jsx("p",{className:"text-sky-950 ",children:"Start Creating a new project or join an existing one!"})]}):e.jsx(Ml,{items:L,navigate:a})]})]})},Jl=({readmeContent:a})=>{const[s,l]=t.useState(!1);return e.jsxs("div",{className:"layout-cards rounded-extra",children:[e.jsxs(Ue.div,{className:`flex justify-center items-center py-6 bg-blue-200/40 border-[1px] border-gray-400 ${s?"opened-card":"card"}`,layout:!0,onTap:()=>l(!s),initial:{opacity:0},animate:{opacity:1},transition:{layout:{duration:.5,ease:[.1,.95,.53,.98]}},children:[!s&&e.jsx("h2",{className:"font-semibold",children:"README.MD"}),s&&e.jsx("div",{className:"markdown-body overflow-y-auto p-8 max-h-[645px]",children:e.jsx(Xt,{children:a})})]}),e.jsx(Ue.div,{className:"dim-layer",animate:{opacity:s?.3:0}})]})},ea="http://localhost:3000/api",Xl=(a,s)=>{const[l,o]=t.useState([]),[c,i]=t.useState(new Map),[d,g]=t.useState(new Date().getFullYear().toString()),[h,f]=t.useState(null),[r,S]=t.useState(!1),T=y=>{const N=new Date(y),j=N.getUTCFullYear(),p=String(N.getUTCMonth()+1).padStart(2,"0"),x=String(N.getUTCDate()).padStart(2,"0");return`${j}/${p}/${x}`},L=y=>{const N=y.split("/"),j=N[0],p=N[1].padStart(2,"0"),x=N[2].padStart(2,"0");return`${j}/${p}/${x}`},C=t.useCallback((y,N)=>{const j={},p={};y.forEach(b=>{const n=T(b.createdAt);j[n]||(j[n]={count:0,commits:0,tasks:0},p[n]={commits:0,tasks:0}),j[n].commits+=1,j[n].count+=1,p[n].commits+=1}),N.forEach(b=>{const n=T(b.updatedAt);j[n]||(j[n]={count:0,commits:0,tasks:0},p[n]={commits:0,tasks:0}),j[n].tasks+=1,j[n].count+=1,p[n].tasks+=1});const x=Object.keys(j).map(b=>({date:b,count:j[b].count}));o(x),i(new Map(Object.entries(p)))},[]);return t.useEffect(()=>{(async()=>{try{const N=await U.get(`${ea}/tasks/activity/${a}`,{params:{year:d,uid:s},headers:{Authorization:localStorage.getItem("x-token")}}),j=await U.get(`${ea}/commits/activity-data/${a}`,{params:{year:d,uid:s},headers:{Authorization:localStorage.getItem("x-token")}});C(j.data.commits,N.data.tasks)}catch(N){const j=N;j.response?(f(j.response.data.message||"An error occurred while fetching data"),S(!0)):(f("An error occurred while fetching data"),S(!0))}})()},[a,d,C,s]),{data:l,detailsMap:c,formatDateFromHeatMap:L,year:d,setYear:g,errorMessage:h,errorWhileFetching:r}},Ql=({project:a,projectID:s})=>{const{uid:l}=te(N=>N.auth),{data:o,year:c,setYear:i,detailsMap:d,formatDateFromHeatMap:g,errorMessage:h,errorWhileFetching:f}=Xl(s,l),r=new Date(a.startDate).getFullYear(),S=new Date().getFullYear(),T=Array.from({length:S-r+1},(N,j)=>r+j),L=new Date(`${c}/01/01`),C=new Date(`${c}/12/31`),y=({formattedDate:N,details:j})=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("h3",{children:[N," |"]}),e.jsxs("button",{className:"hover:text-yellow-200 transition-colors duration-100",onClick:()=>console.log(`Commits: ${j.commits}`),children:["Commits: ",j.commits]}),e.jsxs("button",{className:"hover:text-blue-200 transition-colors duration-100",onClick:()=>console.log(`Tasks: ${j.tasks}`),children:["Tasks: ",j.tasks]})]});return e.jsx("div",{className:"border-[1px] border-gray-400 w-full flex flex-col h-[250px] rounded-2xl bg-blue-200/40",children:f?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsxs("h2",{className:"text-lg font-semibold text-red-400",children:[" ",h," "]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex w-full pt-5 items-center px-[60px] justify-between",children:[e.jsx("div",{className:"flex space-x-3",children:e.jsx("h2",{className:"text-lg font-semibold",children:"General Contributions"})}),e.jsx(Q,{select:!0,value:c,onChange:N=>i(N.target.value),variant:"standard",size:"small",className:"w-40",children:T.map(N=>e.jsx(J,{value:N.toString(),children:N},N))})]}),e.jsx("div",{className:"flex flex-grow items-center justify-center w-full pt-1",children:e.jsx(At,{rectSize:13,value:o,width:850,startDate:L,endDate:C,panelColors:{0:"#eff7ff",2:"#90e0ef",4:"#0096c7",10:"#0077b6",20:"#03045e",30:"black"},rectRender:(N,j)=>{const p=g(j.date),x=d.get(p)||{commits:0,tasks:0};return e.jsx(he,{title:e.jsx(y,{formattedDate:p,details:x}),placement:"right",children:e.jsx("rect",{...N})})}})})]})})},Zl="http://localhost:3000/api",ta=({project:a,projectID:s,firstTime:l})=>{const[o,c]=t.useState(0),[i,d]=t.useState(""),[g,h]=t.useState(!0);return t.useEffect(()=>{a.readme&&U.get(`${Zl}/projects/readme/${a.readme}`,{headers:{Authorization:localStorage.getItem("x-token")}}).then(f=>{const r=f.data.readmeContent;d(r)}).catch(f=>{console.log(f)})},[a.readme]),t.useEffect(()=>{if(l){let r=0;const S=setInterval(()=>{r++,c(r),r>9&&clearInterval(S)},1e3);return()=>clearInterval(S)}else h(!1),c(10)},[l]),e.jsxs("div",{className:"flex flex-col space-y-4 px-10 h-full w-full pt-9 pb-6",children:[e.jsx(Qe,{children:e.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5,delay:.5},className:"absolute text-[45px] mb-2 font-bold top-6 animated-element truncate w-[57%]",children:g?`Welcome to ${a.name}`:a.name})}),o>0&&e.jsx(Qe,{children:e.jsx(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5,delay:.5},className:"animated-element",children:e.jsx("p",{className:"text-2xl line-clamp-2 w-[95%]",children:a.description})})}),o>1&&e.jsxs("div",{className:"flex space-x-10",children:[e.jsx(Qe,{children:e.jsx(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5,delay:.6},className:"animated-element",children:e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx(Yt,{className:"w-8 h-8 text-pink-400 mr-3"}),e.jsxs("p",{className:"flex text-[20px] mt-2 font-extralight",children:[e.jsx("span",{className:"font-semibold text-pink-400 mr-3",children:dt(a.layers||0)}),"Layers"]})]})})}),o>2&&e.jsx(Qe,{children:e.jsx(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5,delay:.7},className:"animated-element",children:e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx(wt,{className:"w-9 h-9 text-green-400 mr-3"}),e.jsxs("p",{className:"flex text-[20px] mt-2 font-extralight",children:[e.jsx("span",{className:"font-semibold text-green-400 mr-3",children:dt(a.repositories||0)}),"Repositories"]})]})})}),o>3&&e.jsx(Qe,{children:e.jsx(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5,delay:.8},className:"animated-element",children:e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx(vs,{className:"w-9 h-9 text-yellow-400 mr-3",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsxs("p",{className:"flex text-[20px] mt-2 font-extralight",children:[e.jsx("span",{className:"font-semibold text-yellow-400 mr-3",children:dt(a.commits||0)}),"Commits"]})]})})}),o>4&&e.jsx(Qe,{children:e.jsx(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5,delay:.9},className:"animated-element",children:e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx(Sa,{className:"w-8 h-8 text-blue-400 mr-3",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsxs("p",{className:"flex text-[20px] mt-2 font-extralight",children:[e.jsx("span",{className:"font-semibold text-blue-400 mr-3",children:dt(a.completedTasks||0)}),"Completed Tasks"]})]})})})]}),o>5&&e.jsx("div",{className:"flex space-x-6",children:e.jsx(Qe,{children:a.tags.map((f,r)=>e.jsx(Ue.span,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5,delay:1+r*.1},className:"text-sm font-mono text-black rounded-extra px-2 py-1 m-1 glassi",children:f},f))})}),a.readme&&i&&o>6&&e.jsx(Qe,{children:e.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},className:"animated-element",children:e.jsx("h2",{className:"text-[30px] mb-2 font-extralight",children:"Here's a Quick Start:"})})}),a.readme&&i&&o>7&&e.jsx(Qe,{children:e.jsx(Jl,{readmeContent:i})}),o>8&&e.jsx(Qe,{children:e.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},className:"flex flex-grow justify-center items-end py-5",children:e.jsx(Ql,{project:a,projectID:s})})})]})},Kl={currentProject:null,layers:[],repositories:[],fetchingResources:!1,errorWhileFetching:!1,errorMessage:null,errorType:null},Qa=fs({name:"platypus",initialState:Kl,reducers:{setCurrentProject:(a,{payload:s})=>{a.currentProject=s},setLayers:(a,{payload:s})=>{a.layers=[],s.forEach(l=>{a.layers.push(l)})},setRepositories:(a,{payload:s})=>{a.repositories=[],s.forEach(l=>{a.repositories.push(l)})},addNewLayer:(a,{payload:s})=>{a.layers.push(s)},addNewLayerRepository:(a,{payload:s})=>{a.repositories.push(s)},setFetchingResources:(a,{payload:s})=>{a.fetchingResources=s},setErrorMessage:(a,{payload:s})=>{a.errorMessage=s},setError:(a,s)=>{a.fetchingResources=s.payload.fetchingResources,a.errorWhileFetching=s.payload.errorWhileFetching,a.errorMessage=s.payload.errorMessage,a.errorType=s.payload.errorType},setErrorType:(a,{payload:s})=>{a.errorType=s}}}),{setCurrentProject:sa,setLayers:Vl,setRepositories:Za,addNewLayer:Dx,addNewLayerRepository:Lx,setFetchingResources:Wt,setError:hs,setErrorMessage:Tx,setErrorType:$x}=Qa.actions,en=({uid:a,project:s,showOptModal:l,setIsProjectConfigFormOpen:o,setIsProjectCollaboratorsFormOpen:c})=>e.jsxs("div",{className:`flex flex-col space-y-2 absolute z-50 bg-white border-[1px] border-black rounded-bl-2xl pb-2 w-[250px] top-[4.4rem] transition-all duration-500 ${l?"right-5":"-right-[20rem]"}`,children:[e.jsx("div",{className:"flex w-full justify-center py-2",children:e.jsx("p",{className:"text-[18px]",children:"Project Options"})}),e.jsxs("div",{className:"flex flex-col  w-full items-center justify-center",children:[s.owner.toString()===a&&e.jsx("button",{onClick:()=>o(!0),className:"w-[90%] border-b-[1px] border-gray-400 hover:bg-blue-200 transition-colors duration-150 py-4 px-4",children:"Project Configuration"}),e.jsx("button",{onClick:()=>c(!0),className:"w-[90%]  hover:bg-blue-200 transition-colors duration-150 py-4 px-4 rounded-bl-2xl",children:"Project Collaborators"})]})]}),tn="http://localhost:3000/api",sn=({isProjectConfigFormOpen:a,setIsProjectConfigFormOpen:s,showOptModal:l,setShowOptModal:o})=>{const c=ye(),{uid:i}=te(A=>A.auth),{currentProject:d}=te(A=>A.platypus),{ID:g}=c.state.project,[h,f]=t.useState(!1),[r,S]=t.useState(!1),[T,L]=t.useState(""),[C,y]=t.useState(!1),[N,j]=t.useState(!1),[p,x]=t.useState(!1),b=d==null?void 0:d.tags.map(A=>A),n=d==null?void 0:d.tags.map((A,_)=>({id:_+1,label:A})),m=()=>{switch(T){case"public":return e.jsx(Ze,{children:'Are you sure you want to change the visibility type? The "Public" type will allow access to everyone.'});case"private":return e.jsx(Ze,{children:'Are you sure you want to change the visibility type? The "Private" type will allow access only to the collaborators invited to the project.'});default:return null}},k=A=>{const _=new Date(A),$=_.getFullYear(),E=(_.getMonth()+1).toString().padStart(2,"0"),w=_.getDate().toString().padStart(2,"0");return`${$}-${E}-${w}`},u=(A,_)=>{const $=A.target.value;$!==(d==null?void 0:d.visibility)?(L($),S(!0)):_("visibility",$)},D=A=>{A("visibility",T),S(!1)},I=()=>{S(!1)},F=()=>{const A=document.getElementById("projectConfigModal");A&&(A.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{s(!1)},500))},R=({values:A})=>(t.useEffect(()=>{const _=A.name===(d==null?void 0:d.name)&&A.visibility===(d==null?void 0:d.visibility)&&A.description===(d==null?void 0:d.description)&&JSON.stringify(A.tags.sort())===JSON.stringify(b==null?void 0:b.sort())&&A.endDate===k(d==null?void 0:d.endDate);j(_)},[A]),null),Y=async(A,{setSubmitting:_,resetForm:$})=>{var E;x(!0),_(!0);try{const w=await U.put(`${tn}/projects/update-project/${g}`,A,{params:{uid:i},headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}});$(),_(!1),x(!1),X.fire({icon:"success",title:"Success",text:w.data.message})}catch(w){const v=w;_(!1),x(!1),v.response?((E=v==null?void 0:v.response.data)==null?void 0:E.type)==="collaborator-validation"?X.fire({icon:"error",title:"Error",text:v.response.data.message}):X.fire({icon:"error",title:"Oops...",text:v.response.data.message}):X.fire({icon:"error",title:"Error",text:"An unexpected error occurred"})}};return t.useEffect(()=>{const A=new Image;A.src=Ae,A.onload=()=>{f(!0)}},[]),t.useEffect(()=>{if(a){const A=setTimeout(()=>{var _,$;(_=document.getElementById("projectConfigModal"))==null||_.classList.remove("opacity-0"),($=document.getElementById("projectConfigModal"))==null||$.classList.add("opacity-100")},20);return()=>clearTimeout(A)}},[a]),t.useEffect(()=>{l&&o(!1)},[l,o]),e.jsx("div",{className:"fixed flex w-screen h-full pb-5 top-0 right-0 justify-center items-center bg-black/30 z-50",children:e.jsxs("div",{id:"projectConfigModal",style:{backgroundImage:h?`url(${Ae})`:"none",backgroundPosition:"top right"},className:`flex flex-col w-[70%] md:w-[50%] md:max-h-[635px] md:h-[635px] items-center rounded-2xl glass2 border-[1px] border-gray-400 transition-opacity duration-300 ease-in-out opacity-0 ${a?"":"pointer-events-none"}`,children:[e.jsxs("div",{className:"flex justify-between w-[95%] h-12 ml-auto mr-auto mt-2 p-2 border-b-2 border-b-gray-500",children:[e.jsx("p",{className:"text-xl text-black",children:"Project Configuration"}),e.jsx("button",{onClick:F,children:e.jsx($e,{})})]}),p||!h?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:h?"#32174D":"#ffffff",size:50})}):e.jsx(st,{onSubmit:Y,initialValues:{name:d==null?void 0:d.name,description:d==null?void 0:d.description,endDate:k(d==null?void 0:d.endDate),visibility:d==null?void 0:d.visibility,tags:b},children:({values:A,setFieldValue:_,handleChange:$,isSubmitting:E})=>e.jsxs(at,{className:"w-[95%] h-full",children:[e.jsx(R,{values:A}),C?e.jsxs("div",{id:"advanced-settings",className:"flex flex-col w-full h-full",children:[e.jsxs("div",{className:"flex justify-between w-full py-4 px-4",children:[e.jsx("p",{className:"",children:"Advanced Settings"}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{className:"hover:text-blue-400 transition-colors duration-300 ease-in-out transform active:translate-y-[2px]",onClick:()=>y(!C),children:"Go Back"})})]}),e.jsxs("div",{className:"flex flex-grow flex-col  pt-4 pb-5 overflow-y-auto",children:[e.jsxs("div",{className:"flex flex-col h-[90%] items-center justify-center space-y-4 p-10",children:[e.jsx("p",{className:"text-xl text-semibold text-center",children:"Deleting the project means that all repositories and layers will be permanently deleted."}),e.jsx("p",{children:"Are you sure you want to delete this project?"})]}),e.jsx("div",{className:"flex w-full justify-center",children:e.jsx("button",{type:"submit",disabled:N||E,className:"w-[95%] h-[55px] rounded-extra backdrop-blur-sm bg-red-500/20 shadow-sm border-[1px] border-gray-400 transition-colors duration-300 ease-in-out transform active:translate-y-[2px]",children:"Delete Project"})})]})]}):e.jsxs("div",{className:"flex flex-col w-full h-full space-y-7 pt-3 pb-6",children:[e.jsx("div",{className:"flex w-full hover:text-blue-400 transition-colors duration-300 justify-end h-[15px] transform active:translate-y-[2px]",children:e.jsx("button",{onClick:()=>y(!C),children:"Advanced Settings"})}),e.jsxs("div",{className:"flex w-full space-x-4",children:[e.jsx(Dt,{style:{width:"50%"},as:Q,label:"Name",name:"name",value:A.name}),e.jsxs(ht,{style:{width:"50%"},children:[e.jsx(mt,{children:"Visibility"}),e.jsxs(Ie,{name:"visibility",value:A.visibility,label:"Visibility",onChange:w=>u(w,_),children:[e.jsx(J,{value:"public",children:"Public"}),e.jsx(J,{value:"private",children:"Private"})]})]}),e.jsxs(Fe,{open:r,onClose:I,children:[e.jsx(Me,{children:"Confirm Visibility Change"}),e.jsx(Re,{children:m()}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:I,children:"Cancel"}),e.jsx(xe,{onClick:()=>D(_),autoFocus:!0,children:"Confirm"})]})]})]}),e.jsx(Q,{fullWidth:!0,name:"endDate",label:"End Date",type:"date",InputLabelProps:{shrink:!0},value:A.endDate,onChange:$}),e.jsx(Xe,{multiple:!0,options:n&&n.length>0?n.map(w=>w.label):[],freeSolo:!0,value:A.tags,onChange:(w,v)=>{_("tags",v.map(P=>P.startsWith("#")?P:`#${P}`))},renderInput:w=>e.jsx(Q,{...w,label:"Tags",placeholder:"Add tags"})}),e.jsx(Dt,{as:Q,label:"Description",name:"description",multiline:!0,rows:6,value:A.description}),e.jsx("div",{className:"flex w-full justify-center",children:e.jsx("button",{type:"submit",disabled:N||E,className:`w-[95%] h-[55px] rounded-extra ${N?"backdrop-blur-sm":"backdrop-blur-sm bg-green-400/20 shadow-sm"} border-[1px] border-gray-400 transition-colors duration-300 ease-in-out transform active:translate-y-[2px]`,children:"Save Changes"})})]})]})})]})})},an="http://localhost:3000/api",Qt=()=>{const[a,s]=t.useState([]),[l,o]=t.useState(""),c=i=>{const d=i.map(g=>({name:g.username,photoUrl:(g==null?void 0:g.photoUrl)||null,id:g.uid,new:!0}));s(d)};return t.useEffect(()=>{if(l===""){s([]);return}U.get(`${an}/users/find-user?search=${l}`).then(i=>{console.log(i.data),c(i.data.users)}).catch(i=>{console.error(i)})},[l]),{users:a,setSearch:o}},rn=({users:a,values:s,setSearch:l,setFieldValue:o,setCurrentOrNew:c})=>{const[i,d]=t.useState(""),[g,h]=t.useState(""),[f,r]=t.useState(!1),[S,T]=t.useState(""),[L,C]=t.useState({name:"",id:"",photoUrl:"",new:!0}),y=(n,m,k)=>{const u=n.collaborators.filter(I=>I.id!==k),D=n.newCollaborators.filter(I=>I.id!==k);m("newCollaborators",D),m("collaborators",u)},N=(n,m)=>{const k={...L,accessLevel:S},u=n.newCollaborators.filter(I=>I.id!==k.id),D=[k,...u];m("newCollaborators",D),r(!1),T("")},j=(n,m)=>{const k=new Set(n.newCollaborators.map(I=>I.id));let u=[...n.newCollaborators,...n.collaborators];u=u.filter(I=>k.has(I.id)||n.collaborators.some(F=>F.id===I.id));const D=Array.from(new Map(u.map(I=>[I.id,I])).values());m("collaborators",D),c(!1)},p=n=>{const m=s.collaborators.some(u=>u.id===(n==null?void 0:n.id)),k=s.newCollaborators.some(u=>u.id===(n==null?void 0:n.id));if(m||k){X.fire({icon:"warning",title:"Oops...",text:"This user is already a collaborator or has been added recently!",confirmButtonColor:"#3b82f6"});return}n!==null&&!s.newCollaborators.some(u=>u.id===n.id)&&(C(n),r(!0))},x=(n,m)=>{h(n),d(m)},b=()=>{d("")};return e.jsxs("div",{id:"newCollaborators",className:"flex flex-col w-full h-full",children:[e.jsxs("div",{className:"flex flex-col w-full h-5/6 px-5",children:[e.jsx(Xe,{fullWidth:!0,options:a,getOptionLabel:n=>n.name,renderOption:(n,m)=>{const k=s.collaborators.some(D=>D.id===m.id),u=s.newCollaborators.some(D=>D.id===m.id);return e.jsx("div",{children:t.createElement("li",{...n,key:m.id,className:`flex p-3 pl-4 ${k||u?null:"cursor-pointer"} justify-between
                                          ${k||u?null:"hover:bg-gray-200 transition-colors duration-200"}`},e.jsxs("div",{className:"flex",children:[e.jsx(Ve,{children:e.jsx(Te,{alt:m.name,src:m.photoUrl||m.name})}),e.jsxs("div",{className:"flex flex-col ml-1",children:[e.jsx(ce,{variant:"body2",children:m.name}),e.jsx("span",{className:"text-[11px]",children:m.id})]})]}),(k||u)&&e.jsx("div",{className:"flex items-center mr-6",children:e.jsx("span",{className:"text-[11px] text-green-400",children:k&&!u?"Already a collaborator":k&&u?"Added recently":null})}))})},renderInput:n=>e.jsx(Q,{...n,onChange:m=>l(m.target.value),label:"Search User by Name or ID"}),filterOptions:(n,{inputValue:m})=>n.filter(k=>k.name.toLowerCase().includes(m.toLowerCase())||k.id.toString().includes(m)),onChange:(n,m)=>p(m)}),e.jsxs(Fe,{open:f,onClose:()=>r(!1),children:[e.jsx(Me,{children:"Set Access Level"}),e.jsx(Re,{children:e.jsxs(Ie,{value:S,onChange:n=>T(n.target.value),fullWidth:!0,children:[e.jsx(J,{value:"contributor",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Contributor"}),e.jsx(he,{title:g,open:i==="contributor",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>x('The Contributor at the project level has access to the Open / Internal layers and repositories of the project, participates in the text and voice chats of the layers where they are a collaborator, in addition to being able to clone the repositories by having a "Reader" access level in the repositories.',"contributor"),onMouseLeave:b,children:e.jsx(Be,{})})})]})}),e.jsx(J,{value:"coordinator",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Coordinator"}),e.jsx(he,{title:g,open:i==="coordinator",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>x('The Coordinator at the project level has all the capabilities of the contributor, he can also manage contributions, approve changes and tasks and coordinate activities within the layers, the level provides a "Coordinator" access level in all the layers where he has access, as well as a "Editor" access level in all repositories where he has access. Finally, the Coordinator can add new collaborators with an access level of "Contributor" or "Reader" in the case of repositories.',"coordinator"),onMouseLeave:b,children:e.jsx(Be,{})})})]})}),e.jsx(J,{value:"administrator",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Administrator"}),e.jsx(he,{title:g,open:i==="administrator",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>x('The Administrator at the project level has all the capabilities of the coordinator, the level provides access to restricted layers and repositories, with an "Administrator" access level on all repositories and layers, finally, he can manage the access level of other collaborators below the "Administrator" access level.',"administrator"),onMouseLeave:b,children:e.jsx(Be,{})})})]})})]})}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:()=>{r(!1),C({name:"",id:"",photoUrl:"",new:!0})},children:"Cancel"}),e.jsx(xe,{onClick:()=>N(s,o),disabled:!S,children:"Add"})]})]}),e.jsx("div",{id:"newCollabsList",className:"flex-grow overflow-y-auto px-3 max-h-[380px]",children:s.newCollaborators.length===0?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("span",{className:"text-sm",children:"No recently added collaborators"})}):e.jsx(pt,{children:s.newCollaborators.map((n,m)=>e.jsxs(Ke,{className:"border-b-[1px] border-gray-400",secondaryAction:e.jsx("button",{className:"mr-3",onClick:()=>y(s,o,n.id),children:e.jsx($e,{size:18,color:"#ef233c"})}),children:[e.jsx(Ve,{children:e.jsx(Te,{alt:n.name,src:n.photoUrl||n.name})}),e.jsx(tt,{primary:n.name,secondary:e.jsxs(e.Fragment,{children:[e.jsxs(ce,{component:"span",variant:"body2",color:"textPrimary",children:["Access Level: ",n.accessLevel]}),e.jsxs(ce,{component:"div",variant:"body2",color:"textSecondary",children:["ID: ",n.id]})]})})]},m))})})]}),e.jsx("div",{className:"flex flex-grow justify-center mx-4  items-center py-4  border-t-[1px] border-gray-400 ",children:e.jsx("button",{type:"button",className:"h-[55px] w-[95%] border-1 border-gray-400  rounded-extra glassi transition-transform duration-150 ease-in-out transform active:translate-y-[2px]",onClick:()=>j(s,o),children:"Update new Collaborators"})})]})},aa="http://localhost:3000/api",on=({setIsProjectCollaboratorsFormOpen:a,isProjectCollaboratorsFormOpen:s,showOptModal:l,setShowOptModal:o})=>{const c=ye(),{ID:i}=c.state.project,{uid:d}=te(E=>E.auth),{currentProject:g}=te(E=>E.platypus),{users:h,setSearch:f}=Qt(),[r,S]=t.useState([]),[T,L]=t.useState(!1),[C,y]=t.useState(!1),[N,j]=t.useState(""),[p,x]=t.useState(!1),[b,n]=t.useState(!1),[m,k]=t.useState(!1),[u,D]=t.useState(!1),[I,F]=t.useState({name:"",accessLevel:"",id:""}),R=()=>{const E=document.getElementById("projectCollaboratorModal");E&&(E.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{a(!1)},500))},Y=({values:E})=>(t.useEffect(()=>{const w=E.newCollaborators.length===0&&E.modifiedCollaborators.length===0&&E.deletedCollaborators.length===0;n(w)},[E]),null),A=E=>{const w=E.map(v=>({name:v.name,photoUrl:v.photoUrl,id:v.uid,accessLevel:v.project.accessLevel}));S(w),D(!1)},_=async(E,{setSubmitting:w,resetForm:v})=>{var P;y(!0),w(!0);try{const M=await U.put(`${aa}/projects/collaborators/${i}`,E,{params:{uid:d},headers:{Authorization:localStorage.getItem("x-token")}});v(),w(!1),y(!1),R(),X.fire({icon:"success",title:"Success",text:M.data.message})}catch(M){const B=M;w(!1),y(!1),B.response?((P=B==null?void 0:B.response.data)==null?void 0:P.type)==="collaborator-validation"?X.fire({icon:"error",title:"Error",text:B.response.data.message}):X.fire({icon:"error",title:"Oops...",text:B.response.data.message}):X.fire({icon:"error",title:"Error",text:"An unexpected error occurred"})}},$=(E,w,v,P,M)=>{const B=E.target.value;if(B===w.accessLevel)return;const W=P.values.collaborators.map((oe,ge)=>ge===v?{...oe,accessLevel:B}:oe);P.setFieldValue("collaborators",W);const q=M.find(oe=>oe.id===w.id);if(B===(q==null?void 0:q.accessLevel)){const oe=P.values.modifiedCollaborators.filter(ge=>ge.id!==w.id);P.setFieldValue("modifiedCollaborators",oe)}const G=P.values.modifiedCollaborators.findIndex(oe=>oe.id===w.id);G>-1?P.values.modifiedCollaborators[G].accessLevel=B:P.setFieldValue("modifiedCollaborators",[...P.values.modifiedCollaborators,{...w,accessLevel:B}])};return t.useEffect(()=>{const E=new Image;E.src=Ae,E.onload=()=>{k(!0)}},[]),t.useEffect(()=>{D(!0),U.get(`${aa}/projects/collaborators/${i}`,{headers:{Authorization:localStorage.getItem("x-token")}}).then(E=>{const w=E.data.collaborators;A(w)}).catch(E=>{console.log(E)})},[i]),t.useEffect(()=>{if(s){const E=setTimeout(()=>{var w,v;(w=document.getElementById("projectCollaboratorModal"))==null||w.classList.remove("opacity-0"),(v=document.getElementById("projectCollaboratorModal"))==null||v.classList.add("opacity-100")},20);return()=>clearTimeout(E)}},[s]),t.useEffect(()=>{l&&o(!1)},[l,o]),e.jsx("div",{className:"fixed flex w-screen h-full pb-5 top-0 right-0 justify-center items-center bg-black/30 z-50",children:e.jsx("div",{id:"projectCollaboratorModal",className:`flex flex-col space-y-5 w-[70%] md:w-[50%] md:h-[620px] rounded-2xl glass2 border-[1px] border-gray-400 transition-opacity duration-300 ease-in-out opacity-0 ${s?"":"pointer-events-none"}`,style:{backgroundImage:m?`url(${Ae})`:"none"},children:C||!m?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:m?"#32174D":"#ffffff",size:50})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between w-[95%] h-12 ml-auto mr-auto mt-2 p-2 border-b-2 border-b-gray-500",children:[e.jsx("p",{className:"text-xl text-black",children:"Project Collaborators"}),e.jsx("button",{onClick:R,children:e.jsx($e,{})})]}),u?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:"#32174D",size:50})}):e.jsx(st,{onSubmit:_,initialValues:{collaborators:r,newCollaborators:[],modifiedCollaborators:[],deletedCollaborators:[]},children:({values:E,setFieldValue:w})=>e.jsxs(at,{className:"w-full h-full",children:[e.jsx(Y,{values:E}),p?e.jsx(rn,{users:h,values:E,setFieldValue:w,setSearch:f,setCurrentOrNew:x}):e.jsxs("div",{id:"currentCollaborators",className:"flex flex-col w-full h-full",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx(Q,{name:"name",label:"Search Collaborator",value:N,onChange:v=>j(v.target.value)}),e.jsx(Da,{onClick:()=>x(!0),className:"w-7 h-7 mr-5 mt-5 hover:text-blue-500 transition-colors duration-200 cursor-pointer",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})]}),E.collaborators.length===0?e.jsxs("div",{className:"flex flex-col flex-grow space-y-3 items-center justify-center h-[360px] ",children:[e.jsx(ga,{className:"w-12 h-12 text-blue-500"}),e.jsx("span",{className:"text-sm",children:"This project has no added collaborators yet."})]}):e.jsx(va,{name:"collaborators",children:({form:v})=>{const P=v.values.collaborators.filter(M=>M.name.toLowerCase().includes(N.toLowerCase()));return e.jsx("div",{className:"flex-grow space-y-4 px-4 py-4 overflow-y-auto h-[380px] max-h-[380px] mt-4",children:P.map((M,B)=>e.jsxs(Ke,{className:`flex justify-between ${B===P.length-1?"":"border-b-[1px] border-gray-400"}`,children:[e.jsx(Ve,{children:e.jsx(Te,{alt:M.name,src:M.photoUrl||M.name})}),e.jsx(tt,{primary:M.name,secondary:`ID: ${M.id}`}),M.accessLevel==="major"?e.jsx("div",{className:"flex flex-col items-center mr-9",children:e.jsx("span",{className:"text-[14px] font-bold text-red-500",children:xt(M.accessLevel)})}):M.new?e.jsxs("div",{className:"flex flex-col items-center mr-9",children:[e.jsx("span",{className:"text-[11px] text-green-700",children:"Added as"}),e.jsx("span",{className:"text-[11px] font-bold text-green-800",children:M.accessLevel})]}):e.jsxs(Ie,{size:"small",sx:{width:"130px"},name:`collaborators[${B}].accessLevel`,value:M.accessLevel,onChange:W=>$(W,M,B,v,r),children:[e.jsx(J,{value:"contributor",children:"Contributor"}),e.jsx(J,{value:"coordinator",children:"Coordinator"}),e.jsx(J,{value:"administrator",children:"Administrator"}),g&&g.owner===d&&e.jsx(J,{disabled:!0,value:"Major",children:"Major"})]}),e.jsx(La,{onClick:()=>{F(M),L(!0)},className:"w-5 h-5 ml-4 text-red-500 hover:text-red-700 transition-colors duration-300 cursor-pointer",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})]},B))})}}),e.jsxs(Fe,{open:T,onClose:()=>L(!1),children:[e.jsx(Me,{children:"Confirm the deletion of the user as a collaborator"}),e.jsx(Re,{children:e.jsx(Ze,{id:"alert-dialog-description",children:"Are you sure you want to remove this user as a collaborator from the Project? Executing this action means that the user will not be able to access to any layer or repository if it is not public."})}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:()=>{L(!1),F({id:"",name:"",accessLevel:""})},children:"Cancel"}),e.jsx(xe,{onClick:()=>{const v=E.collaborators.filter(P=>P.id!==I.id);w("collaborators",v),w("deletedCollaborators",[...E.deletedCollaborators,I.id]),F({id:"",name:"",accessLevel:""}),L(!1)},children:"Ok"})]})]}),e.jsx("div",{className:"flex flex-grow mx-4 items-center border-t-[1px] border-gray-400  justify-center",children:e.jsx("button",{type:"submit",disabled:b,className:`w-[95%] h-[55px] rounded-extra ${b?"backdrop-blur-sm":"backdrop-blur-sm bg-green-400/20 shadow-sm"} border-[1px] border-gray-400 transition-colors duration-300 ease-in-out transform active:translate-y-[2px]`,children:"Update Project Collaborators"})})]})]})})]})})})},vt=(a,s,l,o)=>s&&l&&o?a===(s==null?void 0:s.owner)||(s==null?void 0:s.accessLevel)==="administrator"||(l==null?void 0:l.accessLevel)==="administrator"||(o==null?void 0:o.accessLevel)==="administrator":s&&l?a===(s==null?void 0:s.owner)||(s==null?void 0:s.accessLevel)==="administrator"||(l==null?void 0:l.accessLevel)==="administrator":a===(s==null?void 0:s.owner)||(s==null?void 0:s.accessLevel)==="administrator",ms=(a,s,l,o)=>s&&l&&o?a===s.owner||(s==null?void 0:s.accessLevel)==="coordinator"||(l==null?void 0:l.accessLevel)==="coordinator"||(o==null?void 0:o.accessLevel)==="coordinator":s&&l?a===s.owner||(s==null?void 0:s.accessLevel)==="coordinator"||(l==null?void 0:l.accessLevel)==="coordinator":a===(s==null?void 0:s.owner)||(s==null?void 0:s.accessLevel)==="coordinator"||(s==null?void 0:s.accessLevel)==="coordinator",ln="http://localhost:3000/api",nn=()=>{const a=Ee(),s=gt(),l=ye(),{ID:o,name:c}=l.state.project,{uid:i}=te(P=>P.auth),{projects:d}=te(P=>P.projects),{layer:g,repository:h}=l.state||{},[f,r]=t.useState(null),[S,T]=t.useState(!1),[L,C]=t.useState(""),[y,N]=t.useState(null),[j,p]=t.useState(!0),[x,b]=t.useState(!0),[n,m]=t.useState(!1),[k,u]=t.useState(!1),[D,I]=t.useState(!1),[F,R]=t.useState(!1),[Y,A]=t.useState(!1),_=l.pathname.split("/").pop(),$=l.state,E=P=>typeof P!="string"||P.length===0?"":P.charAt(0).toUpperCase()+P.slice(1),w=()=>{switch(L){case"hash":case"commits":case"repository":case"layer":case"Tree":case"Activity":case"Comments":case"Configurations":return e.jsx(rt,{});case"Info":return e.jsx(ta,{project:y,projectID:o,firstTime:x});default:return e.jsx(ta,{project:y,projectID:o,firstTime:x})}},v=P=>{switch(P){case"Info":x&&b(!1),C("Info"),a(".",{state:{project:{ID:y==null?void 0:y.pid,name:c}}});break;case"Tree":x&&b(!1),C("Tree"),a("tree",{state:{project:{ID:y==null?void 0:y.pid,name:c}}});break;case"Activity":x&&b(!1),C("Activity"),a("activity",{state:{project:{ID:y==null?void 0:y.pid,name:c}}});break;case"Comments":x&&b(!1),C("Comments"),a("comments",{state:{project:{ID:y==null?void 0:y.pid,name:c}}});break;default:C("Info"),a(".",{state:{project:{ID:y==null?void 0:y.pid,name:c}}});break}};return t.useEffect(()=>{$!=null&&$.commitHash?C("hash"):$!=null&&$.commits?C("commits"):$!=null&&$.repository?C("repository"):$!=null&&$.layer?C("layer"):_==="comments"?C("Comments"):_==="activity"?C("Activity"):_==="tree"&&C("Tree")},[$,_]),t.useEffect(()=>{const P=new Image;P.src=ft,P.onload=()=>{I(!0)}},[]),t.useEffect(()=>{_==="activity"||_==="comments"||_==="tree"||g!=null&&g.layerID?m(!0):m(!1)},[l,_,g==null?void 0:g.layerID]),t.useEffect(()=>{if(o){const P=d.find(M=>M.pid===o);P&&P!==void 0?(s(sa(P)),N(P),p(!1)):U.get(`${ln}/projects/get-project-by-id/${o}`,{params:{uid:i},headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}).then(M=>{const{project:B,accessLevel:W}=M.data;s(sa({...B,accessLevel:W||null})),N({...B,accessLevel:W||null}),p(!1)}).catch(M=>{T(!0),r(M.response.data.message),p(!1)})}},[o,d,i,s]),S?e.jsx("div",{className:"flex w-full h-full items-center justify-center",children:e.jsx("h1",{className:"text-red-500",children:f})}):j?e.jsx("div",{className:"flex w-full h-full items-center justify-center",children:e.jsx(Ce,{color:"#32174D",size:50})}):e.jsx("div",{className:"flex w-full h-full max-h-full overflow-hidden items-center",children:e.jsxs("div",{id:"projectPanel",className:"flex flex-col h-full w-full overflow-hidden",style:{backgroundImage:D?`url(${ft})`:"none",backgroundSize:"cover",backgroundPosition:"center"},children:[e.jsx(en,{uid:i,project:y,showOptModal:k,setIsProjectConfigFormOpen:R,setIsProjectCollaboratorsFormOpen:A}),F&&e.jsx(sn,{isProjectConfigFormOpen:F,setIsProjectConfigFormOpen:R,showOptModal:k,setShowOptModal:u}),Y&&e.jsx(on,{isProjectCollaboratorsFormOpen:Y,setIsProjectCollaboratorsFormOpen:A,showOptModal:k,setShowOptModal:u}),e.jsxs("div",{className:`flex ${n?"justify-between":"justify-end"} items-center py-4 px-5`,children:[n&&e.jsxs("h1",{className:`${n?"text-lg font-bold":"text-3xl font-bold"} h-[30px]`,children:[y==null?void 0:y.name,"   ",!g||h?e.jsx("span",{className:"ml-2",children:"▸"}):""," ",e.jsx("span",{className:"ml-1 font-semibold",children:h?`${E(h==null?void 0:h.repoName)}`:!g&&`${E(_)}`})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>v("Info"),className:`${L==="Info"?"glassi-hover":"glassi"} hover:glassi-hover text-black border-1 border-gray-400 py-1 px-4 rounded transition-all duration-150 ease-in-out transform active:translate-y-[2px]`,children:"Info"}),e.jsx("button",{onClick:()=>v("Tree"),className:`${L==="Tree"?"glassi-hover":"glassi"} hover:glassi-hover text-black border-1 border-gray-400 py-1 px-4 rounded transition-all duration-150 ease-in-out transform active:translate-y-[2px]`,children:"Tree"}),e.jsx("button",{onClick:()=>v("Activity"),className:`${L==="Activity"?"glassi-hover":"glassi"} hover:glassi-hover text-black border-1 border-gray-400 py-1 px-4 rounded transition-all duration-150 ease-in-out transform active:translate-y-[2px]`,children:"Activity"}),e.jsx("button",{onClick:()=>v("Comments"),className:`${L==="Comments"?"glassi-hover":"glassi"} hover:glassi-hover text-black border-1 border-gray-400 py-1 px-4 rounded transition-all duration-150 ease-in-out transform active:translate-y-[2px]`,children:"Comments"}),vt(i,y)&&e.jsx("button",{onClick:()=>u(!k),className:"glassi hover:glassi-hover text-black border-1 border-gray-400 py-1 px-4 rounded transition-all duration-150 ease-in-out transform active:translate-y-[2px]",children:e.jsx(Se,{children:e.jsx(Rr,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})})]})]}),w()]})})},ps="http://localhost:3000/api",Ka=(a,s,l)=>{const o=`${ps}/repos/get-repos/${a}`,c=`${ps}/layer/get-layers/${a}`;return async i=>{var d,g;i(Wt(!0));try{const[h,f]=await Promise.all([U.get(o,{params:{uid:s,accessLevel:l},headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}),U.get(c,{params:{uid:s,accessLevel:l},headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}})]);i(Za(h.data.repos)),i(Vl(f.data.layers)),i(Wt(!1))}catch(h){const f=h;f.response?i(hs({fetchingResources:!1,errorWhileFetching:!0,errorMessage:((d=f.response)==null?void 0:d.data.message)||"An error occurred while fetching data",errorType:((g=f.response)==null?void 0:g.data.type)||"Error"})):i(hs({fetchingResources:!1,errorWhileFetching:!0,errorMessage:"An error occurred while fetching data",errorType:"Error"}))}}},cn=(a,s,l)=>async o=>{o(Wt(!0)),U.get(`${ps}/repos/get-layer-repos/${a}/${s}`,{params:{uid:l},headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}).then(c=>{o(Za(c.data.repos)),o(Wt(!1))}).catch(c=>{console.log(c)})};function Ls(){return gt()}const dn=({layer:a,project:s,uid:l})=>{const o=Ee(),c=Ls(),i=ye(),{ID:d,name:g}=i.state.project,{repositories:h,fetchingResources:f}=te(p=>p.platypus),[r,S]=t.useState(""),[T,L]=t.useState("all"),[C,y]=t.useState([]),N=C.filter(p=>p.name.toLowerCase().includes(r.toLowerCase())&&(T==="all"||p.visibility===T)),j=p=>p.replace(/\./g,"").replace(/\s+/g,"-");return t.useEffect(()=>{const p=h.filter(x=>x.layerID===a._id);y(p)},[h,a]),t.useEffect(()=>{h.some(p=>p.layerID===a._id)||c(cn(s==null?void 0:s.pid,a._id,l))},[c,a,s,l,h]),f?e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:e.jsx(Ce,{color:"#32174D",size:50})}):e.jsx("div",{className:"flex w-full h-full overflow-hidden",children:C.length===0?e.jsx("div",{className:"flex flex-col items-center mt-7 border-t-[1px]  border-gray-400  w-full h-full",children:e.jsx("h1",{className:"text-xl mt-[22%] text-gray-400",children:"There are no repositories yet, start creating one!"})}):e.jsxs("div",{className:"flex flex-col w-full h-full",children:[e.jsx("div",{className:"flex pl-7 pb-4 justify-between items-center mt-4",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(Q,{label:"Search by name...",variant:"outlined",size:"small",value:r,onChange:p=>S(p.target.value)}),e.jsxs(Ie,{value:T,onChange:p=>L(p.target.value),variant:"outlined",size:"small",children:[e.jsx(J,{value:"all",children:"All"}),e.jsx(J,{value:"open",children:"Open"}),e.jsx(J,{value:"internal",children:"Internal"}),e.jsx(J,{value:"restricted",children:"Restricted"})]})]})}),e.jsx("div",{id:"repos-scroll-container",className:"flex-col h-full rounded-b-3xl overflow-y-auto p-4",children:N.map(p=>e.jsxs("div",{className:"relative rounded-lg w-full mb-4 p-2 h-auto border-b-2 border-x-2 border-gray-200 bg-white flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:p.name}),e.jsx(wt,{color:"#80ed99",className:"text-3xl"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:p.description}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500",children:[e.jsxs("span",{children:["Visibility: ",p.visibility]}),e.jsxs("button",{rel:"noopener noreferrer",className:"absolute bottom-3 right-2 inline-flex items-center px-4 py-2 glasspecial border-1 border-gray-400 hover:bg-blue-200 text-black font-bold rounded-lg text-sm transition-colors duration-150 ease-in-out",onClick:()=>{o(`${j(p.name)}`,{state:{project:{ID:d,name:g},layer:{layerID:a._id,layerName:a.name},repository:{repoID:p._id,repoName:p.name}}})},children:["Open repository ",e.jsx(xr,{className:"ml-2"})]})]}),e.jsx("div",{className:"text-sm text-gray-500",children:e.jsxs("span",{children:["Last Update: ",new Date(p.updatedAt).toLocaleDateString()]})})]},p._id))})]})})},xn="http://localhost:3000/api",un=ut().shape({name:Ne().required("Repository name is required"),description:Ne().required("Description is required"),visibility:Ne().required("Visibility is required"),collaborators:Na(),uid:Ne().required("User ID is required")}),hn=({setIsRepositoryFormOpen:a,isRepositoryFormOpen:s})=>{const l=ye(),{uid:o}=te($=>$.auth),[c,i]=t.useState(!1),{layerID:d}=l.state.layer,{ID:g}=l.state.project,[h,f]=t.useState(""),[r,S]=t.useState(""),[T,L]=t.useState(""),[C,y]=t.useState(!1),[N,j]=t.useState(!1),[p,x]=t.useState(!1),[b,n]=t.useState(null),[m,k]=t.useState({id:"",name:"",accessLevel:""}),u=[{id:"1",name:"Juan Perez",accessLevel:"",photoUrl:""},{id:"2",name:"Maria Lopez",accessLevel:"",photoUrl:""},{id:"3",name:"Maria Lopez3",accessLevel:"",photoUrl:""},{id:"489",name:"Maria",accessLevel:"",photoUrl:""},{id:"5",name:"Maria Lopez5",accessLevel:"",photoUrl:""},{id:"6",name:"Maria Lopez6",accessLevel:"",photoUrl:""},{id:"7",name:"Maria Lopez7",accessLevel:"",photoUrl:""}],D=$=>e.jsxs(t.Fragment,{children:[e.jsxs("div",{children:["ID: ",$.id]}),e.jsxs("div",{className:"flex",children:["Access Level:",e.jsx("h5",{className:"text-green-500 ml-1",children:$.accessLevel.charAt(0).toUpperCase()+$.accessLevel.slice(1)})]})]}),I=($,E)=>{S($),f(E)},F=()=>{f("")},R=($,E)=>{const w={...m,accessLevel:T},v=$.collaborators.filter(M=>M.id!==w.id),P=[w,...v];E("collaborators",P),y(!1),L("")},Y=()=>{const $=document.getElementById("layerRepositoryModal");$&&($.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{a(!1)},500))},A=({values:$})=>(t.useEffect(()=>{const E=$.collaborators.length===0&&$.name===""&&$.visibility==="";j(E)},[$]),null),_=async($,{setSubmitting:E,resetForm:w})=>{var v;i(!0),E(!0);try{const P=await U.post(`${xn}/repos/create-repository/${g}/${d}`,$,{params:{uid:o},headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}});w(),E(!1),i(!1),Y(),X.fire({icon:"success",title:"Success",text:P.data.message})}catch(P){const M=P;E(!1),i(!1),M.response?((v=M==null?void 0:M.response.data)==null?void 0:v.type)==="repos-limit"?X.fire({icon:"info",title:`Layer repositories limit reached
 ( 3 repositories )`,text:M.response.data.message}):X.fire({icon:"error",title:"Oops...",text:M.response.data.message}):X.fire({icon:"error",title:"Error",text:"An unexpected error occurred"})}};return t.useEffect(()=>{const $=new Image;$.src=Ae,$.onload=()=>{x(!0)}},[]),t.useEffect(()=>{if(s){const $=setTimeout(()=>{var E,w;(E=document.getElementById("layerRepositoryModal"))==null||E.classList.remove("opacity-0"),(w=document.getElementById("layerRepositoryModal"))==null||w.classList.add("opacity-100")},20);return()=>clearTimeout($)}},[s]),e.jsx("div",{className:"fixed flex w-screen h-full pb-5 top-0 right-0 justify-center items-center bg-black/30 z-10",children:e.jsxs("div",{id:"layerRepositoryModal",style:{backgroundImage:p?`url(${Ae})`:"none",backgroundPosition:"right center"},className:`flex flex-col md:h-[450px] md:w-[700px] glass2 border-[1px] border-gray-400 rounded-2xl transition-opacity duration-300 ease-in-out opacity-0 ${s?"":"pointer-events-none"}`,children:[e.jsxs("div",{className:"flex justify-between w-[95%] h-12 ml-auto mr-auto mt-2 p-2 border-b-2 border-b-gray-500",children:[e.jsx("p",{className:"text-xl text-black",children:"New Layer Repository"}),e.jsx("button",{onClick:Y,children:e.jsx($e,{})})]}),c||!p?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:p?"#32174D":"#ffffff",size:50})}):e.jsx(st,{initialValues:{name:"",description:"",visibility:"",collaborators:[],uid:o},validationSchema:un,onSubmit:_,children:({isSubmitting:$,values:E,setFieldValue:w,handleChange:v,handleBlur:P,errors:M,touched:B})=>e.jsxs(at,{className:"flex flex-col h-full ml-auto mr-auto w-[95%] mt-5",children:[e.jsx(A,{values:E}),e.jsxs("div",{className:"flex space-x-4 w-full",children:[e.jsx(Q,{InputLabelProps:{shrink:!!(M.name&&B.name)},name:"name",label:M.name&&B.name?M.name:"Repository Name",fullWidth:!0,value:E.name,onChange:v,onBlur:P,error:!!M.name&&B.name}),e.jsxs(ht,{fullWidth:!0,error:!!M.visibility&&B.visibility,children:[e.jsx(mt,{id:"visibility-label",children:M.visibility&&B.visibility?M.visibility:"Visibility"}),e.jsxs(Ie,{labelId:"visibility-label",id:"visibility",name:"visibility",value:E.visibility,onChange:W=>w("visibility",W.target.value),onBlur:P,label:M.visibility&&B.visibility?M.visibility:"Visibility",children:[e.jsx(J,{value:"open",children:"Open"}),e.jsx(J,{value:"internal",children:"Internal"}),e.jsx(J,{value:"restricted",children:"Restricted"})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-6 w-full mt-6",children:[e.jsx(Xe,{className:"max-h-[57px]",multiple:!0,value:E.collaborators,options:u,isOptionEqualToValue:(W,q)=>W.id===q.id,getOptionLabel:W=>W.name,filterOptions:(W,{inputValue:q})=>W.filter(G=>G.name.toLowerCase().includes(q.toLowerCase())||G.id.toString().includes(q)),renderTags:(W,q)=>e.jsx("div",{className:" overflow-y-auto  max-h-[41px] w-[90%] ",children:E.collaborators.map((G,oe)=>e.jsx(he,{title:b&&b.id===G.id?D(G):"",onMouseEnter:()=>n(G),onMouseLeave:()=>n(null),children:e.jsx(ot,{variant:"outlined",label:G.name,...q({index:oe}),onDelete:()=>{const ge=E.collaborators.filter(ae=>ae.id!==G.id);w("collaborators",ge)},sx:{cursor:"pointer"}})}))}),renderOption:(W,q)=>e.jsx("li",{...W,onClick:()=>{k(q),y(!0)},className:"flex p-4 pl-4 hover:bg-gray-200 transition-colors duration-300 ease-in-out cursor-pointer justify-between",children:e.jsxs("div",{className:"flex",children:[e.jsx(Ve,{children:e.jsx(Te,{alt:q.name,src:q.photoUrl||q.name})}),e.jsxs("div",{className:"flex flex-col ml-4",children:[e.jsx(ce,{variant:"body1",children:q.name}),e.jsx("span",{className:"text-[11px]",children:q.id})]})]})}),renderInput:W=>e.jsx(Q,{className:"",...W,variant:"outlined",label:"Add Collaborators",placeholder:"Add"})}),e.jsxs(Fe,{open:C,onClose:()=>y(!1),children:[e.jsx(Me,{children:"Set Access Level"}),e.jsx(Re,{children:e.jsxs(Ie,{value:T,onChange:W=>L(W.target.value),fullWidth:!0,children:[e.jsx(J,{value:"contributor",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Contributor"}),e.jsx(he,{title:r,open:h==="contributor",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>I("The Contributor can view open repositories on the layer and contribute new content or comments.","contributor"),onMouseLeave:F,children:e.jsx(Be,{})})})]})}),e.jsx(J,{value:"coordinator",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Coordinator"}),e.jsx(he,{title:r,open:h==="coordinator",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>I("The Coordinator can manage contributions, approve changes and coordinate activities within the layer. This role allows adding new collaborators with the role of contributors and access to open and internal repositories with editor access level in the layer.","coordinator"),onMouseLeave:F,children:e.jsx(Be,{})})})]})}),e.jsx(J,{value:"administrator",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Administrator"}),e.jsx(he,{title:r,open:h==="administrator",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>I("The Administrator has full control over the layer and its repositories with administrator level access to them, including the ability to modify settings, manage all aspects and collaborators.","administrator"),onMouseLeave:F,children:e.jsx(Be,{})})})]})})]})}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:()=>{y(!1),k({id:"",name:"",accessLevel:""})},children:"Cancel"}),e.jsx(xe,{disabled:!T,onClick:()=>R(E,w),children:"Add"})]})]}),e.jsx(Q,{InputLabelProps:{shrink:!!(M.description&&B.description)},name:"description",label:M.description&&B.description?M.description:"Description",multiline:!0,rows:4,fullWidth:!0,value:E.description,onChange:v,onBlur:P,error:!!M.description&&B.description})]}),e.jsx("div",{className:"flex w-full h-full justify-center items-center",children:e.jsx("button",{className:`w-[95%] h-[55px] rounded-extra p-2 ${N?"backdrop-blur-sm":"backdrop-blur-sm bg-green-400/20 shadow-sm"} border-[1px] border-gray-400 transition-colors duration-300 ease-in-out transform active:translate-y-[2px]`,type:"submit",disabled:$||N,children:"Create Repository"})})]})})]})})},mn="http://localhost:3000/api",pn=ut().shape({name:Ne().required("Group name is required"),description:Ne(),visibility:Ne().required("Visibility is required")}),fn=({layer:a,setIsLayerConfigFormOpen:s,isLayerConfigFormOpen:l})=>{const o=ye(),{uid:c}=te(u=>u.auth),{ID:i}=o.state.project,{layerID:d}=o.state.layer,[g,h]=t.useState(!1),[f,r]=t.useState(!1),[S,T]=t.useState(""),[L,C]=t.useState(!1),[y,N]=t.useState(!1),j=()=>{switch(S){case"open":return e.jsx(Ze,{children:'Are you sure you want to change the visibility type? The "Open" type will allow all project collaborators to access the layer, if the project is open, it will allow all users in prjmanager to access it as well.'});case"internal":return e.jsx(Ze,{children:'Are you sure you want to change the visibility type? The "Internal" type will allow access to the layer only to the collaborators of the project.'});case"restricted":return e.jsx(Ze,{children:'Are you sure you want to change the visibility type? The "Restricted" type will allow access to the layer only to the collaborators invited exclusively.'});default:return null}},p=(u,D)=>{const I=u.target.value;I!==(a==null?void 0:a.visibility)?(T(I),r(!0)):D("visibility",I)},x=u=>{u("visibility",S),r(!1)},b=()=>{r(!1)},n=()=>{const u=document.getElementById("layerConfigModal");u&&(u.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{s(!1)},500))},m=({values:u})=>(t.useEffect(()=>{const D=u.name===a.name&&u.description===a.description&&u.visibility===a.visibility;C(D)},[u]),null),k=async(u,{setSubmitting:D,resetForm:I})=>{var F;h(!0),D(!0);try{const R=await U.put(`${mn}/layer/update-layer/${i}/${d}`,u,{params:{uid:c},headers:{Authorization:localStorage.getItem("x-token")}});I(),D(!1),h(!1),n(),X.fire({icon:"success",title:"Success",text:R.data.message})}catch(R){const Y=R;D(!1),h(!1),Y.response?((F=Y==null?void 0:Y.response.data)==null?void 0:F.type)==="collaborator-validation"?X.fire({icon:"error",title:"Error",text:Y.response.data.message||"Access Validation"}):X.fire({icon:"error",title:"Oops...",text:Y.response.data.message||"An unexpected error occurred"}):X.fire({icon:"error",title:"Error",text:"An unexpected error occurred"})}};return t.useEffect(()=>{const u=new Image;u.src=Ae,u.onload=()=>{N(!0)}},[]),t.useEffect(()=>{if(l){const u=setTimeout(()=>{var D,I;(D=document.getElementById("layerConfigModal"))==null||D.classList.remove("opacity-0"),(I=document.getElementById("layerConfigModal"))==null||I.classList.add("opacity-100")},20);return()=>clearTimeout(u)}},[l]),e.jsx("div",{className:"fixed flex w-screen h-full top-0 right-0 justify-center items-center bg-black/30 z-50",children:e.jsxs("div",{id:"layerConfigModal",style:{backgroundImage:y?`url(${Ae})`:"none",backgroundPosition:"bottom center"},className:`flex flex-col space-y-7 w-[70%] glass2 border-[1px] border-gray-400 md:w-[40%] md:h-[450px] max-h-[560px] rounded-2xl pb-4 overflow-y-auto  transition-opacity duration-500 ease-in-out opacity-0 ${l?"":"pointer-events-none"}`,children:[e.jsxs("div",{className:"flex justify-between w-[95%] h-12 ml-auto mr-auto mt-2 p-2 border-b-2 border-b-gray-500",children:[e.jsx("p",{className:"text-xl text-black",children:"Layer Configuration"}),e.jsx("button",{onClick:n,children:e.jsx($e,{})})]}),g||!y?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:y?"#32174D":"#ffffff",size:50})}):e.jsx(st,{initialValues:{name:a.name,description:a.description,visibility:a.visibility},validationSchema:pn,onSubmit:k,children:({isSubmitting:u,values:D,setFieldValue:I,handleChange:F,handleBlur:R})=>e.jsxs(at,{className:"flex flex-col h-full space-y-4 mx-auto w-[95%]",children:[e.jsx(m,{values:D}),e.jsx(Q,{name:"name",label:"Layer Name",fullWidth:!0,value:D.name,onChange:F,onBlur:R}),e.jsxs(ht,{fullWidth:!0,children:[e.jsx(mt,{id:"visibility-label",children:"Visibility"}),e.jsxs(Ie,{labelId:"visibility-label",id:"visibility",name:"visibility",value:D.visibility,onChange:Y=>p(Y,I),onBlur:R,label:"Visibility",children:[e.jsx(J,{value:"open",children:"Open"}),e.jsx(J,{value:"internal",children:"Internal"}),e.jsx(J,{value:"restricted",children:"Restricted"})]})]}),e.jsx(Q,{name:"description",label:"Description",multiline:!0,rows:4,fullWidth:!0,value:D.description,onChange:F,onBlur:R}),e.jsxs(Fe,{open:f,onClose:b,children:[e.jsx(Me,{children:"Confirm Visibility Change"}),e.jsx(Re,{children:j()}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:b,children:"Cancel"}),e.jsx(xe,{onClick:()=>x(I),autoFocus:!0,children:"Confirm"})]})]}),e.jsx("div",{className:"flex w-full h-full space-x-2 justify-center items-center",children:e.jsx("button",{className:`w-[95%] h-[55px] rounded-extra p-2 ${L?"backdrop-blur-sm":"backdrop-blur-sm bg-green-400/20 shadow-sm"} border-[1px] border-gray-400 transition-colors duration-300 ease-in-out transform active:translate-y-[2px]`,type:"submit",disabled:L||u,children:"Update Layer"})})]})})]})})},gn=({values:a,users:s,setSearch:l,setFieldValue:o,setCurrentOrNew:c})=>{const[i,d]=t.useState(""),[g,h]=t.useState(""),[f,r]=t.useState(!1),[S,T]=t.useState(""),[L,C]=t.useState({name:"",id:"",photoUrl:"",new:!0}),y=(n,m,k)=>{const u=n.collaborators.filter(I=>I.id!==k),D=n.newCollaborators.filter(I=>I.id!==k);m("newCollaborators",D),m("collaborators",u)},N=(n,m)=>{const k={...L,accessLevel:S},u=n.newCollaborators.filter(I=>I.id!==k.id),D=[k,...u];m("newCollaborators",D),r(!1),T("")},j=(n,m)=>{const k=new Set(n.newCollaborators.map(I=>I.id));let u=[...n.newCollaborators,...n.collaborators];u=u.filter(I=>k.has(I.id)||n.collaborators.some(F=>F.id===I.id));const D=Array.from(new Map(u.map(I=>[I.id,I])).values());m("collaborators",D),c(!1)},p=n=>{const m=a.collaborators.some(u=>u.id===(n==null?void 0:n.id)),k=a.newCollaborators.some(u=>u.id===(n==null?void 0:n.id));if(m||k){X.fire({icon:"warning",title:"Oops...",text:"This user is already a collaborator or has been added recently!",confirmButtonColor:"#3b82f6"});return}n!==null&&!a.newCollaborators.some(u=>u.id===n.id)&&(C(n),r(!0))},x=(n,m)=>{h(n),d(m)},b=()=>{d("")};return e.jsxs("div",{id:"newCollaborators",className:"flex flex-col w-full h-full",children:[e.jsxs("div",{className:"flex flex-col w-full h-5/6 px-5 space-y-2",children:[e.jsx(Xe,{options:s,getOptionLabel:n=>n.name,renderOption:(n,m)=>{const k=a.collaborators.some(D=>D.id===m.id),u=a.newCollaborators.some(D=>D.id===m.id);return e.jsx("div",{children:t.createElement("li",{...n,key:m.id,className:`flex p-3 pl-4 ${k||u?null:"cursor-pointer"} justify-between
                        ${k||u?null:"hover:bg-gray-200 transition-colors duration-200"}`},e.jsxs("div",{className:"flex",children:[e.jsx(Ve,{children:e.jsx(Te,{alt:m.name,src:m.photoUrl||m.name})}),e.jsxs("div",{className:"flex flex-col ml-1",children:[e.jsx(ce,{variant:"body2",children:m.name}),e.jsx("span",{className:"text-[11px]",children:m.id})]})]}),(k||u)&&e.jsx("div",{className:"flex items-center mr-6",children:e.jsx("span",{className:"text-[11px] text-green-400",children:k&&!u?"Already a collaborator":k&&u?"Added recently":null})}))})},fullWidth:!0,renderInput:n=>e.jsx(Q,{...n,onChange:m=>l(m.target.value),label:"Search User by Name or ID"}),filterOptions:(n,{inputValue:m})=>n.filter(k=>k.name.toLowerCase().includes(m.toLowerCase())||k.id.toString().includes(m)),onChange:(n,m)=>p(m)}),e.jsxs(Fe,{open:f,onClose:()=>r(!1),children:[e.jsx(Me,{children:"Set Access Level"}),e.jsx(Re,{children:e.jsxs(Ie,{value:S,onChange:n=>T(n.target.value),fullWidth:!0,children:[e.jsx(J,{value:"contributor",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Contributor"}),e.jsx(he,{title:g,open:i==="contributor",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>x('The Contributor at the layer level has access to Open / Internal repositories within the layer, participates in the text and voice chats within the layer, in addition to being able to clone the repositories by having a "Reader" access level in the repositories.',"contributor"),onMouseLeave:b,children:e.jsx(Be,{})})})]})}),e.jsx(J,{value:"coordinator",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Coordinator"}),e.jsx(he,{title:g,open:i==="coordinator",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>x('The Coordinator at the layer level has all the capabilities of the contributor, he can also manage contributions, approve changes and tasks and coordinate activities within the layer, the level provide a "Editor" access level in all repositories where he has access within the layer. Finally, the Coordinator can add new collaborators with an access level of "Contributor" or "Reader" in the case of repositories within the layer.',"coordinator"),onMouseLeave:b,children:e.jsx(Be,{})})})]})}),e.jsx(J,{value:"administrator",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Administrator"}),e.jsx(he,{title:g,open:i==="administrator",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>x('The Administrator at the layer level has all the capabilities of the coordinator, the level provides access to restricted repositories within the layer, with an "Administrator" access level on all repositories, finally, he can manage the access level of other collaborators below of "Administrator" access level.',"administrator"),onMouseLeave:b,children:e.jsx(Be,{})})})]})})]})}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:()=>{r(!1),C({name:"",id:"",photoUrl:"",new:!0})},children:"Cancel"}),e.jsx(xe,{onClick:()=>N(a,o),disabled:!S,children:"Add"})]})]}),e.jsx("div",{id:"newCollabsList",className:"flex-grow overflow-y-auto px-3 max-h-[380px]",children:a.newCollaborators.length===0?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("span",{className:"text-sm",children:"There are no new collaborators currently"})}):e.jsx(pt,{children:a.newCollaborators.map((n,m)=>e.jsxs(Ke,{className:"border-b-[1px] border-gray-400",secondaryAction:e.jsx("button",{className:"mr-3",onClick:()=>y(a,o,n.id),children:e.jsx($e,{size:18,color:"#ef233c"})}),children:[e.jsx(Ve,{children:e.jsx(Te,{alt:n.name,src:n.photoUrl||n.name})}),e.jsx(tt,{primary:n.name,secondary:e.jsxs(e.Fragment,{children:[e.jsxs(ce,{component:"span",variant:"body2",color:"textPrimary",children:["Access Level: ",n.accessLevel]}),e.jsxs(ce,{component:"div",variant:"body2",color:"textSecondary",children:["ID: ",n.id]})]})})]},m))})})]}),e.jsx("div",{className:"flex flex-grow justify-center mx-4  items-center py-4  border-t-[1px] border-gray-400 ",children:e.jsx("button",{type:"button",className:"h-[55px] w-[95%] border-1 border-gray-400  rounded-extra glassi transition-transform duration-150 ease-in-out transform active:translate-y-[2px]",onClick:()=>j(a,o),children:"Update new Collaborators"})})]})},ra="http://localhost:3000/api",jn=({setIsLayerCollaboratorsFormOpen:a,isLayerCollaboratorsFormOpen:s})=>{const l=ye(),{uid:o}=te(_=>_.auth),{users:c,setSearch:i}=Qt(),{layerID:d}=l.state.layer,{ID:g}=l.state.project,[h,f]=t.useState(!1),[r,S]=t.useState([]),[T,L]=t.useState(!1),[C,y]=t.useState(!1),[N,j]=t.useState(!1),[p,x]=t.useState(!1),[b,n]=t.useState(!1),[m,k]=t.useState(""),[u,D]=t.useState({name:"",accessLevel:"",id:""}),I=()=>{const _=document.getElementById("layerCollaboratorModal");_&&(_.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{a(!1)},500))},F=({values:_})=>(t.useEffect(()=>{const $=_.newCollaborators.length===0&&_.modifiedCollaborators.length===0&&_.deletedCollaborators.length===0;n($)},[_]),null),R=_=>{const $=_.map(E=>({name:E.name,photoUrl:E.photoUrl,id:E.uid,accessLevel:E.layer.accessLevel}));S($),j(!1)},Y=(_,$,E,w,v)=>{const P=_.target.value;if(P===$.accessLevel)return;const M=w.values.collaborators.map((q,G)=>G===E?{...q,accessLevel:P}:q);w.setFieldValue("collaborators",M);const B=v.find(q=>q.id===$.id);if(P===(B==null?void 0:B.accessLevel)){const q=w.values.modifiedCollaborators.filter(G=>G.id!==$.id);w.setFieldValue("modifiedCollaborators",q)}const W=w.values.modifiedCollaborators.findIndex(q=>q.id===$.id);W>-1?w.values.modifiedCollaborators[W].accessLevel=P:w.setFieldValue("modifiedCollaborators",[...w.values.modifiedCollaborators,{...$,accessLevel:P}])},A=async(_,{setSubmitting:$,resetForm:E})=>{var w;L(!0),$(!0);try{const v=await U.put(`${ra}/layer/collaborators/${g}/${d}`,_,{params:{uid:o},headers:{Authorization:localStorage.getItem("x-token")}});E(),$(!1),L(!1),I(),X.fire({icon:"success",title:"Success",text:v.data.message})}catch(v){const P=v;$(!1),L(!1),P.response?((w=P==null?void 0:P.response.data)==null?void 0:w.type)==="collaborator-validation"?X.fire({icon:"error",title:"Error",text:P.response.data.message}):X.fire({icon:"error",title:"Oops...",text:P.response.data.message}):X.fire({icon:"error",title:"Error",text:"An unexpected error occurred"})}};return t.useEffect(()=>{const _=new Image;_.src=Ae,_.onload=()=>{y(!0)}},[]),t.useEffect(()=>{if(s){const _=setTimeout(()=>{var $,E;($=document.getElementById("layerCollaboratorModal"))==null||$.classList.remove("opacity-0"),(E=document.getElementById("layerCollaboratorModal"))==null||E.classList.add("opacity-100")},20);return()=>clearTimeout(_)}},[s]),t.useEffect(()=>{j(!0),U.get(`${ra}/layer/get-layer-collaborators/${d}`,{headers:{Authorization:localStorage.getItem("x-token")}}).then(_=>{const{collaborators:$}=_.data;R($)}).catch(_=>{console.error("Error fetching layer collaborators:",_)})},[d]),e.jsx("div",{className:"fixed flex w-screen h-full top-0 right-0 justify-center items-center bg-black/30 z-50",children:e.jsx("div",{id:"layerCollaboratorModal",className:`flex flex-col space-y-5 w-[70%] glass2 border-[1px] border-gray-400 md:w-[50%] md:h-[620px]  rounded-2xl transition-opacity duration-300 ease-in-out opacity-0 ${s?"":"pointer-events-none"}`,style:{backgroundImage:C?`url(${Ae})`:"none",backgroundPosition:"bottom right"},children:T||!C?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:C?"#32174D":"#ffffff",size:50})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between w-[95%] h-12 ml-auto mr-auto mt-2 p-2 border-b-2 border-b-gray-500",children:[e.jsx("p",{className:"text-xl text-black",children:"Layer Collaborators"}),e.jsx("button",{onClick:I,children:e.jsx($e,{})})]}),N?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:"#32174D",size:50})}):e.jsx(st,{onSubmit:A,initialValues:{collaborators:r,newCollaborators:[],modifiedCollaborators:[],deletedCollaborators:[]},children:({values:_,setFieldValue:$})=>e.jsxs(at,{className:"w-full h-full",children:[e.jsx(F,{values:_}),p?e.jsx(gn,{values:_,users:c,setSearch:i,setFieldValue:$,setCurrentOrNew:x}):e.jsxs("div",{id:"currentCollaborators",className:"flex flex-col w-full h-full",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx(Q,{name:"name",label:"Search Collaborator",value:m,onChange:E=>k(E.target.value)}),e.jsx(Da,{onClick:()=>x(!0),className:"w-7 h-7 mr-5 mt-5 hover:text-blue-500 transition-colors duration-200 cursor-pointer",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})]}),_.collaborators.length===0?e.jsxs("div",{className:"flex flex-col flex-grow space-y-3 items-center justify-center h-[360px] ",children:[e.jsx(ga,{className:"w-12 h-12 text-blue-500"}),e.jsx("span",{className:"text-sm",children:"This Layer has no added collaborators yet."})]}):e.jsx(va,{name:"collaborators",children:({form:E})=>{const w=E.values.collaborators.filter(v=>v.name.toLowerCase().includes(m.toLowerCase()));return e.jsx("div",{className:"flex-grow space-y-4 px-4 py-4 overflow-y-auto h-[380px] max-h-[380px] mt-4",children:w.map((v,P)=>e.jsxs(Ke,{className:`flex justify-between  ${P===w.length-1?"":"border-b-[1px] border-gray-400"} `,children:[e.jsx(Ve,{children:e.jsx(Te,{alt:v.name,src:v.photoUrl||v.name})}),e.jsx(tt,{primary:v.name,secondary:`ID: ${v.id}`}),v.new?e.jsxs("div",{className:"flex flex-col items-center mr-9",children:[e.jsx("span",{className:"text-[11px] text-green-500",children:"Added as"}),e.jsx("span",{className:"text-[11px] font-bold text-green-500",children:v.accessLevel})]}):e.jsxs(Ie,{size:"small",name:`collaborators[${P}].accessLevel`,value:v.accessLevel,onChange:M=>Y(M,v,P,E,r),children:[e.jsx(J,{value:"contributor",children:"Contributor"}),e.jsx(J,{value:"coordinator",children:"Coordinator"}),e.jsx(J,{value:"administrator",children:"Administrator"})]}),!v.new&&e.jsx(La,{onClick:()=>{D(v),f(!0)},className:"w-5 h-5 ml-4 text-red-300 hover:text-red-500 transition-colors duration-300 cursor-pointer",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})]},P))})}}),e.jsxs(Fe,{open:h,onClose:()=>f(!1),children:[e.jsx(Me,{children:"Confirm the deletion of the user as a collaborator"}),e.jsx(Re,{children:e.jsx(Ze,{id:"alert-dialog-description",children:"Are you sure you want to remove this user as a collaborator from the layer? Executing this action means that the user will not be able to access the layer if it is not open, nor will they be able to access the repositories in which they were a collaborator."})}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:()=>{f(!1),D({id:"",name:"",accessLevel:""})},children:"Cancel"}),e.jsx(xe,{onClick:()=>{const E=_.collaborators.filter(w=>w.id!==u.id);$("collaborators",E),$("deletedCollaborators",[..._.deletedCollaborators,u.id]),D({id:"",name:"",accessLevel:""}),f(!1)},children:"Ok"})]})]}),e.jsx("div",{className:"flex flex-grow mx-4 items-center border-t-[1px] border-gray-400  justify-center",children:e.jsx("button",{type:"submit",disabled:b,className:`w-[95%] h-[55px] rounded-extra ${b?"backdrop-blur-sm":"backdrop-blur-sm bg-green-400/20 shadow-sm"} border-[1px] border-gray-400 transition-colors duration-300 ease-in-out transform active:translate-y-[2px]`,children:"Update layer collaborators"})})]})]})})]})})})},bn="http://localhost:3000/api",yn=()=>{var Y;const a=ye(),[s,l]=t.useState(null),[o,c]=t.useState(!0),{layerID:i,layerName:d}=a.state.layer,{uid:g}=te(A=>A.auth),{currentProject:h,layers:f}=te(A=>A.platypus),r=(Y=a.state)==null?void 0:Y.repository,[S,T]=t.useState(!1),[L,C]=t.useState(!1),[y,N]=t.useState(!1),[j,p]=t.useState(!1),[x,b]=t.useState(!1),[n,m]=t.useState(null),[k,u]=t.useState(null),[D,I]=t.useState(!1),F=()=>{S&&T(!1),C(!L)},R=t.useCallback(()=>{U.get(`${bn}/layer/get-layer/${i}`,{headers:{Authorization:localStorage.getItem("x-token")}}).then(A=>{l(A.data.layer),c(!1)}).catch(A=>{c(!1),I(!0),m(A.response.data.type||"Error"),u(A.response.data.message||"An error occurred while fetching data")})},[i]);return t.useEffect(()=>{j&&C(!1),x&&C(!1)},[j,x]),t.useEffect(()=>{if(i){const A=f.find(_=>_._id===i);A&&A!==void 0?(l(A),c(!1)):R()}},[R,i,f]),r!=null&&r.repoID?e.jsx(rt,{}):D?e.jsxs("div",{className:"flex flex-col flex-grow items-center justify-center",children:[e.jsx("h1",{className:"text-xl text-red-500",children:k}),n!=="collaborator-validation"&&n!=="token-validation"?e.jsx("button",{onClick:()=>{I(!1),c(!0),R()},className:"hover:text-blue-500 transition-colors duration-100",children:"Try Again"}):null]}):e.jsxs("div",{id:"layer",className:"flex flex-col h-full rounded-2xl w-full ",children:[o?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:"#32174D",size:50})}):e.jsxs("div",{className:"flex justify-between items-cente px-1",children:[e.jsx("div",{className:"flex  mx-4 ",children:e.jsxs("h1",{className:"text-3xl flex font-bold items-center",children:[e.jsx("div",{className:"mr-3 ",children:e.jsx(Ht,{size:50,color:"#ffafcc"})}),d]})}),e.jsxs("div",{id:"lBtns",className:"relative flex items-center space-x-3 px-4",children:[vt(g,h,s)&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>N(!y),className:"glassi h-7 border-1 border-gray-400 py-1 px-3 rounded-lg transition-transform duration-150 ease-in-out transform active:translate-y-[2px]",children:e.jsx(ur,{size:17})}),e.jsx("div",{className:`absolute top-[130%] right-[122px] mt-1 w-28 glass2 border-1 border-gray-400 shadow-xl rounded-lg z-10 transition-opacity duration-300 ease-in-out ${S?"opacity-100":"opacity-0 pointer-events-none"} transform -translate-y-5`,children:e.jsxs("ul",{className:"text-gray-700",children:[e.jsx("li",{className:"text-center px-4 py-2 hover:bg-blue-200 transition-colors duration-150 ease-in-out cursor-pointer",children:"None"}),e.jsx("li",{className:"text-center px-4 py-2 hover:bg-blue-200 transition-colors duration-150 ease-in-out cursor-pointer",children:"All"}),e.jsx("li",{className:"text-center px-4 py-2 hover:bg-blue-200 transition-colors duration-150 ease-in-out cursor-pointer",children:"Dedicated"})]})}),e.jsx("button",{onClick:F,className:"glassi h-7 border-1 border-gray-400 py-1 px-3 rounded-lg transition-transform duration-150 ease-in-out transform active:translate-y-[2px]",children:e.jsx(hr,{})}),e.jsx("div",{className:`absolute top-[130%] right-[68px] mt-1 w-48 glass2 border-1 border-gray-400 shadow-xl rounded-lg z-10 transition-opacity duration-300 ease-in-out ${L?"opacity-100":"opacity-0 pointer-events-none"} transform -translate-y-5`,children:e.jsxs("ul",{className:"text-gray-700",children:[e.jsx("li",{className:"text-center px-4 py-2 hover:bg-blue-200 transition-colors duration-150 ease-in-out cursor-pointer",onClick:()=>p(!j),children:"Layer Configuration"}),e.jsx("li",{className:"text-center px-4 py-2 hover:bg-blue-200 transition-colors duration-150 ease-in-out cursor-pointer",onClick:()=>b(!x),children:"Layer Collaborators"})]})})]}),e.jsx(he,{title:(s==null?void 0:s.visibility)==="restricted"?"Restricted":(s==null?void 0:s.visibility)==="internal"?"Internal":"Open",arrow:!0,children:e.jsx("div",{className:`${(s==null?void 0:s.visibility)==="restricted"?"bg-[#00BFFF]/40":(s==null?void 0:s.visibility)==="internal"?"bg-[#FFEF00]/40":"bg-[#ED2939]/40"} flex items-center glassi h-7 border-1 border-gray-400 py-1 px-3 rounded-lg transition-transform duration-150 ease-in-out transform active:translate-y-[2px]`,children:(s==null?void 0:s.visibility)==="restricted"?e.jsx(Ta,{className:"w-4 h-4",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}):(s==null?void 0:s.visibility)==="internal"?e.jsx(ja,{}):e.jsx(ba,{className:"w-4 h-4"})})})]})]}),s!==null&&e.jsx(dn,{layer:s,project:h,uid:g}),y&&e.jsx(hn,{setIsRepositoryFormOpen:N,isRepositoryFormOpen:y}),j&&e.jsx(fn,{layer:s,setIsLayerConfigFormOpen:p,isLayerConfigFormOpen:j}),x&&e.jsx(jn,{setIsLayerCollaboratorsFormOpen:b,isLayerCollaboratorsFormOpen:x})]})},Va=({branch:a,files:s,onFileClick:l,onFolderClick:o,repo:c,setFiles:i,selectedFileName:d,setSelectedFileContent:g,setSelectedFileName:h})=>{const[f,r]=t.useState(0),S=(y,N)=>y.map(j=>j.id===N&&j.type==="tree"?{...j,files:j.files&&j.files.length>0?[]:j.files}:j.type==="tree"&&j.files?{...j,files:S(j.files,N)}:j),T=(y,N,j,p)=>{f===j?(p(x=>S(x,j)),r(0)):(r(j),o(y,N,j,p))},L=y=>{var p;const N=((p=y.split(".").pop())==null?void 0:p.toLowerCase())||"",j={icon:So,color:"#6c757d"};return Nl[N]||j},C=({fileName:y})=>{const{icon:N,color:j}=L(y);return e.jsx(Hs,{icon:N,style:{color:j}})};return e.jsx("ul",{id:"fileTree",className:"overflow-y-auto overflow-x-auto h-full  px-5 pt-2 rounded-bl-extra",children:s.map(y=>e.jsxs(t.Fragment,{children:[e.jsxs("li",{className:`flex items-center space-x-1 cursor-pointer hover:bg-blue-300 ${y.name===d?"bg-blue-300":""} transition-all duration-100 ease-in-out rounded-lg`,onClick:()=>y.type==="tree"?T(c,y.path,y.id,i):l(a,c,y.path,g,h),children:[e.jsx("div",{className:"flex items-center justify-center w-[30px] h-[30px]",children:y.type==="blob"?e.jsx(C,{fileName:y.name}):e.jsx(Hs,{icon:f===y.id?Co:ko})}),e.jsx("span",{className:"text-[12px]",children:y.name})]}),y.type==="tree"&&y.files&&e.jsx("div",{className:"pl-2",children:e.jsx(Va,{branch:a,files:y.files,repo:c,setFiles:i,setSelectedFileContent:g,setSelectedFileName:h,onFileClick:l,onFolderClick:o,selectedFileName:d})})]},y.id))})},er=({getExtension:a,isCodeOnBigScreenOpen:s,setIsCodeOnBigScreenOpen:l,fileName:o,fileContent:c})=>{const i=()=>{const d=document.getElementById("bigScreenModal");d&&(d.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{l(!1)},500))};return t.useEffect(()=>{if(s){const d=setTimeout(()=>{var g,h;(g=document.getElementById("bigScreenModal"))==null||g.classList.remove("opacity-0"),(h=document.getElementById("bigScreenModal"))==null||h.classList.add("opacity-100")},20);return()=>clearTimeout(d)}},[s]),e.jsx("div",{className:"fixed inset-0 flex h-full top-0 right-0 justify-center items-center z-20",children:e.jsxs("div",{id:"bigScreenModal",className:`relative flex flex-col space-y-5 w-full h-full overflow-hidden bg-[#282a36] transition-opacity duration-300 ease-in-out opacity-0 ${s?"":"pointer-events-none"}`,children:[a(o)?e.jsx("div",{className:"markdown-body  border-2 w-full p-10 h-full overflow-y-auto",children:e.jsx(Xt,{children:c})}):e.jsx(nt,{language:Lt(o),style:it,customStyle:{marginTop:"0px",padding:"50px",height:"100%",fontSize:"12px"},children:c}),e.jsx("button",{className:"absolute z-10 right-7 top-3",onClick:i,children:e.jsx(Se,{size:28,color:"white",children:e.jsx(zr,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})})]})})},vn="http://localhost:3000/api",wn=a=>{const[s,l]=t.useState([]),[o,c]=t.useState(!0),[i,d]=t.useState(null),[g,h]=t.useState(!1),f=async S=>{c(!0);const T=await Promise.all(S.map(async L=>{const{contributorsIds:C,...y}=L;return{...y,contributors:C}}));l(T),c(!1)},r=async()=>{try{c(!0);const S=await U.get(`${vn}/tasks/${a}`,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}});f(S.data.tasks)}catch(S){const T=S;T.response?(h(!0),d(T.response.data.message||"An error occurred while fetching data"),c(!1)):(h(!0),d("An unexpected error occurred"),c(!1))}};return t.useEffect(()=>{r()},[]),{isLoading:o,tasks:s,setTasks:l,errorMessage:i,errorWhileFetching:g}},Nn="http://localhost:3000/api",Cn=lo(no)({maxHeight:"200px",overflowY:"auto"}),kn=ut().shape({task_name:Ne().required("Task name is required"),task_description:Ne().required("Task description is required"),goals:Na().min(1,"Provide at least 1 goal for the task"),priority:Ne().oneOf(["Low","Medium","High","Critical"]).required("Priority is required"),type:Ne().oneOf(["open","assigned"]).required("Type is required"),deadline:wa().required("Deadline is required"),additional_info:ut({estimated_hours:wr().min(1,"Estimated hours must be at least 1").required("Estimated hours are required")}),assigned_to:Ne().when("type",(a,s)=>a.includes("assigned")?s.required("Assigned to is required"):s.nullable())}),Sn=({uid:a,setGoalsExpanded:s,goalsExpanded:l})=>{const o=ye(),[c,i]=t.useState(!1),[d,g]=t.useState(!0),[h,f]=t.useState(""),{users:r,setSearch:S}=Qt(),{ID:T}=o.state.project,{layerID:L}=o.state.layer,{repoID:C}=o.state.repository,y=20,N=(m,k,u)=>()=>{k("goals",u.filter((D,I)=>I!==m))},j=(m,k,u)=>{m.key==="Enter"&&h.trim()!==""&&(m.preventDefault(),k("goals",[...u,h]),f(""))},p=({values:m})=>(t.useEffect(()=>{const k=m.goals.length===0&&m.task_name===""&&m.task_description===""&&m.priority===""&&m.type==="";g(k)},[m]),null),x=(m,k)=>{const D=m.replace(/\s+/g,"-");k("task_name",D)},b=(m,k)=>{const D=m.replace(/[^0-9.-]/g,"");k("additional_info.estimated_hours",D?parseFloat(D):0)},n=async(m,{setSubmitting:k})=>{var u;i(!0),k(!0),console.log("valores del formulario",m);try{const D=await U.post(`${Nn}/tasks/${T}/${L}/${C}`,m,{params:{uid:a},headers:{Authorization:localStorage.getItem("x-token")}});k(!1),i(!1),X.fire({icon:"success",title:"Success",text:D.data.message})}catch(D){const I=D;k(!1),i(!1),I.response?((u=I.response.data)==null?void 0:u.type)==="collaborator-validation"?X.fire({icon:"warning",title:"Access Validation",text:I.response.data.message}):X.fire({icon:"error",title:"Oops...",text:I.response.data.message}):X.fire({icon:"error",title:"Oops...",text:"There was an unexpected error."})}};return c?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:"#32174D",size:50})}):e.jsx(st,{initialValues:{project:T,layer_related_id:L,repository_related_id:C,task_name:"",task_description:"",goals:[],additional_info:{estimated_hours:0,actual_hours:0,notes:[]},priority:"",type:"",deadline:null,assigned_to:null,creator:a},validationSchema:kn,onSubmit:n,children:({values:m,setFieldValue:k,handleChange:u,handleBlur:D,isSubmitting:I,errors:F,touched:R})=>{var Y,A,_,$;return e.jsxs(at,{className:"flex flex-col h-full space-y-7 mx-auto w-[95%] pt-5 pb-4 overflow-y-auto",children:[e.jsx(p,{values:m}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(Q,{InputLabelProps:{shrink:!0},name:"task_name",placeholder:"Type a Name",label:F.task_name&&R.task_name?"Task name is required":"Task Name",fullWidth:!0,value:m.task_name,onChange:E=>x(E.target.value,k),onBlur:D,error:!!F.task_name&&R.task_name}),e.jsx(Q,{name:"deadline",label:F.deadline&&R.deadline?"Deadline is required":"Deadline",type:"date",InputLabelProps:{shrink:!0},fullWidth:!0,value:m.deadline?m.deadline:"",onChange:u,onBlur:D,error:!!F.deadline&&R.deadline})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(ht,{fullWidth:!0,error:!!F.priority&&R.priority,children:[e.jsx(mt,{id:"priority-label",style:{color:"black"},children:F.priority&&R.priority?"Priority is required":"Priority"}),e.jsxs(Ie,{labelId:"priority-label",id:"priority",name:"priority",value:m.priority,onChange:u,onBlur:D,label:F.priority&&R.priority?"Priority is required":"Priority",children:[e.jsx(J,{value:"Low",children:"Low"}),e.jsx(J,{value:"Medium",children:"Medium"}),e.jsx(J,{value:"High",children:"High"}),e.jsx(J,{value:"Critical",children:"Critical"})]})]}),e.jsxs(ht,{fullWidth:!0,error:!!F.type&&R.type,children:[e.jsx(mt,{id:"type-label",style:{color:"black"},children:F.type&&R.type?"Type is required":"Type"}),e.jsxs(Ie,{labelId:"type-label",id:"type",name:"type",value:m.type,onChange:u,onBlur:D,label:F.type&&R.type?"Type is required":"Type",children:[e.jsx(J,{value:"open",children:"Open"}),e.jsx(J,{value:"assigned",children:"Assigned"})]})]})]}),m.type==="assigned"&&e.jsx(Xe,{options:r,value:m.assigned_to?r.find(E=>E.id===m.assigned_to):null,onChange:(E,w)=>k("assigned_to",w==null?void 0:w.id),id:"collaborator-select",PopperComponent:Cn,getOptionLabel:E=>E.name,renderInput:E=>{var w;return e.jsx(Q,{...E,InputLabelProps:{shrink:!0},label:F.assigned_to&&R.assigned_to?"Assigned to is required":"Assigned to",name:"assigned_to",placeholder:"Search by name",error:!!F.assigned_to&&R.assigned_to,onChange:v=>S(v.target.value),value:m.assigned_to?(w=r.find(v=>v.id===m.assigned_to))==null?void 0:w.name:""})},renderOption:(E,w)=>t.createElement("li",{...E,key:w.id,className:"flex py-3 px-5 cursor-pointer hover:bg-gray-200 transition-colors duration-100"},e.jsx(Ve,{children:e.jsx(Te,{alt:w.name,src:w.photoUrl||w.name})}),e.jsxs("div",{className:"flex flex-col ml-1",children:[e.jsx(ce,{variant:"body2",children:w.name}),e.jsx("span",{className:"text-[11px]",children:w.id})]})),renderTags:(E,w)=>(console.log("TAG",E),E.length===0?null:E.map((v,P)=>e.jsx(ot,{variant:"outlined",label:v.name,...w({index:P}),sx:{cursor:"pointer",m:1,border:"1px solid black"}}))),isOptionEqualToValue:(E,w)=>E.id===w.id,fullWidth:!0}),e.jsx(Q,{name:"additional_info.estimated_hours",label:(Y=F.additional_info)!=null&&Y.estimated_hours&&((A=R.additional_info)!=null&&A.estimated_hours)?"Estimated hours are required":"Estimated Hours",type:"text",InputLabelProps:{shrink:!0},fullWidth:!0,value:m.additional_info.estimated_hours,onChange:E=>b(E.target.value,k),onBlur:D,InputProps:{endAdornment:e.jsx(io,{position:"end",children:"h"})},error:!!((_=F.additional_info)!=null&&_.estimated_hours)&&(($=R.additional_info)==null?void 0:$.estimated_hours)}),e.jsxs(jt,{expanded:l,onChange:()=>s(!l),sx:{border:F.goals&&R.goals?"1px solid red":"1px solid black"},children:[e.jsx(Ns,{expandIcon:e.jsx(Cs,{}),children:e.jsx(ce,{children:F.goals&&R.goals?"Provide at leats 1 Goal for the Task":"Task Goals"})}),e.jsxs(bt,{children:[e.jsx(Q,{sx:{backgroundColor:"white",mb:2},label:"Describe a goal and press enter...",value:h,onChange:E=>f(E.target.value),onKeyDown:E=>j(E,k,m.goals),multiline:!0,rows:2,fullWidth:!0}),e.jsx(cs,{className:"flex-wrap py-4 max-h-[65px] overflow-y-auto",children:m.goals.length===0?e.jsx(ce,{className:"text-center pt-2 my-auto",children:"No goals added yet"}):m.goals.map((E,w)=>e.jsx(he,{title:E,placement:"top",arrow:!0,children:e.jsx(ot,{variant:"outlined",label:E.length>y?`${E.substring(0,y)}...`:E,onDelete:N(w,k,m.goals),sx:{cursor:"pointer",m:1,border:"1px solid black"}})},w))})]})]}),e.jsx(Q,{InputLabelProps:{shrink:!0},name:"task_description",placeholder:"Type a description for the task",label:F.task_description&&R.task_description?"Task description is required":"Task Description",multiline:!0,rows:4,fullWidth:!0,value:m.task_description,onChange:u,onBlur:D,error:!!F.task_description&&R.task_description}),e.jsx("div",{className:"flex w-full space-x-2 justify-center items-center",children:e.jsx("button",{className:`w-[95%] h-[55px] rounded-extra p-2 ${d?"backdrop-blur-sm":"backdrop-blur-sm bg-green-500/20 shadow-sm "} border-[1px] border-gray-400 transition-colors duration-300 ease-in-out transform active:translate-y-[2px]`,type:"submit",disabled:d||I,children:"Create Task"})})]})}})},Dn=t.memo(({open:a,onClose:s,onSubmit:l})=>{const[o,c]=t.useState("");return e.jsxs(Fe,{open:a,children:[e.jsx(Me,{children:"Provide at least one reason to reject the task"}),e.jsx(Re,{children:e.jsx("div",{className:"p-4",children:e.jsx(Q,{size:"small",label:"Reason",variant:"outlined",value:o,onChange:i=>c(i.target.value),fullWidth:!0,multiline:!0,rows:4,placeholder:"Provide at least one reason to reject the task"})})}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:()=>{s(),c("")},children:"Cancel"}),e.jsx(xe,{onClick:()=>l(o),disabled:o.length===0,children:"Send"})]})]})}),Ln="http://localhost:3000/api",Tn=`

      How to contribute to this task? 🚀

      1. Copy the task ID.
      2. Before executing a 'Push', paste as a second argument the task ID.
      3. If your second argument has to be the remote name,
          paste the task ID as a third argument.

`,$n=({tasks:a,setTasks:s,render:l,nameFilter:o,handleClose:c})=>{const i=t.useRef({}),{uid:d}=te(w=>w.auth),g=Ee(),h=ye(),{project:f,layer:r,repository:S}=h.state,[T,L]=t.useState(null),[C,y]=t.useState({}),[N,j]=t.useState([]),[p,x]=t.useState(null),[b,n]=t.useState(""),[m,k]=t.useState(null),[u,D]=t.useState(!1),I=({collaborators:w})=>{const v=w.length,P=0,M=v-P;return e.jsxs("div",{className:"flex space-x-1 items-center",children:[w.map((B,W)=>e.jsx(Te,{className:"cursor-pointer",alt:B.username,src:B.photoUrl||B.username,sx:{width:15,height:15,opacity:W>=P?1-(W-P)/M:1}},W)),w.length>3&&e.jsx("span",{children:"..."})]})},F=w=>{const v=T===w;L(v?null:w),v||setTimeout(()=>{const P=i.current[w],M=document.querySelector("#container-scroll");if(P&&M){const B=M.getBoundingClientRect(),q=P.getBoundingClientRect().top-B.top+M.scrollTop;M.scrollTo({top:q,behavior:"smooth"})}},0)},R=w=>{D(!1),Y(b,!1,"pending",[w])},Y=async(w,v,P,M)=>{const B=a.filter(W=>W._id===w)[0];k(w),U.put(`${Ln}/tasks/update-task-status/${B.project}/${w}`,{approved:v,status:P,reasons:M},{params:{uid:d,layerID:B.layer_related_id,repositoryID:B.repository_related_id},headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}).then(W=>{j([W.data.success,W.data.message]),n(""),setTimeout(()=>{k(""),x(w)},2e3),setTimeout(()=>{const q={...B,status:P};s(G=>{const oe=G.filter(ge=>ge._id!==w);return[q,...oe]})},5e3)}).catch(W=>{j([W.response.data.success,W.response.data.message]),n(""),setTimeout(()=>{k(""),x(w)},2e3)})},A=w=>{y({...C,[w]:!0})},_=w=>{const v={...C};delete v[w],y(v)},$=t.memo(({infoDialogOpen:w,setInfoDialogOpen:v,description:P,goals:M})=>e.jsxs(Fe,{open:w,onClose:v,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(Me,{id:"alert-dialog-title",children:"Task Information and Goals"}),e.jsx(Re,{children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex space-x-8 py-2",children:[e.jsx(Q,{sx:{width:"600px","& .Mui-disabled":{color:"black","text-fill-color":"black"}},label:"Task Description",variant:"outlined",value:P,fullWidth:!0,multiline:!0,rows:7,disabled:!0}),e.jsx(Ra,{variant:"outlined",sx:{maxHeight:"194px",overflow:"auto",width:"400px"},children:e.jsx(pt,{dense:!0,component:"ul",children:M.map((B,W)=>e.jsx(Ke,{component:"li",children:e.jsx(tt,{primary:B,primaryTypographyProps:{fontSize:"0.875rem"}})},W))})})]}),e.jsx("div",{className:"h-[200px]",children:e.jsx(nt,{language:"python",style:it,customStyle:{fontSize:"12px",height:"100%",padding:"0px 0px",boxSizing:"border-box"},children:Tn})})]})}),e.jsx(ze,{children:e.jsx(xe,{onClick:()=>v(),autoFocus:!0,children:"Close"})})]})),E=t.useMemo(()=>{const w=v=>v.filter(P=>o?P.task_name.toLowerCase().includes(o.toLowerCase()):!0);switch(l){case"completed":return w(a.filter(v=>v.status==="completed"));case"approval":return w(a.filter(v=>v.status==="approval"));case"pending":return w(a.filter(v=>v.status==="pending"));default:return[...a]}},[a,l,o]);return e.jsx("div",{id:"container-scroll",className:"flex flex-col flex-grow space-y-3 items-center max-h-[650px] h-full overflow-y-auto",children:E.length===0?e.jsx("div",{className:"flex items-center justify-centerw-full h-full text-[15px] font-bold text-gray-400",children:l==="completed"?"No tasks completed yet":l==="approval"?"No tasks waiting for approval":"No pending tasks"}):E.map((w,v)=>e.jsxs(jt,{sx:{width:"93%"},expanded:T===w._id,onChange:()=>F(w._id),ref:P=>i.current[w._id]=P,children:[e.jsxs("div",{className:"flex flex-col space-y-1 w-full p-4 rounded shadow-lg bg-white hover:bg-gray-100 transition-colors border-[1px] border-blue-400",children:[e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsx("h3",{className:"text-[15px] font-bold text-blue-600",children:w.task_name}),e.jsxs("div",{className:"flex space-x-4",children:[w.status==="approval"&&e.jsx("div",{className:"flex items-center justify-center space-x-1 rounded-extra",children:m===w._id?e.jsx("div",{className:"sweet-loading",children:e.jsx(Bt,{color:"#bbdefb",loading:!0,size:5})}):p===w._id?e.jsx("span",{className:`${N[0]===!0?"text-green-500":"text-red-500"} text-[12px] font-semibold`,children:N[1]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{D(!0),n(w._id)},className:"flex justify-center items-center w-[40px] bg-red-300 hover:bg-red-500 transition-colors duration-100 h-full rounded-l-extra font-semibold border-[1px] border-black",children:e.jsx($a,{className:"w-4 h-4",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})}),e.jsx("button",{onClick:()=>Y(w._id,!0,"completed"),className:"flex justify-center items-center w-[40px] bg-blue-300 hover:bg-blue-500 transition-colors duration-100 h-full rounded-r-extra font-semibold border-[1px] border-black",children:e.jsx(Ea,{className:"w-3 h-3",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})]})}),e.jsx("div",{className:`${w.status==="completed"?"bg-blue-400":w.status==="approval"?"bg-yellow-200":"bg-red-200"} rounded-full px-3 py-1  text-sm font-semibold text-black ml-2`,children:e.jsx(Se,{size:15,color:`
                          ${w.status==="completed"?"white":(w.status==="approval","black")}`,children:w.status==="completed"?e.jsx(qt,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}):w.status==="approval"?e.jsx(Gt,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}):e.jsx(ys,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})}),e.jsx(Dn,{open:u,onClose:()=>D(!1),onSubmit:R})]})]}),e.jsx("p",{className:"text-[14px] text-gray-700 line-clamp-2 w-[600px]",children:w.task_description}),e.jsxs("div",{className:" mt-1 ",children:[e.jsxs("span",{className:"inline-block bg-gray-200 rounded-full px-3 py-1 text-[10px] font-semibold text-gray-700 mr-2",children:["#",w==null?void 0:w.repository_number_task]}),e.jsx("span",{className:`inline-block ${w.type==="open"?"bg-pink-100 text-gray-700":"bg-black text-white"} rounded-full  px-3 py-1 text-[10px] font-semibold mr-2`,children:w.type}),e.jsxs("span",{className:"inline-block bg-yellow-300 rounded-full px-3 py-1 text-[10px] font-semibold text-black mr-2",children:["Commits: ",w.commits_hashes.length]}),e.jsx("span",{className:`inline-block text-[10px] ${w.status==="completed"?"bg-blue-400":w.status==="approval"?"bg-yellow-200":"bg-red-200"}
                          ${w.status==="completed"?"text-white":"text-black"} rounded-full px-3 py-1  font-semibold mr-2`,children:w.status==="completed"?"Completed":w.status==="approval"?"Waiting for Approval":"Pending"})]}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsxs("div",{className:"flex space-x-2",children:[w.assigned_to&&w.contributors.filter(P=>P._id===w.assigned_to).map((P,M)=>e.jsxs("div",{className:"flex items-center space-x-2 cursor-pointer mt-[1px]",children:[e.jsx(Te,{alt:P.username,src:P.photoUrl||P.username,sx:{width:15,height:15}}),e.jsx("span",{className:"text-[12px]",children:P.username})]},M)),w.assigned_to&&w.contributors.length===0||w.assigned_to&&!w.contributors.some(P=>P._id!==w.assigned_to)?null:!w.assigned_to&&w.contributors.length===0?e.jsx("span",{className:"text-[12px]",children:"No contributors yet"}):e.jsxs("div",{className:"flex space-x-2 items-center pt-[2px]",children:[w.assigned_to&&e.jsx("span",{className:"text-[12px] text-black",children:"·"}),!w.assigned_to&&e.jsx("span",{className:"text-[12px]",children:"Contributors:"}),e.jsx(I,{collaborators:w.contributors})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(he,{title:"Copy Task ID",arrow:!0,placement:"left",children:e.jsx(bs,{onClick:()=>navigator.clipboard.writeText(w._id),className:"w-5 h-5 cursor-pointer hover:text-blue-500 transition-colors duration-200 ease-in-out transform active:translate-y-[2px]",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})}),e.jsx(ws,{onClick:()=>A(w._id),className:"w-5 h-5 cursor-pointer hover:text-blue-500 transition-colors duration-200 ease-in-out transform active:translate-y-[2px]",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx(_t,{onClick:()=>F(w._id),className:"w-5 h-5 cursor-pointer mr-2 hover:text-blue-500 transition-colors duration-200",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})]}),e.jsx($,{infoDialogOpen:C[w._id],setInfoDialogOpen:()=>_(w._id),description:w.task_description,goals:w.goals})]})]},v),e.jsx(bt,{children:e.jsx("div",{className:"flex justify-between  w-full h-[250px]",children:e.jsx("div",{className:"flex justify-between w-full p-1 h-full overflow-hidden",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"flex flex-col bg-gray-50 shadow-lg p-4 rounded-lg space-y-3 border-[1px] border-gray-400",children:[e.jsx("h4",{className:"text-sm font-semibold flex items-center",children:"Commits:"}),e.jsx("ul",{className:"list-disc pl-5 max-h-[180px] overflow-y-auto",children:!w.commits_hashes||w.commits_hashes.length===0?e.jsx("li",{className:"text-[12px]",children:"No commits yet"}):w.commits_hashes.map((P,M)=>e.jsx("li",{className:"text-[12px] w-[120px]",children:e.jsx("span",{onClick:()=>{c(),g(`commits/${P}`,{state:{project:f,layer:r,repository:S,commits:!0,commitHash:P}})},className:"truncate block w-full cursor-pointer hover:text-yellow-500 transition-colors duration-100",children:P})},M))})]}),e.jsxs("div",{className:"flex flex-col bg-gray-50 shadow-lg p-4 rounded-lg space-y-3 border-[1px] border-gray-400",children:[e.jsx("h4",{className:"text-sm font-semibold flex items-center",children:w.additional_info.notes.length===0?"Goals:":"Notes:"}),e.jsx("ul",{className:"list-disc pl-5 max-h-[180px] overflow-y-auto",children:w.additional_info.notes.length===0||w.status==="pending"?w.goals.map((P,M)=>e.jsx("li",{className:"text-[12px] break-words max-w-[200px]",children:P},M)):w.additional_info.notes.map((P,M)=>e.jsx("li",{className:"text-[12px] break-words max-w-[200px]",children:P},M))})]}),e.jsxs("div",{className:"flex flex-row space-x-4 ",children:[e.jsxs("div",{className:"bg-gray-50 shadow-lg p-4 rounded-lg border-[1px] border-gray-400",children:[e.jsx("div",{className:"text-[12px] font-semibold",children:"Estimated Hours:"}),e.jsxs("h6",{className:"text-[12px]",children:[w.additional_info.estimated_hours,"h"]}),w.status!=="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-[12px] font-semibold mt-2",children:"Actual Hours:"}),e.jsxs("h6",{className:"text-[12px]",children:[w.additional_info.actual_hours,"h"]})]})]}),e.jsxs("div",{className:"flex flex-col bg-gray-50 shadow-lg p-4 rounded-lg border-[1px] border-gray-400",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Contributors:"}),e.jsx("div",{className:"flex flex-wrap gap-1 max-w-[104px] max-h-[180px] overflow-y-auto mt-2",children:w.contributors.length===0?e.jsx("span",{className:"text-[12px]",children:"No contributors yet"}):w.contributors.map((P,M)=>e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx(Te,{alt:P.username,src:P.photoUrl||P.username,sx:{width:15,height:15}})},M))})]})]})]})})})})]},w._id))})},En=({project:a,layer:s,repo:l,isTasksModalOpen:o,setIsTasksModalOpen:c})=>{const i=ye(),{repoID:d}=i.state.repository,{uid:g}=te(I=>I.auth),[h,f]=t.useState(!1),[r,S]=t.useState(0),[T,L]=t.useState("completed"),[C,y]=t.useState(!1),[N,j]=t.useState(""),{tasks:p,setTasks:x,isLoading:b,errorWhileFetching:n,errorMessage:m}=wn(d),[k,u]=t.useState(!1),D=()=>{o&&(S(0),setTimeout(()=>{c(!1)},700))};return t.useEffect(()=>{const I=new Image;I.src=Ae,I.onload=()=>{u(!0)}},[]),t.useEffect(()=>{if(o){const I=setTimeout(()=>S(1),20);return()=>clearTimeout(I)}else S(0)},[o]),e.jsx("div",{className:"fixed flex w-screen h-full top-0 right-0 justify-center items-center bg-black/30 z-50",children:e.jsx("div",{id:"repositoryTaskModal",style:{opacity:r,transition:"opacity 300ms ease-in-out, height 300ms ease-in-out, background 300ms ease-in-out",backgroundImage:k?`url(${Ae})`:"none",backgroundSize:C?"":"cover",backgroundPosition:C?"center center":"center"},className:`flex flex-col space-y-2 w-[90%] overflow-hidden md:w-[50%] transition-colors duration-300 glass2 border-[1px] border-gray-400
                      ${C&&h?"md:h-[750px] md:min-h-[750px]":C?"md:h-[640px] md:min-h-[625px]":"md:h-[800px]"} rounded-2xl ${o?"":"pointer-events-none"}`,children:k?n?e.jsx("div",{className:"flex w-full h-full items-center justify-center",children:e.jsx("h1",{className:"text-red-500",children:m})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between w-[95%] h-12 ml-auto mr-auto mt-2 p-2 border-b-2 border-b-gray-500",children:[e.jsxs("p",{className:"text-xl text-black",children:[C&&e.jsx("button",{className:"mr-2",onClick:()=>y(!1),children:e.jsx(Se,{children:e.jsx(Jt,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})}),C?"Create a new Task":"Repository Tasks"]}),e.jsx("button",{onClick:D,children:e.jsx($e,{})})]}),C?e.jsx(Sn,{uid:g,setGoalsExpanded:f,goalsExpanded:h}):e.jsxs("div",{className:"flex flex-col space-y-2 flex-grow",children:[e.jsxs("div",{className:"flex justify-between p-2 w-[95%] ml-auto mr-auto",children:[e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(Ie,{size:"small",value:T,onChange:I=>L(I.target.value),sx:{width:170,backgroundColor:"white","& .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"primary.main"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"primary.main"}},MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},children:[e.jsx(J,{value:"completed",children:"Completed"}),e.jsx(J,{value:"pending",children:"Pending"}),e.jsx(J,{value:"approval",children:"Waiting for Approval"})]}),e.jsx(Q,{size:"small",id:"outlined-basic",label:"Search",variant:"outlined",onChange:I=>j(I.target.value),sx:{width:250,"& .MuiOutlinedInput-notchedOutline":{borderColor:"gray"}},InputProps:{style:{backgroundColor:"white"}}})]}),vt(g,a,s,l)||ms(g,a,s,l)?e.jsx(Pa,{className:"w-8 h-8 hover:text-blue-400 transition-colors duration-200 mr-2 cursor-pointer",onClick:()=>y(!0),onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}):null]}),b?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:"#32174D",size:50})}):e.jsx($n,{tasks:p,setTasks:x,render:T,nameFilter:N,handleClose:D})]})]}):e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:"#ffffff",size:50})})})})},Pn=({setFieldValue:a,values:s,setCurrentOrNew:l})=>{const[o,c]=t.useState(!1),[i,d]=t.useState(""),[g,h]=t.useState(""),[f,r]=t.useState(""),{users:S,setSearch:T}=Qt(),[L,C]=t.useState(null),y=(b,n)=>{h(b),r(n)},N=()=>{r("")},j=(b,n)=>{const m={...L,accessLevel:i},k=b.newCollaborators.filter(D=>D.id!==m.id),u=[m,...k];n("newCollaborators",u),c(!1),d("")},p=(b,n)=>{const m=new Set(b.newCollaborators.map(D=>D.id));let k=[...b.newCollaborators,...b.collaborators];k=k.filter(D=>m.has(D.id)||b.collaborators.some(I=>I.id===D.id));const u=Array.from(new Map(k.map(D=>[D.id,D])).values());n("collaborators",u),l(!1)},x=(b,n,m)=>{const k=b.collaborators.filter(D=>D.id!==m),u=b.newCollaborators.filter(D=>D.id!==m);n("newCollaborators",u),n("collaborators",k)};return e.jsxs("div",{id:"newCollaborators",className:"flex flex-col w-full h-full",children:[e.jsxs("div",{className:"flex flex-col w-full px-5 space-y-2",children:[e.jsx(Xe,{options:S,getOptionLabel:b=>b.name,renderOption:(b,n)=>{const m=s.collaborators.some(u=>u.id===n.id),k=s.newCollaborators.some(u=>u.id===n.id);return e.jsx("div",{children:t.createElement("li",{...b,key:n.id,className:`flex p-3 pl-4 ${m||k?null:"cursor-pointer"} justify-between
                                                ${m||k?null:"hover:bg-gray-200 transition-colors duration-200"}`},e.jsxs("div",{className:"flex",children:[e.jsx(Ve,{children:e.jsx(Te,{alt:n.name,src:n.photoUrl||n.name})}),e.jsxs("div",{className:"flex flex-col ml-1",children:[e.jsx(ce,{variant:"body2",children:n.name}),e.jsx("span",{className:"text-[11px]",children:n.id})]})]}),(m||k)&&e.jsx("div",{className:"flex items-center mr-6",children:e.jsx("span",{className:"text-[11px] text-green-400",children:m&&!k?"Already a collaborator":m&&k?"Added recently":null})}))})},fullWidth:!0,renderInput:b=>e.jsx(Q,{...b,onChange:n=>T(n.target.value),label:"Search User by Name or ID"}),filterOptions:(b,{inputValue:n})=>b.filter(m=>m.name.toLowerCase().includes(n.toLowerCase())||m.id.toString().includes(n)),onChange:(b,n)=>{const m=s.collaborators.some(u=>u.id===(n==null?void 0:n.id)),k=s.newCollaborators.some(u=>u.id===(n==null?void 0:n.id));if(m||k){console.log("Este usuario ya ha sido añadido o es un colaborador existente. No se puede añadir de nuevo.");return}n!==null&&!s.newCollaborators.some(u=>u.id===n.id)&&(C(n),c(!0))}}),e.jsxs(Fe,{open:o,onClose:()=>c(!1),children:[e.jsx(Me,{children:"Set Access Level"}),e.jsx(Re,{children:e.jsxs(Ie,{value:i,onChange:b=>d(b.target.value),fullWidth:!0,children:[e.jsx(J,{value:"reader",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Reader"}),e.jsx(he,{title:g,open:f==="contributor",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>y('The Reader can clone the repository by having access to the "Clone" command on PrJConsole, view the activity of the repository, such as commits history and tasks.',"contributor"),onMouseLeave:N,children:e.jsx(Be,{})})})]})}),e.jsx(J,{value:"editor",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Editor"}),e.jsx(he,{title:g,open:f==="coordinator",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>y('The Editor has all the capabilities of the Reader with extra access to the "Push" and "Pull" commands on PrjConsole to contribute to the repository, he can contribute to open and assigned tasks of the repository.',"coordinator"),onMouseLeave:N,children:e.jsx(Be,{})})})]})}),e.jsx(J,{value:"administrator",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Administrator"}),e.jsx(he,{title:g,open:f==="administrator",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>y("The Administrator has all the capabilities of the Editor, including the ability to modify settings, manage all aspects and collaborators within the repository.","administrator"),onMouseLeave:N,children:e.jsx(Be,{})})})]})})]})}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:()=>{c(!1),C(null)},children:"Cancel"}),e.jsx(xe,{onClick:()=>j(s,a),disabled:!i,children:"Add"})]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto px-3 h-[320px]",children:s.newCollaborators.length===0?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("span",{className:"text-sm",children:"There are no new collaborators currently"})}):e.jsx(pt,{children:s.newCollaborators.map((b,n)=>e.jsxs(Ke,{className:"border-b-[1px] border-gray-400",secondaryAction:e.jsx("button",{className:"mr-3",onClick:()=>x(s,a,b.id),children:e.jsx($e,{size:18,color:"#ef233c"})}),children:[e.jsx(Ve,{children:e.jsx(Te,{alt:b.name,src:"/path/to/your/image.jpg"})}),e.jsx(tt,{primary:b.name,secondary:e.jsxs(e.Fragment,{children:[e.jsxs(ce,{component:"span",variant:"body2",color:"textPrimary",children:["Access Level: ",b.accessLevel]}),e.jsxs(ce,{component:"div",variant:"body2",color:"textSecondary",children:["ID: ",b.id]})]})})]},n))})})]}),e.jsx("div",{className:"flex flex-grow justify-center mx-4  items-center py-4  border-t-[1px] border-gray-400 ",children:e.jsx("button",{type:"button",className:"h-[55px] w-[95%] border-1 border-gray-400  rounded-extra glassi transition-transform duration-150 ease-in-out transform active:translate-y-[2px]",onClick:()=>p(s,a),children:"Update Collaborators"})})]})},rs="http://localhost:3000/api",In=({isRepoFormOpen:a,setIsRepoFormOpen:s,repo:l})=>{const o=ye(),{ID:c}=o.state.project,{layerID:i}=o.state.layer,{repoID:d}=o.state.repository,{uid:g}=te(ie=>ie.auth),{layers:h}=te(ie=>ie.platypus),[f,r]=t.useState(null),[S,T]=t.useState(""),[L,C]=t.useState(!1),[y,N]=t.useState(!1),[j,p]=t.useState(!1),[x,b]=t.useState(null),[n,m]=t.useState(!1),[k,u]=t.useState(""),[D,I]=t.useState(""),[F,R]=t.useState(!1),[Y,A]=t.useState(!1),[_,$]=t.useState(!1),[E,w]=t.useState(""),[v,P]=t.useState(""),[M,B]=t.useState(!1),[W,q]=t.useState(null),[G,oe]=t.useState(0),[ge,ae]=t.useState([]),[le,ee]=t.useState(""),[K,fe]=t.useState(null),[re,de]=t.useState(!0),[Z,pe]=t.useState(!1),O=()=>{a&&(oe(0),setTimeout(()=>{s(!1)},700))},H=(ie,me)=>{I(ie),u(me)},se=()=>{u("")},V=()=>{switch(v){case"open":return e.jsx(Ze,{children:'Are you sure you want to change the visibility type? The "Open" type will allow all project collaborators to access the repository, if the project and layer are open, it will allow all users in prjmanager to access it as well.'});case"internal":return e.jsx(Ze,{children:'Are you sure you want to change the visibility type? The "Internal" type will allow access to the repository only to the collaborators of the project.'});case"restricted":return e.jsx(Ze,{children:'Are you sure you want to change the visibility type? The "Restricted" type will allow access to the repository only to the collaborators invited exclusively.'});default:return null}},z=(ie,me)=>{p(!0),fe(ie),ee(me),$(!0)},ue=(ie,me)=>{if(K!=null&&K.new){const je={...K,accessLevel:le},ke=ie.newCollaborators.filter(be=>be.id!==je.id),He=ie.collaborators.filter(be=>be.id!==je.id),Ge=[je,...ke];me("newCollaborators",Ge),me("collaborators",[je,...He]),$(!1),p(!1),ee(""),fe(null)}else{const je={...K,accessLevel:le},ke=ie.collaborators.filter(be=>be.id!==je.id),He=ie.modifiedCollaborators.filter(be=>be.id!==je.id),Ge=[je,...ke];me("collaborators",Ge),me("modifiedCollaborators",[...He,je]),$(!1),p(!1),ee(""),fe(null)}},ne=(ie,me)=>{const je={...K,accessLevel:le},ke=ie.collaborators.filter(Ge=>Ge.id!==je.id),He=[je,...ke];me("collaborators",He),ee(""),fe(null)},ve=ie=>e.jsxs(t.Fragment,{children:[e.jsxs("div",{children:["ID: ",ie.id]}),e.jsxs("div",{className:"flex",children:["Access Level:",e.jsx("h5",{className:"text-green-500 ml-1",children:ie.accessLevel.charAt(0).toUpperCase()+ie.accessLevel.slice(1)})]})]}),Oe=ie=>{const me=ie.map(je=>({name:je.name,photoUrl:je.photoUrl,id:je.uid,accessLevel:je.repository.accessLevel}));ae(me),de(!1)},De=({values:ie})=>(t.useEffect(()=>{const me=ie.newCollaborators.length===0&&ie.modifiedCollaborators.length===0&&ie.deletedCollaborators.length===0&&ie.name===l.name&&ie.visibility===l.visibility&&ie.description===l.description&&ie.branches.every((je,ke)=>je.default===l.branches[ke].default);pe(me)},[ie]),null),We=async(ie,{setSubmitting:me,resetForm:je})=>{var ke;me(!0),de(!0);try{const He=await U.put(`${rs}/repos/update-repository/${c}/${i}/${d}`,ie,{params:{uid:g},headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}});je(),me(!1),de(!1),O(),X.fire({icon:"success",title:"Success",text:He.data.message})}catch(He){const Ge=He;me(!1),de(!1),Ge.response?((ke=Ge.response.data)==null?void 0:ke.type)==="collaborator-validation"?X.fire({icon:"warning",title:"Access Validation",text:Ge.response.data.message}):X.fire({icon:"error",title:"Oops...",text:Ge.response.data.message}):X.fire({icon:"error",title:"Oops...",text:"There was an unexpected error."})}};return t.useEffect(()=>{const ie=new Image;ie.src=Ae,ie.onload=()=>{m(!0)}},[]),t.useEffect(()=>{const ie=`${rs}/repos/get-repo-collaborators/${l._id}`,me=`${rs}/layer/get-layer/${i}`,je=h.find(ke=>ke._id===i);je?(r(je),U.get(ie,{headers:{Authorization:localStorage.getItem("x-token")}}).then(ke=>{const{collaborators:He}=ke.data;Oe(He)}).catch(ke=>{console.error("Error fetching layer collaborators:",ke)})):U.all([U.get(ie,{headers:{Authorization:localStorage.getItem("x-token")}}),U.get(me,{headers:{Authorization:localStorage.getItem("x-token")}})]).then(U.spread((ke,He)=>{const{collaborators:Ge}=ke.data;Oe(Ge),r(He.data.layer)})).catch(ke=>{console.error("Error fetching layer collaborators:",ke)})},[l,i,h]),t.useEffect(()=>{if(a){const ie=setTimeout(()=>oe(1),20);return()=>clearTimeout(ie)}else oe(0)},[a]),e.jsx("div",{className:"fixed  flex h-full w-screen top-0 right-0 justify-center items-center bg-black/30 z-50",children:e.jsxs("div",{id:"repositoryTaskModal",style:{opacity:G,transition:"opacity 300ms ease-in-out, height 300ms ease-in-out, background 300ms ease-in-out",backgroundImage:n?`url(${Ae})`:"none",backgroundPosition:"left center"},className:`flex flex-col space-y-3 w-[90%] overflow-hidden md:w-[50%] pb-2 md:h-[545px] overflow-y-auto transition-colors duration-300 glass2 border-[1px] border-gray-400 rounded-2xl ${a?"":"pointer-events-none"}`,children:[e.jsxs("div",{className:"flex justify-between w-[95%] h-12 ml-auto mr-auto mt-2 p-2 border-b-2 border-b-gray-500",children:[e.jsx("p",{className:"text-xl text-black",children:"Repository Configuration"}),e.jsx("button",{onClick:O,children:e.jsx($e,{})})]}),re||!n?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:n?"#32174D":"#ffffff",size:50})}):e.jsx(st,{onSubmit:We,initialValues:{name:l.name,description:l.description,visibility:l.visibility,collaborators:ge,newCollaborators:[],modifiedCollaborators:[],deletedCollaborators:[],branches:l.branches,newDefaultBranch:null},children:({isSubmitting:ie,values:me,setFieldValue:je,handleChange:ke,handleBlur:He})=>{const Ge=me.collaborators.filter(be=>be.name.toLowerCase().includes(S.toLowerCase())||be.id.toString().includes(S));return e.jsxs(at,{className:"flex flex-col h-full ml-auto mr-auto w-[95%] space-y-4",children:[e.jsx(De,{values:me}),!L&&e.jsx("button",{onClick:()=>C(!L),className:"flex w-full px-2 justify-end hover:text-blue-500 transition-colors duration-200",children:e.jsx("span",{className:"text-[13px]",children:"Add Collaborators"})}),L?e.jsx(Pn,{setFieldValue:je,values:me,setCurrentOrNew:C}):e.jsxs("div",{className:"flex flex-col flex-grow space-y-4",children:[e.jsxs("div",{className:"flex space-x-4 w-full",children:[e.jsx(Q,{name:"name",label:"Repository Name",fullWidth:!0,value:me.name,onChange:ke,onBlur:He}),e.jsxs(ht,{fullWidth:!0,children:[e.jsx(mt,{id:"visibility-label",children:"Visibility"}),e.jsxs(Ie,{labelId:"visibility-label",id:"visibility",name:"visibility",value:me.visibility,onChange:be=>{P(be.target.value),A(!0)},onBlur:He,label:"Visibility",children:[e.jsx(J,{disabled:(f==null?void 0:f.visibility)==="restricted",value:"open",children:"Open"}),e.jsx(J,{value:"internal",children:"Internal"}),e.jsx(J,{value:"restricted",children:"Restricted"})]})]}),e.jsxs(Fe,{open:Y,onClose:()=>A(!1),children:[e.jsx(Me,{children:"Confirm Visibility Change"}),e.jsx(Re,{children:V()}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:()=>A(!1),children:"Cancel"}),e.jsx(xe,{onClick:()=>{je("visibility",v),A(!1)},autoFocus:!0,children:"Confirm"})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-6 w-full mt-6",children:[e.jsxs(jt,{expanded:y,onChange:()=>N(!y),sx:{border:"1px solid gray"},children:[e.jsx(Ns,{expandIcon:e.jsx(Cs,{}),children:e.jsx(ce,{children:"Branches"})}),e.jsx(bt,{children:e.jsx("div",{className:"flex-grow space-y-4 px-4 py-4 overflow-y-auto  max-h-[180px]",children:me.branches.map((be,qe)=>e.jsxs(Ke,{className:"flex space-x-4 justify-between border-b-[1px] border-gray-400",children:[e.jsx(Ur,{className:"w-5 h-5",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx(tt,{primary:be.name}),e.jsxs(Ie,{name:`branches[${qe}].default`,value:be.default?"default":"regular",onChange:et=>{et.target.value==="default"?(q(qe),B(!0),w("Are you sure you want to change the default branch? This action will mean that when executing a push, pull or clone, if a different branch is not specified, this will be the one taken as the main reference.")):(q(null),B(!0),w("To downgrade a default branch to regular, you must select another branch as default."))},children:[e.jsx(J,{value:"default",children:"Default"}),e.jsx(J,{value:"regular",children:"Regular"})]})]},qe))})})]}),e.jsxs(Fe,{open:M,onClose:()=>B(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(Me,{id:"alert-dialog-title",children:"Change branch status"}),e.jsx(Re,{children:e.jsx(Ze,{id:"alert-dialog-description",children:E})}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:()=>B(!1),color:"primary",children:"Cancel"}),W!==null&&e.jsx(xe,{onClick:()=>{const be=me.branches.map((qe,et)=>({...qe,default:et===W}));je("branches",be),je("newDefaultBranch",be[W]._id),B(!1)},color:"primary",autoFocus:!0,children:"Ok"})]})]}),e.jsx(Xe,{open:!1,className:"max-h-[57px]",multiple:!0,value:me.collaborators,options:[],isOptionEqualToValue:(be,qe)=>be.id===qe.id,getOptionLabel:be=>be.name,renderTags:(be,qe)=>e.jsx("div",{className:" overflow-y-auto  max-h-[41px] w-[90%] ",children:Ge.map((et,tr)=>e.jsx(he,{title:x&&x.id===et.id?ve(et):"",onMouseEnter:()=>b(et),onMouseLeave:()=>b(null),children:e.jsx(ot,{variant:"outlined",label:et.name,...qe({index:tr}),onClick:()=>z(et,et.accessLevel),onDelete:()=>{fe(et),R(!0)},sx:{cursor:"pointer"}})}))}),onInputChange:(be,qe)=>{T(qe)},renderInput:be=>e.jsx(Q,{...be,value:S,variant:"outlined",label:me.collaborators.length===0?"No collaborators added":"Collaborators",placeholder:"Search",onChange:qe=>T(qe.target.value),InputProps:{...be.InputProps,endAdornment:e.jsx(t.Fragment,{children:be.InputProps.endAdornment})},sx:{"& .MuiAutocomplete-clearIndicator":{display:"none"},"& .MuiAutocomplete-popupIndicator":{display:"none"}}})}),e.jsxs(Fe,{open:F,onClose:()=>R(!1),children:[e.jsx(Me,{children:"Confirm the deletion of the user as a collaborator"}),e.jsx(Re,{children:e.jsx(Ze,{id:"alert-dialog-description",children:"Are you sure you want to remove this user as a collaborator from the repository? Executing this action means that the user will not be able to access the repository and contribute again in any way."})}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:()=>{R(!1),fe(null)},children:"Cancel"}),e.jsx(xe,{onClick:()=>{const be=me.collaborators.filter(qe=>qe.id!==(K==null?void 0:K.id));je("collaborators",be),je("deletedCollaborators",[...me.deletedCollaborators,K==null?void 0:K.id]),fe(null),R(!1)},children:"Ok"})]})]}),e.jsxs(Fe,{open:_,onClose:()=>$(!1),children:[e.jsx(Me,{children:"Set Access Level"}),e.jsx(Re,{children:e.jsxs(Ie,{value:le,onChange:be=>ee(be.target.value),fullWidth:!0,children:[e.jsx(J,{value:"reader",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Reader"}),e.jsx(he,{title:D,open:k==="contributor",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>H('The Reader can clone the repository by having access to the "Clone" command on PrJConsole, view the activity of the repository, such as commits history and tasks.',"contributor"),onMouseLeave:se,children:e.jsx(Be,{})})})]})}),e.jsx(J,{value:"editor",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Editor"}),e.jsx(he,{title:D,open:k==="coordinator",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>H('The Editor has all the capabilities of the Reader with extra access to the "Push" and "Pull" commands on PrjConsole to contribute to the repository, he can contribute to open and assigned tasks of the repository.',"coordinator"),onMouseLeave:se,children:e.jsx(Be,{})})})]})}),e.jsx(J,{value:"administrator",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Administrator"}),e.jsx(he,{title:D,open:k==="administrator",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>H("The Administrator has all the capabilities of the Editor, including the ability to modify settings, manage all aspects and collaborators within the repository.","administrator"),onMouseLeave:se,children:e.jsx(Be,{})})})]})})]})}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:()=>{$(!1),p(!1),fe(null)},children:"Cancel"}),e.jsx(xe,{disabled:!le,onClick:()=>{j?ue(me,je):ne(me,je)},children:"Ok"})]})]}),e.jsx(Q,{name:"description",label:"Description",multiline:!0,rows:4,fullWidth:!0,value:me.description,onChange:ke,onBlur:He})]}),e.jsx("div",{className:"flex w-full h-full justify-center items-center pb-3",children:e.jsx("button",{className:`w-[95%] h-[55px] rounded-extra p-2 ${Z?"backdrop-blur-sm":"backdrop-blur-sm bg-green-400/20 shadow-sm"} border-[1px] border-gray-400 transition-colors duration-300 ease-in-out transform active:translate-y-[2px]`,type:"submit",disabled:ie,children:"Update Repository"})})]})]})}})]})})},oa="http://localhost:3000/api",_n=(a,s)=>{const[l,o]=t.useState([]),[c,i]=t.useState(new Map),[d,g]=t.useState(new Date().getFullYear().toString()),h=S=>{const T=new Date(S),L=T.getUTCFullYear(),C=String(T.getUTCMonth()+1).padStart(2,"0"),y=String(T.getUTCDate()).padStart(2,"0");return`${L}/${C}/${y}`},f=S=>{const T=S.split("/"),L=T[0],C=T[1].padStart(2,"0"),y=T[2].padStart(2,"0");return`${L}/${C}/${y}`},r=(S,T)=>{const L={},C={};S.forEach(N=>{const j=h(N.createdAt);L[j]||(L[j]={count:0,commits:0,tasks:0},C[j]={commits:0,tasks:0}),L[j].commits+=1,L[j].count+=1,C[j].commits+=1}),T.forEach(N=>{const j=h(N.updatedAt);L[j]||(L[j]={count:0,commits:0,tasks:0},C[j]={commits:0,tasks:0}),L[j].tasks+=1,L[j].count+=1,C[j].tasks+=1});const y=Object.keys(L).map(N=>({date:N,count:L[N].count}));o(y),i(new Map(Object.entries(C)))};return t.useEffect(()=>{(async()=>{try{const T=await U.get(`${oa}/tasks/repo-activity/${a}`,{params:{year:d,uid:s},headers:{Authorization:localStorage.getItem("x-token")}}),L=await U.get(`${oa}/commits/repo-activity/${a}`,{params:{year:d,uid:s},headers:{Authorization:localStorage.getItem("x-token")}});r(L.data.commits,T.data.tasks)}catch(T){console.error(T)}})()},[a,d]),{data:l,detailsMap:c,formatDateFromHeatMap:f,year:d,setYear:g}},An=({uid:a,repository:s})=>{const{data:l,year:o,setYear:c,detailsMap:i,formatDateFromHeatMap:d}=_n(s._id,a),g=new Date(s.createdAt).getFullYear(),h=new Date().getFullYear(),f=Array.from({length:h-g+1},(L,C)=>g+C),r=new Date(`${o}/01/01`),S=new Date(`${o}/12/31`),T=({formattedDate:L,details:C})=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("h3",{children:[L," |"]}),e.jsxs("button",{className:"hover:text-yellow-200 transition-colors duration-100",onClick:()=>console.log(`Commits: ${C.commits}`),children:["Commits: ",C.commits]}),e.jsxs("button",{className:"hover:text-blue-200 transition-colors duration-100",onClick:()=>console.log(`Tasks: ${C.tasks}`),children:["Tasks: ",C.tasks]})]});return e.jsxs("div",{className:"bottom-3 w-[94%] flex flex-col h-[230px] rounded-2xl bg-blue-200/40 border-[1px] border-gray-400 ",children:[e.jsxs("div",{className:"flex w-full h-[70px] items-center px-[60px] justify-between pt-2",children:[e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"2024"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Contributions"})]}),e.jsx(Q,{select:!0,value:o,onChange:L=>c(L.target.value),variant:"standard",size:"small",className:"w-40",children:f.map(L=>e.jsx(J,{value:L.toString(),children:L},L))})]}),e.jsx("div",{className:"flex justify-center w-full  pt-1",children:e.jsx(At,{value:l,width:800,startDate:r,endDate:S,panelColors:{0:"#eff7ff",2:"#90e0ef",4:"#0096c7",10:"#0077b6",20:"#03045e",30:"black"},rectRender:(L,C)=>{const y=d(C.date),N=i.get(y)||{commits:0,tasks:0};return e.jsx(he,{title:e.jsx(T,{formattedDate:y,details:N}),placement:"right",children:e.jsx("rect",{...L})})}})})]})},Fn=({uid:a,repo:s,instructions:l,isRepoInfoOpen:o,setRepoInfoOpen:c})=>{const[i,d]=t.useState(0),[g,h]=t.useState(!1),[f,r]=t.useState(!1),S=()=>{o&&(d(0),setTimeout(()=>{c(!1)},700))};return t.useEffect(()=>{const T=new Image;T.src=Ae,T.onload=()=>{h(!0)}},[]),t.useEffect(()=>{if(o){const T=setTimeout(()=>d(1),20);return()=>clearTimeout(T)}else d(0)},[o]),e.jsx("div",{className:"fixed flex w-screen h-full top-0 right-0 justify-center items-center bg-black/30 z-50",children:e.jsx("div",{style:{opacity:i,transition:"opacity 300ms ease-in-out, height 300ms ease-in-out, background 300ms ease-in-out",backgroundImage:g?`url(${Ae})`:"none",backgroundPosition:"center center"},className:"flex flex-col w-[65%] min-h-[700px] max-h-[700px] rounded-extra glass2 border-[1px] border-gray-400",children:g?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`flex justify-between w-[95%] h-12 ml-auto mr-auto mt-2 p-2 ${f?"":"border-b-2 border-b-gray-500"}`,children:[e.jsx("h1",{className:"text-xl font-bold text-black",children:s.name}),e.jsxs("div",{className:"flex space-x-8 items-center",children:[e.jsx("button",{onClick:()=>r(!f),className:"hover:text-blue-500 trasition-colors duration-100",children:f?"Close Instructions":"How to use PrJConsole?"}),e.jsxs("p",{className:`flex glassi items-center px-4 text-[12px] py-1  rounded-extra border-[1px] border-gray-400 ${s.visibility==="restricted"?"bg-[#00BFFF]/40":s.visibility==="internal"?"bg-[#FFEF00]/40":"bg-[#ED2939]/40"} `,children:[e.jsx("span",{className:"mr-1",children:s.visibility==="restricted"?e.jsx(Ta,{className:"w-4 h-4",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}):s.visibility==="internal"?e.jsx(ja,{}):e.jsx(ba,{className:"w-4 h-4"})})," ",xt(s.visibility)]}),e.jsx("button",{onClick:S,children:e.jsx($e,{})})]})]}),f?e.jsx("div",{className:"flex flex-grow overflow-y-auto rounded-b-extra",children:e.jsx(nt,{language:"javascript",style:it,customStyle:{marginBottom:"0px",padding:"15px",borderRadius:"0px",height:"100%",fontSize:"12px",width:"100%"},children:l})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap  mt-4 text-gray-700  px-4 pl-5",children:[e.jsxs("p",{className:"px-4 py-1 rounded-extra glassi text-[13px] border-[1px] border-gray-400 mr-4 mt-2",children:[e.jsx("strong",{children:"Default Branch:"})," ",xt(s.defaultBranch)]}),e.jsxs("p",{className:"px-4 py-1 rounded-extra glassi bg-green-300/60  text-[13px] border-[1px] border-gray-400 mr-4 mt-2",children:["Branches ",s.branches.length]}),e.jsxs("div",{className:"flex px-4 py-1 rounded-extra glassi bg-yellow-400/60 text-[13px] border-[1px] border-gray-400 mr-4 mt-2",children:[e.jsx(vs,{className:"w-5 h-5 mr-2",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),"  57 Commits"]}),e.jsxs("div",{className:"flex px-4 py-1 rounded-extra glassi  bg-blue-400/60 text-[13px] text-white border-[1px] border-gray-400 mr-4 mt-2",children:[e.jsx(qt,{className:"w-5 h-5 mr-2",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),"  20 Completed"]}),e.jsxs("div",{className:"flex px-4 py-1 rounded-extra glassi  bg-yellow-200/60 text-[13px] border-[1px] border-gray-400 mr-4 mt-2",children:[e.jsx(Gt,{className:"w-5 h-5 mr-2",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),"  5 Waiting For Approval"]}),e.jsxs("div",{className:"flex px-4 py-1 rounded-extra glassi  bg-red-400/60 text-[13px] text-white border-[1px] border-gray-400 mr-4 mt-2",children:[e.jsx(ys,{className:"w-5 h-5 mr-2",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),"  17 Pending"]})]}),e.jsx("div",{className:"flex flex-col w-[95%] text-5xl ml-auto mr-auto mt-4 text-gray-700",children:e.jsx("p",{className:"font-semibold line-clamp-3",style:{overflowWrap:"break-word",wordBreak:"break-word"},children:xt(s.description)})})]}),e.jsx("div",{className:"flex flex-grow justify-center items-end pb-6",children:e.jsx(An,{uid:a,repository:s})})]})]}):e.jsx("div",{className:"flex flex-grow justify-center items-center",children:e.jsx(Ce,{color:"#ffffff",size:50})})})})},la="http://localhost:3000/api",Mn=()=>{const a=Ee(),s=ye(),{repositories:l}=te(Z=>Z.platypus),{uid:o}=te(Z=>Z.auth),{currentProject:c,layers:i}=te(Z=>Z.platypus),[d,g]=t.useState(null),[h,f]=t.useState(null),[r,S]=t.useState([]),[T,L]=t.useState(!0),[C,y]=t.useState(""),[N,j]=t.useState(!0),[p,x]=t.useState(!1),[b,n]=t.useState(!1),[m,k]=t.useState(!1),[u,D]=t.useState(""),[I,F]=t.useState(!1),[R,Y]=t.useState(""),[A,_]=t.useState(!1),[$,E]=t.useState(null),[w,v]=t.useState(null),[P,M]=t.useState(!1),B=s.state.commits,{ID:W,name:q}=s.state.project,{layerID:G,layerName:oe}=s.state.layer,{repoID:ge,repoName:ae}=s.state.repository,le=Z=>{j(!0),x(!1),Y(""),D(""),S([]),y(Z),ee(Z)},ee=t.useCallback(async Z=>{await U.get(`${la}/gitlab/loadRepoFiles/${ge}/${Z||C}`,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}).then(pe=>{S(pe.data.files),y(pe.data.branch),j(!1)}).catch(pe=>{console.log(pe),j(!1),M(!0),E(pe.response.data.type||"Error"),v(pe.response.data.message||"An error occurred while fetching data")})},[ge,C]),K=Z=>{var H;return(((H=(Z!==void 0?Z:u).split(".").pop())==null?void 0:H.toLowerCase())||"")==="md"},fe=t.useCallback(Z=>{var se;g(Z);const pe=(se=Z.branches)==null?void 0:se.find(V=>V.default===!0),O=pe?pe.name:"main";y(O),ee(O);const H=i.find(V=>V._id===G);f(H||null),L(!1)},[i,G,ee]),re=t.useCallback(async()=>{U.get(`${la}/repos/${ge}`,{params:{projectID:W},headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}).then(Z=>{fe(Z.data.repo)}).catch(Z=>{L(!1),M(!0),E(Z.response.data.type||"Error"),v(Z.response.data.message||"An error occurred while fetching data")})},[W,ge,fe]);t.useEffect(()=>{if(ge){const Z=l.find(pe=>pe._id===ge);Z&&Z!==void 0?fe(Z):re()}},[ge,l,re,fe]);const de=`
    PrJConsole Instructions for ${d==null?void 0:d.name}
    Remote URL: ${"https://prjmanager.com/"+(d==null?void 0:d.layerID)+"/"+ge+".git"}
    

    Disclaimer: 
    - Usage is only limited to the VSCODE editor for now.
    - The following instructions are for the PrJConsole interactive console only.
    - You need to have the interactive console and extension provided by the PrJManager team installed to be able to execute commands. 
      if this is your first time, follow the instructions in this article: https://prjmanager.com/docs/getting-started/installation
    - Please note that the extension and console are still in development, possible errors may occur when used, 
      we appreciate your understanding and if they occur, report them to PrJ Team Support.


      Initialize a new repository:
        1. Run the command: "init"        
        2. Run the commando: "commit" to commit the changes to the repository, provide a commit message when prompted by the console.

      Set the remote repository URL:
        1. Run the command: "remote"        
        2. Choose the option "Add Remote URL"
        3. Provide the name for the remote repository URL when prompted by the console (e.g. origin)
        4. Copy and paste the remote URL when prompted by the console

    
        
      Push:
        1. Run the command: "push", it will push the changes by the default "origin" remote repository setted        
        2. (Optional) You can enter a second argument by pressing space after the "push" command, 
            which is supported as a different remote setted ( in case it exists and you want to push 
                                                            that specific remote repository instead of the default "origin" remote repository )
                                                             
        3. If you want to push to a specific branch, you need to change the branch by running the command "branch" before, and change to 
           the branch you want to push to, then run the "push" command.


      Pull:
        1. Run the command: "pull", it will pull the changes by the default "origin" remote repository setted        
        2. (Optional) You can enter a second argument by pressing space after the "pull" command, 
            which is supported as a different remote setted (in case it exists and you want to pull that specific remote)
        
        3. If you want to pull from a specific branch, you need to change the branch by running the command "branch" before, and change to
           the branch you want to pull from, then run the "pull" command.


      Clone:
        1. Run the command: "clone"        
        2. Copy and paste the repository URL when prompted by the console
        3. (Optional) You can enter a second argument by pressing space after pasting the URL of the repository, 
            which is supported as a branch of the repository (in case it exists and you want to clone that specific branch)



      If you need more information about the commands, run the command: "help" to see the list of available commands and their descriptions.
      You can also read the documentation in the PrJManager website: https://prjmanager.com/docs/getting-started/prjconsole-commands

  `;return T?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:"#32174D",size:50})}):N?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:"#32174D",size:50})}):P?e.jsxs("div",{className:"flex flex-col flex-grow items-center justify-center",children:[e.jsx("h1",{className:"text-xl text-red-500",children:w}),$!=="collaborator-validation"&&$!=="token-validation"?e.jsx("button",{onClick:()=>{M(!1),L(!0),re()},className:"hover:text-blue-500 transition-colors duration-100",children:"Try Again"}):null]}):e.jsxs("div",{className:"flex flex-grow w-full h-full",children:[m&&e.jsx(Fn,{uid:o,repo:d,instructions:de,isRepoInfoOpen:m,setRepoInfoOpen:k}),b&&e.jsx(In,{isRepoFormOpen:b,setIsRepoFormOpen:n,repo:d}),I&&e.jsx(En,{project:c,layer:h,repo:d,isTasksModalOpen:I,setIsTasksModalOpen:F}),A&&e.jsx(er,{getExtension:K,isCodeOnBigScreenOpen:A,setIsCodeOnBigScreenOpen:_,fileName:u,fileContent:R}),B?e.jsx(rt,{}):r.length===0?e.jsxs("div",{className:"flex flex-col w-full h-full space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsx("button",{className:"flex items-center space-x-2",onClick:()=>a(-1),children:e.jsx(Se,{size:20,children:e.jsx($s,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})}),e.jsx("button",{className:"flex items-center space-x-2",onClick:()=>ee(),children:e.jsx(Se,{size:18,children:e.jsx(Br,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})})]}),e.jsx("div",{className:"overflow-y-auto bg-[#282a36] rounded-b-3xl",children:e.jsx(nt,{language:"bash",style:it,customStyle:{fontSize:"13px"},children:de})})]}):e.jsxs("div",{className:"flex h-full w-full",children:[e.jsxs("div",{className:"z-10 min-w-[340px] h-full glassi rounded-bl-3xl",children:[e.jsxs("div",{className:"flex items-center justify-between h-[39px] mt-2 pr-3 pl-4",children:[e.jsx("button",{className:"flex items-center",onClick:()=>a(-1),children:e.jsx(Se,{size:20,children:e.jsx($s,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})}),e.jsxs("div",{className:"relative flex  items-center",children:[e.jsx(Or,{className:"w-5 h-5 cursor-pointer hover:text-yellow-600 duration-150 ease-in-out transition-all transform active:translate-y-[2px] mr-3",onClick:()=>a("commits",{state:{project:{ID:W,name:q},layer:{layerID:G,layerName:oe},repository:{repoID:ge,repoName:ae},commits:!0}}),onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx(Wr,{className:"w-[17px] h-[17px] cursor-pointer hover:text-blue-500 duration-150 ease-in-out transition-all transform active:translate-y-[2px] mr-3",onClick:()=>F(!0),onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),vt(o,c,h,d)&&e.jsx(Hr,{className:"w-[17px] h-[17px] cursor-pointer hover:text-slate-600 duration-150 ease-in-out transition-all transform active:translate-y-[2px] mr-2",onClick:()=>n(!0),onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx(ws,{className:"w-[19px] h-[19px] cursor-pointer hover:text-green-500 duration-150 ease-in-out transition-all transform active:translate-y-[2px] mr-2",onClick:()=>k(!0),onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsxs("button",{className:"flex items-center justify-center w-[60px] h-[25px] text-[13px] hover:bg-blue-200 rounded-lg transition-all glassi border-[1px] border-gray-400  duration-150 ease-in-out transform active:translate-y-[2px]",onClick:()=>x(!p),children:[C," ",e.jsx(Ia,{className:"w-[17px] h-[17px]",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})]}),p&&e.jsxs("div",{className:"absolute z-10 flex flex-col min-w-[150px] bg-white border-[1px] border-black top-8 left-[55px] rounded-md p-1 ",children:[e.jsx("div",{className:"text-center w-full py-2 text-sm font-semibold",children:"Branches"}),e.jsx("div",{className:"flex flex-col max-h-60 overflow-y-auto",children:d==null?void 0:d.branches.map(Z=>e.jsxs("button",{className:`flex justify-center items-center py-2  text-sm hover:bg-blue-200 transition-colors duration-100 ${Z.name===C?"bg-blue-100":""} `,onClick:()=>le(Z.name),children:[Z.name," ",Z.default&&e.jsx("span",{className:"w-[50px] text-[9px] px-1 ml-2 bg-green-100 rounded-extra border-[1px] h-[19px] border-black",children:"default"})]},Z==null?void 0:Z._id))})]})]})]}),e.jsx(Va,{branch:C,files:r,repo:d,setFiles:S,setSelectedFileContent:Y,setSelectedFileName:D,selectedFileName:u,onFileClick:yl,onFolderClick:vl})]}),e.jsxs("div",{id:"fileContent",className:`flex flex-grow relative h-full max-h-[92.6vh] overflow-x-auto ${K()?"bg-white":"bg-[#282a36]"}`,children:[u&&K(u)?e.jsx("div",{className:"markdown-body custom-markdown border-2 w-full p-10 max-h-[750px] overflow-y-auto",children:e.jsx(Xt,{children:R})}):u?e.jsx(nt,{language:Lt(u),style:it,customStyle:{marginTop:"0px",padding:"15px",borderRadius:"0px",fontSize:"12px",width:"100%"},children:R===""?"This file is empty.":`${u}
 
${R}`}):e.jsxs("div",{className:"flex flex-col flex-grow items-center justify-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2 text-white",children:"Select a file to see its content"}),e.jsx("p",{className:"text-white",children:"Click on a file in the list on the left"})]}),R!==""&&e.jsx("button",{className:"absolute z-10 text-white bottom-5 right-6",children:e.jsx(Se,{children:e.jsx(Yr,{onClick:()=>_(!A),onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})})]})]})]})},Rn="http://localhost:3000/api",zn=a=>{const[s,l]=t.useState([]),[o,c]=t.useState(!1),i=async()=>{try{const g=(await U.get(`${Rn}/commits/${a.repoID}`,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}})).data.commits;c(!1),l(g)}catch(d){c(!1),console.error("Error fetching commits:",d)}};return t.useEffect(()=>{c(!0),i()},[]),{isLoading:o,commitsData:s}},Un=({commits:a,isLoading:s})=>{const[l,o]=t.useState(null),c=ye(),i=Ee(),d=c.state.project,g=c.state.layer,h=c.state.repository,f=c.state.commits;return e.jsx("div",{id:"commits-scroll-container",className:"flex flex-col w-full  overflow-y-auto px-5 space-y-4 h-full py-4",children:a.map(r=>{var S,T;return e.jsxs(jt,{expanded:l===r.uuid,onChange:()=>o(l===r.uuid?null:r.uuid),children:[e.jsx("div",{className:"flex w-full p-4 rounded shadow-lg  bg-white hover:bg-gray-100 transition-colors border-[1px] border-yellow-300",children:e.jsxs("div",{className:"flex flex-col justify-between w-full",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h3",{className:"text-sm font-semibold text-yellow-600 truncate",title:r.uuid,children:r.uuid}),e.jsxs("span",{className:"text-gray-600 text-sm",children:["Committed on ",new Date(r.date).toLocaleDateString()]})]}),e.jsx("h2",{className:"text-lg font-bold text-gray-800",children:r.message})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx(Te,{alt:r.author.name,src:r.author.photoUrl||r.author.name,sx:{width:24,height:24}}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:r.author.name})]}),e.jsxs("div",{className:"flex space-x-3 items-center",children:[e.jsx(qr,{className:"w-[22px] h-[22px] ml-4 cursor-pointer hover:text-green-600 transition-colors duration-500",onClick:()=>i(`${r.uuid}`,{state:{project:d,layer:g,repository:h,commits:f,commitHash:r.uuid,branch:r.branch}}),onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx(_t,{className:"w-[22px] h-[22px] ml-4 cursor-pointer hover:text-green-600 transition-colors duration-500",onClick:()=>o(l?null:r.uuid),onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})]})]})]})}),e.jsx(bt,{children:s?e.jsx(Tt,{}):e.jsxs("div",{className:"flex p-6 justify-between rounded-lg",children:[e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("h4",{className:"font-semibold text-md",children:"Time since then"}),e.jsx("p",{className:"text-sm text-center text-gray-800",children:Lo(r.date).fromNow()})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("h4",{className:"text-md font-semibold",children:"Commit Message"}),e.jsxs("p",{className:"text-sm max-w-[300px] max-h-[40px] overflow-y-auto break-words text-gray-800",children:['"',r.message,'"']})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h5",{className:"text-md font-semibold",children:"Associated Task"}),e.jsx("p",{className:"text-sm truncate w-[170px] text-blue-500",children:((S=r==null?void 0:r.associated_task)==null?void 0:S.task_name)||"No associated Task"}),e.jsx("p",{className:"text-sm",children:((T=r==null?void 0:r.associated_task)==null?void 0:T._id)||null})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("h5",{className:"text-md font-semibold",children:"Committed By"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Te,{alt:r.author.name,src:r.author.photoUrl||r.author.name,sx:{width:24,height:24}}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:r.author.name})]})]})]})})]},r.uuid)})})},Bn=()=>{const a=ye(),s=Ee(),l=a.state.repository,o=a.state.commitHash,{isLoading:c,commitsData:i}=zn(l);return e.jsxs("div",{className:"flex flex-col w-full h-full items-center",children:[!o&&e.jsxs("div",{className:"flex w-full pb-3  items-center",children:[e.jsx(Jt,{className:"w-5 h-5 ml-4 cursor-pointer",onClick:()=>s(-1),onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx("h1",{className:"text-lg font-bold ml-2",children:"Commits"})]}),o?e.jsx(rt,{}):c?e.jsx("div",{className:"flex flex-grow w-full items-center justify-center",children:e.jsx(Ce,{color:"#32174D",size:50})}):e.jsx(Un,{commits:i,isLoading:c})]})},On="http://localhost:3000/api",Wn=()=>{const a=ye(),s=Ee(),l=a.state.commitHash,o=a.state.layer,c=a.state.project,i=a.state.repository,[d,g]=t.useState(""),[h,f]=t.useState(""),[r,S]=t.useState(!1),[T,L]=t.useState(!0),[C,y]=t.useState([]),[N,j]=t.useState(null),[p,x]=t.useState(null),[b,n]=t.useState(!1),[m,k]=t.useState(""),[u,D]=t.useState(""),I=$=>{var w;return(((w=$.split(".").pop())==null?void 0:w.toLowerCase())||"")==="md"},F=async()=>{try{const{data:{diff:$,branches:E}}=await U.get(`${On}/commits/${i.repoID}/diff/${l}`,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}});console.log("DIFF",$),j($),y(E),L(!1)}catch($){console.error("Error fetching commit diff:",$)}},R=$=>{let E=0,w=0;return $.split(`
`).forEach(v=>{v.startsWith("+")&&!v.startsWith("+++")?E+=1:v.startsWith("-")&&!v.startsWith("---")&&(w+=1)}),{additions:E,deletions:w}},Y=$=>$.split(`
`).filter(E=>!E.startsWith("@@")).map((E,w)=>{let v="#f6f8fa",P="#24292e";return E.startsWith("+")?(v="#e6ffed",P="#22863a"):E.startsWith("-")&&(v="#ffeef0",P="#cb2431"),e.jsx(ce,{component:"span",sx:{display:"block",backgroundColor:v,color:P,fontFamily:"monospace",padding:"2px 5px",fontSize:"12px"},children:E},w)}),A=$=>$.split(`
`).filter(E=>!E.startsWith("@@")&&!E.endsWith(`
 No newline at end of file`)).map(E=>E.startsWith("+")||E.startsWith("-")?E.substring(1):E).join(`
`),_=t.useMemo(()=>N===null?[]:N.filter($=>u===""?!0:$.new_path===u),[N,u]);return t.useEffect(()=>{F()},[l,i.repoID]),t.useEffect(()=>{N&&N.length===1&&x(0)},[N]),e.jsxs("div",{className:"relative flex flex-col space-y-1 items-center  w-full  h-full overflow-y-auto overflow-x-hidden ",children:[r&&e.jsx(er,{getExtension:I,isCodeOnBigScreenOpen:r,setIsCodeOnBigScreenOpen:S,fileContent:h,fileName:d}),e.jsxs("div",{className:"flex w-full justify-between px-5",children:[e.jsxs("div",{className:"flex items-center pb-3",children:[e.jsx(Jt,{className:"w-5 h-5  cursor-pointer",onClick:()=>s(-1),onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsxs(co,{sx:{marginLeft:1},"aria-label":"breadcrumb",children:[e.jsx("button",{className:"text-[12px] hover:text-pink-300 transition-colors duration-500",onClick:()=>s(`/projects/${we(c.name)}/${we(o.layerName)}`,{state:{project:c,layer:o}}),children:o.layerName}),e.jsx("button",{className:"text-[12px] hover:text-green-500 transition-colors duration-500",onClick:()=>s(-2),children:i.repoName}),e.jsxs("span",{className:"text-[12px]",children:[l.slice(0,7)," "]})]}),e.jsx(Gr,{className:"w-5 h-5 ml-3",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx("span",{className:"text-[13px] ml-3 mb-[2px] font-semibold",children:C[0]}),C.length>1&&e.jsx(he,{title:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{children:"The commit is available on the following branches:"}),e.jsx("ul",{className:"flex flex-wrap",children:C.map(($,E)=>e.jsxs("li",{className:"font-semibold ml-2",children:[$," ",E!==C.length-1&&"-"]},E))})]}),placement:"bottom",children:e.jsxs("span",{className:"text-[10px] ml-1 text-blue-600 hover:text-blue-800 transition-colors duration-200 cursor-pointer",children:["+",C.length-1," more"]})})]}),e.jsxs("div",{children:[e.jsxs("button",{className:"myButtonStyle mr-1 text-[13px] flex items-center py-1 px-2 rounded-lg hover:bg-blue-100 transition-colors duration-200",onClick:()=>{x(-1),D(""),n(!b)},children:["Changed Files ",e.jsx(Ia,{className:"w-5 h-5 ml-2",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})]}),e.jsxs("div",{id:"files-searcher",className:`absolute flex flex-col space-y-3 bg-white border-[1px] border-black z-10 ${b?"right-6":"-right-[350px]"} transition-all duration-300 top-10 p-4 rounded-bl-2xl`,children:[e.jsx(Q,{type:"text",placeholder:"Search modified files..",value:m,onChange:$=>k($.target.value)}),e.jsx("div",{className:"flex flex-col filesList max-h-[300px] overflow-y-auto",children:N===null?e.jsx(ce,{children:"No files found"}):N.filter($=>$.new_path.includes(m)).map(($,E)=>{const{additions:w,deletions:v}=R($.diff);return e.jsxs("button",{className:"flex justify-between fileNme mb-2 border-b-[1px] border-gray-400 p-3 items-center hover:bg-blue-100 transition-colors duration-200",onClick:()=>{D($.new_path),n(!1)},children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Jr,{className:"w-4 h-4 mr-2",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx("span",{className:"text-[13px]",children:$.new_path})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("span",{className:"text-green-600 text-[13px]",children:["+",w]}),e.jsxs("span",{className:"text-red-600 text-[13px]",children:["-",v]})]})]},E)})})]})]})]}),e.jsx("div",{className:"flex flex-col flex-grow max-h-[88v] w-[96%] overflow-y-auto py-4 space-y-4",children:T?e.jsx("div",{className:"flex flex-grow h-full items-center justify-center border-t-[1px] border-black",children:e.jsx(Ce,{color:"#32174D",size:50})}):_.map(($,E)=>{const{additions:w,deletions:v}=R($.diff);return e.jsxs(jt,{expanded:p===E,onChange:()=>x(p===E?-1:E),className:"w-full",children:[e.jsx("div",{className:"flex flex-col w-full p-4 rounded shadow-lg  bg-white hover:bg-gray-100 transition-colors border-[1px] border-blue-500",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex space-x-3 items-center",children:[e.jsx("div",{className:"w-7 h-7",children:e.jsx(To,{type:"code",color:"#1254F8",gradientColor:"#00D2FF",gradientOpacity:1,fold:!1,radius:6,glyphColor:"rgba(255,255,255,0.6)"})}),e.jsx(ce,{children:$.new_path})]}),e.jsxs("div",{className:"flex space-x-5 items-center",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("span",{className:"text-green-600",children:["+",w]}),e.jsxs("span",{className:"text-red-600",children:["-",v]})]}),e.jsx(Xr,{className:"w-6 h-6 cursor-pointer hover:text-blue-600 transition-colors duration-500",onClick:()=>{const P=A($.diff);f(P),S(!0),g($.new_path)},onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx(_t,{className:"w-6 h-6 cursor-pointer hover:text-blue-600 transition-colors duration-500",onClick:()=>x(p===E?-1:E),onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})]})]})}),e.jsx(bt,{children:T?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:"#32174D",size:50})}):e.jsx("div",{className:"p-3 max-h-[600px] overflow-y-auto",children:Y($.diff)})})]},E)})})]})},kt="http://localhost:3000/api",Hn=()=>{var _;const s=(_=ye().state)==null?void 0:_.project,[l,o]=t.useState(!1),{uid:c}=te($=>$.auth),[i,d]=t.useState(0),[g,h]=t.useState(0),[f,r]=t.useState(!1),[S,T]=t.useState([]),[L,C]=t.useState([]),[y,N]=t.useState(!1),[j,p]=t.useState(!1),[x,b]=t.useState(null),[n,m]=t.useState(null),[k,u]=t.useState(!1),D=async $=>{const E=L.find(w=>w.commentId===$&&w.uid===c);try{if(E)E.isLike===!0&&(await U.put(`${kt}/likes/${$}`,{commentId:$,uid:c,isLike:!1}),C(w=>w.filter(v=>v.commentId!==$||v.uid!==c)));else{const{data:{savedLike:w}}=await U.post(`${kt}/likes/${$}`,{uid:c,isLike:!0});console.log("savedLike",w),C(v=>[...v,w])}}catch(w){console.error("There was an error",w)}},I=async $=>(await Promise.all($.flatMap(async w=>{try{const{data:{likes:v}}=await U.get(`${kt}/likes/${w._id}`);return v||[]}catch(v){return console.error("Error fetching likes:",v),[]}}))).flat().filter(w=>w!==null),F=async $=>await Promise.all($.map(async E=>({id:E._id,content:E.content,username:E.createdBy.username,photoUrl:E.createdBy.photoUrl||null,likes:E.likes,commentParent:E.commentParent,answering_to:E.answering_to,current_page:E.total_pages>0?1:0,total_pages:E.total_pages||0,createdAt:new Date(E.createdAt).toISOString()}))),R=async($,E)=>{try{const{data:{replies:w,total_pages:v,current_page:P}}=await U.get(`${kt}/comments/get-replies/${$}?page=${E}`),M=await F(w.flat());T(B=>{const W=B.map(G=>G.id===$?{...G,current_page:P,total_pages:v}:G),q=M.filter(G=>!B.some(oe=>oe.id===G.id));return[...W,...q]})}catch(w){console.error("Error fetching replies:",w);const v=w;b(v.response.data.type||"Error"),m(v.response.data.message||"An error occurred while fetching data"),u(!0)}},Y=async $=>{await Promise.all($.map(async E=>{try{const{data:{replies:w}}=await U.get(`${kt}/comments/get-replies/${E._id}?page=${g}`),v=w.flat(),P=await F(v),M=await I(v);T(B=>{const W=P.filter(q=>!B.find(G=>G.id===q.id));return[...B,...W]}),C(B=>{const W=M.filter(q=>!B.find(G=>G.commentId===q.commentId));return[...B,...W]})}catch(w){console.error("Error fetching replies:",w);const v=w;b(v.response.data.type||"Error"),m(v.response.data.message||"An error occurred while fetching data"),u(!0)}}))},A=async($,E)=>{try{E&&o(!0);const{data:{comments:w,current_page:v,total_pages:P}}=await U.get(`${kt}/comments/get-comments/${s.ID}?page=${$}`,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}});if(w.length===0){o(!1),r(!0),N(!1);return}const M=await F(w.filter(W=>W.commentParent===null));await Y(w.filter(W=>W.replies>0));const B=await I(w);T(W=>{const q=M.filter(G=>!W.find(oe=>oe.id===G.id));return[...W,...q]}),C(W=>{const q=B.filter(G=>!W.find(oe=>oe.commentId===G.commentId));return[...W,...q]}),h(v),d(P)}catch(w){console.error("Error fetching comments:",w);const v=w;b(v.response.data.type||"Error"),m(v.response.data.message||"An error occurred while fetching data"),u(!0)}finally{o(!1)}};return t.useEffect(()=>{N(i===0?!1:g!==i)},[g,i]),{setMoreCommentsLoaded:p,setComments:T,setLikes:C,setNoCommentsToFetch:r,handleLikeDislike:D,fetchComments:A,fetchReplies:Y,setCommentWithUser:F,fetchCommentsLikes:I,fetchMoreReplies:R,isLoading:l,currentPage:g,totalPages:i,hasMoreComments:y,moreCommentsLoaded:j,comments:S,likes:L,noCommentsToFetch:f,errorMessage:n,errorWhileFetching:k,setErrorWhileFetching:u,errorType:x}},os="http://localhost:3000/api",Yn=()=>{var fe;const a=t.useRef(null),l=(fe=ye().state)==null?void 0:fe.project,[o,c]=t.useState(""),[i,d]=t.useState(!1),[g,h]=t.useState(""),[f,r]=t.useState(!1),[S,T]=t.useState(""),[L,C]=t.useState({}),[y,N]=t.useState({}),[j,p]=t.useState({}),{currentProject:x}=te(re=>re.platypus),{uid:b,username:n,photoUrl:m}=te(re=>re.auth),{setComments:k,fetchComments:u,fetchMoreReplies:D,handleLikeDislike:I,setNoCommentsToFetch:F,comments:R,likes:Y,noCommentsToFetch:A,hasMoreComments:_,currentPage:$,isLoading:E,errorMessage:w,errorWhileFetching:v,setErrorWhileFetching:P,errorType:M}=Hn(),B=async()=>{try{const de=(await U.post(`${os}/comments/create-comment`,{project:l.ID,content:S,uid:b,photoUrl:m})).data.newComment,Z={id:de._id,content:de.content,username:n,photoUrl:de.photoUrl||null,likes:de.likes,commentParent:de.commentParent,answering_to:de.answering_to,current_page:1,total_pages:1,createdAt:new Date().toISOString()};k([Z,...R]),F(!1),T("")}catch(re){console.error("There was an error:",re)}},W=async re=>{const de=L[re]||"";try{const pe=(await U.post(`${os}/comments/create-comment`,{project:l.ID,content:de,uid:b,answering_to:re,photoUrl:m})).data.newComment,O={id:pe._id,content:pe.content,username:n,likes:pe.likes,photoUrl:pe.photoUrl,commentParent:pe.commentParent,answering_to:pe.answering_to,current_page:1,total_pages:1,createdAt:new Date().toISOString()};k([...R,O]),C(H=>({...H,[re]:""})),q(re,!1),G(re)}catch(Z){console.error("There was an error:",Z)}},q=(re,de)=>{N(Z=>({...Z,[re]:de}))},G=re=>{p(de=>{const Z=(de[re]===!0,!0);return{...de,[re]:Z}})},oe=()=>{c(""),d(!1)},ge=async()=>{d(!1);try{const{data:{message:re}}=await U.put(`${os}/comments/delete-comment/${o}`);console.log("Mensaje de respuesta:",re),k(de=>de.filter(Z=>Z.id!==o)),c("")}catch(re){console.error("Error al eliminar el comentario:",re),c("")}},ae=async()=>{_&&u($,!1)},le=re=>e.jsx(ce,{component:"span",style:{color:"gray",fontSize:"10px"},children:re}),ee=re=>{const de=R.find(Z=>Z.id===re);return de?e.jsxs(ce,{component:"span",style:{color:"blue",fontSize:"13px"},children:["@",de.username," "]}):e.jsx(ce,{component:"span",style:{color:"red",fontSize:"13px"},children:"@deleted"})},K=re=>{const de=(O,H={})=>re.find(se=>se.commentParent===O)?e.jsxs(xe,{sx:{marginLeft:5},style:H,onClick:()=>p(se=>({...se,[O]:!se[O]})),children:[j[O]?"Hide":"Show"," Replies"]}):null,Z=(O,H={})=>{const se=Y.filter(z=>z.commentId===O&&z.uid===b&&z.isLike===!0).length>0,V=Y.filter(z=>z.commentId===O&&z.isLike===!0).length;return e.jsxs(cs,{sx:{marginRight:1,display:"flex",alignItems:"center",...H},children:[e.jsx(yt,{onClick:()=>I(O),children:e.jsx(xo,{sx:{width:20,height:20},color:se?"primary":"inherit"})}),e.jsx("span",{children:V})]})},pe=(O,H,se)=>e.jsxs(pt,{dense:!0,children:[re.filter(V=>V.commentParent===O).map(V=>e.jsxs(t.Fragment,{children:[e.jsxs(Ke,{children:[e.jsx(Ve,{sx:{marginRight:"15px !important",minWidth:"30px !important"},children:e.jsx(Te,{sx:{width:30,height:30},alt:V.username,src:V.photoUrl||V.username})}),e.jsx(tt,{primary:e.jsxs(t.Fragment,{children:[V.username," ",le(V.createdAt)]}),secondary:e.jsx(t.Fragment,{children:V.commentParent?e.jsxs("span",{children:[ee(V.answering_to!==null?V.answering_to:V.commentParent),": ",e.jsx("span",{className:"text-black",children:V.content})]}):e.jsx("span",{style:{fontWeight:"bold"},children:V.content})}),primaryTypographyProps:{style:{fontSize:"13px"}},secondaryTypographyProps:{style:{fontSize:"13px"}}}),e.jsx(yt,{onClick:()=>q(V.id,!y[V.id]),children:e.jsx(Ft,{sx:{fontSize:"1.2rem"}})}),Z(V.id,{fontSize:"0.75rem"}),g===V.id&&e.jsx(yt,{onClick:()=>{c(V.id),d(!0)},children:e.jsx(Es,{sx:{width:20,height:20}})}),e.jsxs(Fe,{open:i,onClose:oe,PaperProps:{style:{boxShadow:"none",border:"1px solid #ccc",borderRadius:"4px"}},componentsProps:{backdrop:{style:{backgroundColor:"transparent"}}},children:[e.jsx(Me,{children:"Confirm Comment Deletion"}),e.jsx(Re,{children:"Are you sure you want to delete this comment?"}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:oe,children:"Cancel"}),e.jsx(xe,{onClick:ge,autoFocus:!0,children:"Confirm"})]})]}),vt(b,x)||ms(b,x)?e.jsx(yt,{onClick:()=>h(z=>z===V.id?"":V.id),children:e.jsx(Ps,{sx:{width:18,height:18}})}):null]}),e.jsx(ds,{variant:"inset",component:"li"}),y[V.id]&&e.jsxs(Ke,{sx:{pl:4},children:[e.jsx(Q,{fullWidth:!0,multiline:!0,rows:2,placeholder:"Write a reply...",variant:"outlined",value:L[V.id]||"",onChange:z=>C({[V.id]:z.target.value}),sx:{mr:2}}),e.jsx(Is,{children:e.jsx(xe,{variant:"contained",color:"secondary",onClick:()=>W(V.id),endIcon:e.jsx(Ft,{}),children:"Reply"})})]})]},V.id)),v&&e.jsx("p",{className:"text-red-500 text-[12px] mt-2 ml-[5%]",children:w}),H!==null&&se>1&&H!==se&&e.jsx("button",{className:"w-[150px] my-2 ml-5 rounded-extra hover:text-blue-400 transition-colors duration-300 p-2 text-sm",onClick:()=>D(O,H),children:"Load more"})]});return e.jsx(pt,{dense:!0,children:re.filter(O=>O.commentParent===null).map(O=>e.jsxs("div",{className:"w-[96%] mx-auto",children:[e.jsxs(Ke,{children:[e.jsx(Ve,{children:e.jsx(Te,{alt:O.username,src:O.photoUrl||O.username})}),e.jsx(tt,{primary:e.jsxs(t.Fragment,{children:[O.username," ",le(O.createdAt)]}),secondary:e.jsxs("span",{children:[O.commentParent?`@${ee(O.commentParent)}: `:"",e.jsx("span",{className:"text-black",children:O.content})]}),primaryTypographyProps:{style:{whiteSpace:"normal",wordWrap:"break-word"}},secondaryTypographyProps:{style:{whiteSpace:"normal",wordWrap:"break-word"}}}),de(O.id,{fontSize:"0.80rem"}),e.jsx(yt,{sx:{marginLeft:1},onClick:()=>q(O.id,!y[O.id]),children:e.jsx(Ft,{sx:{width:20,height:20}})}),Z(O.id,{fontSize:"1rem"}),g===O.id&&e.jsx(yt,{onClick:()=>{c(O.id),d(!0)},children:e.jsx(Es,{sx:{width:20,height:20}})}),e.jsxs(Fe,{open:i,onClose:oe,PaperProps:{style:{boxShadow:"none",border:"1px solid #ccc",borderRadius:"4px"}},componentsProps:{backdrop:{style:{backgroundColor:"transparent"}}},children:[e.jsx(Me,{children:"Confirm Comment Deletion"}),e.jsx(Re,{children:"Are you sure you want to delete this comment?"}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:oe,children:"Cancel"}),e.jsx(xe,{onClick:ge,autoFocus:!0,children:"Confirm"})]})]}),vt(b,x)||ms(b,x)?e.jsx(yt,{onClick:()=>h(H=>H===O.id?"":O.id),children:e.jsx(Ps,{sx:{width:20,height:20}})}):null]}),e.jsx(ds,{variant:"inset",component:"li"}),y[O.id]&&e.jsxs(Ke,{sx:{pl:4},children:[e.jsx(Q,{fullWidth:!0,multiline:!0,rows:2,placeholder:"Write a reply...",variant:"outlined",value:L[O.id]||"",onChange:H=>C({[O.id]:H.target.value}),sx:{mr:2}}),e.jsx(Is,{children:e.jsx(xe,{variant:"contained",color:"info",onClick:()=>W(O.id),endIcon:e.jsx(Ft,{}),children:"Reply"})})]}),j[O.id]&&e.jsx(cs,{sx:{ml:2},children:pe(O.id,O.current_page,O.total_pages)})]},O.id))})};return t.useEffect(()=>{u($,!0)},[]),v?e.jsxs("div",{className:"flex flex-col flex-grow items-center justify-center",children:[e.jsx("h1",{className:"text-xl text-red-500",children:w}),M!=="collaborator-validation"&&M!=="token-validation"?e.jsx("button",{onClick:()=>{P(!1),u(0,!0)},className:"hover:text-blue-500 transition-colors duration-100",children:"Try Again"}):null]}):e.jsx("div",{className:"h-full w-full overflow-hidden",children:E?e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:e.jsx(Ce,{color:"#32174D",size:50})}):e.jsxs("div",{className:"flex flex-col h-full rounded-extra",children:[e.jsxs("div",{className:"flex flex-col space-x-2 pt-5 px-5 pb-1",children:[e.jsx(Q,{fullWidth:!0,multiline:!0,placeholder:"Write a comment...",value:S,onChange:re=>{r(re.target.value.length>0),T(re.target.value)},sx:{mr:2}}),e.jsxs("div",{className:`flex opacity-0 ${f?"opacity-100":"opacity-0"} transition-opacity duraation-300 justify-end  pr-2 py-2 space-x-4`,children:[e.jsx("button",{onClick:()=>T(""),className:"w-[120px] hover:bg-red-200 transition-colors duration-300 rounded-extra border-[1px] border-gray-400 text-sm p-2",children:"cancel"}),e.jsx("button",{onClick:B,className:"w-[120px] backdrop-blur-sm bg-blue-300/20  shadow-sm hover:bg-blue-600/20 transition-colors duration-300 rounded-extra border-[1px] border-gray-400 text-sm p-2",children:"post"})]})]}),e.jsx("div",{id:"comments",ref:a,className:"flex flex-col flex-grow max-h-[700px] overflow-y-auto px-2",children:A?e.jsx("div",{className:"flex w-full h-full justify-center",children:e.jsx("h1",{className:"text-xl mt-[20%] text-gray-400 mb-10",children:"There are no comments yet, start the conversation!"})}):e.jsxs(e.Fragment,{children:[K(R),_&&e.jsx("button",{className:"w-[150px] my-2 ml-5 rounded-extra hover:text-blue-400 transition-colors duration-300 p-2 text-sm",onClick:ae,children:"Load more"})]})})]})})},qn=({users:a})=>{const s=Ee();return e.jsx(e.Fragment,{children:a.map(l=>e.jsxs("div",{className:"flex justify-between items-center hover:bg-slate-300 transition-all duration-150 ease-in-out cursor-pointer py-4 px-4   border-b-[1px] border-black",onClick:()=>s(`/profile/${we(l.username)}`,{state:{user:{uid:l.uid,username:l.username}}}),children:[e.jsxs("div",{className:"flex space-x-4 items-center",children:[e.jsx("img",{className:"w-12 h-12 rounded-full",alt:l.username,src:l.photoUrl||Ye(l.username)}),e.jsxs("h3",{className:"text-[15px] font-semibold",children:["@",l.username]})]}),e.jsx("div",{className:"flex space-x-6 items-center h-full",children:e.jsxs("h2",{className:"text-[18px] font-semibold text-blue-400 nav-button",children:["Projects: ",e.jsx("span",{className:"text-black ml-2",children:l.projects})]})})]},l.uid))})},Gn=({projects:a})=>{const s=Ee(),l=(o,c=100)=>o.length>c?`${o.substring(0,c)}...`:o;return e.jsx(pt,{dense:!0,children:a.map(o=>e.jsxs(t.Fragment,{children:[e.jsxs(Ke,{className:"rounded-lg hover:bg-slate-300 transition-all duration-150 ease-in-out cursor-pointer",onClick:()=>s(`../projects/${we(o.name)}`,{state:{project:{ID:o.pid,name:o.name}}}),alignItems:"flex-start",style:{padding:"18px"},children:[e.jsx("div",{className:"border-[1px] border-gray-400",style:{width:"100px",height:"100px",marginRight:"20px",backgroundImage:`url(${ft})`,backgroundSize:"cover",borderRadius:"8px"}}),e.jsx(tt,{primary:o.name,secondary:e.jsxs(t.Fragment,{children:[l(o.description),e.jsx("div",{style:{marginTop:"10px",display:"flex",flexWrap:"wrap",gap:"5px"},children:o.tags.map((c,i)=>e.jsx(ot,{label:c,size:"small",variant:"outlined",style:{borderColor:"rgba(0, 0, 0, 0.5)"}},i))})]}),primaryTypographyProps:{style:{fontWeight:"bold",fontSize:"1.25rem"}},secondaryTypographyProps:{style:{color:"rgba(0, 0, 0, 0.7)",display:"block"}}}),e.jsxs("p",{style:{display:"flex",marginLeft:"auto"},children:[o.praises," ",e.jsx(_a,{className:"ml-4 w-5 h-5",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})]})]}),o!==a[a.length-1]&&e.jsx(ds,{component:"li",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"}})]},o.pid))})},Jn="http://localhost:3000/api",Xn=()=>{const[a,s]=t.useState([]),[l,o]=t.useState(""),[c,i]=t.useState("profiles");return t.useEffect(()=>{(async()=>{try{if(l===""){s([]);return}const h=(await U.post(`${Jn}/searcher/${c}`,{searchTerm:l})).data.results;s(h)}catch(g){console.error("Error fetching search results:",g)}})()},[l,c]),e.jsxs("div",{className:"flex flex-col w-full h-full space-y-7 p-2",children:[e.jsxs("div",{className:"flex flex-col w-full rounded-extra mt-4 px-4",children:[e.jsx(Q,{id:"outlined-basic",label:"Search",variant:"outlined",className:"w-full h-full glassi",sx:{borderRadius:"25px","& .MuiOutlinedInput-root":{borderRadius:"25px"}},onChange:d=>o(d.target.value)}),e.jsxs("div",{className:"flex space-x-7 mt-4 ml-2",children:[e.jsx("button",{onClick:()=>{s([]),i("profiles")},className:`border-2 w-20 h-8 rounded-xl glassi ${c==="profiles"?"bg-blue-500/40":""} transition-all duration-150 ease-in-out transform active:translate-y-[2px] border-[1px] border-gray-400`,children:e.jsx("p",{className:"text-sm",children:"Profiles"})}),e.jsx("button",{onClick:()=>{s([]),i("projects")},className:`border-2 w-20 h-8 rounded-xl glassi ${c==="projects"?"bg-blue-500/40":""} transition-all duration-150 ease-in-out transform active:translate-y-[2px]  border-[1px] border-gray-400`,children:e.jsx("p",{className:"text-sm",children:"Projects"})})]})]}),e.jsx("div",{className:"h-full max-h-[650px] overflow-y-auto pr-8 px-4",children:l===""?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[e.jsx("p",{className:"text-3xl font-bold",children:"Search something"}),e.jsx("p",{className:"text-xl font-bold",children:"Start typing to search"})]}):a.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[e.jsx("p",{className:"text-3xl font-bold",children:"No results"}),e.jsx("p",{className:"text-xl font-bold",children:"Try searching for something else"})]}):c==="profiles"?e.jsx(qn,{users:a}):e.jsx(Gn,{projects:a})})]})},Qn=(a,s,l)=>{const o=Ls(),{layers:c,repositories:i}=te(x=>x.platypus),[d,g]=t.useState({name:"",children:[]}),[h,f]=t.useState(null),[r,S]=t.useState(!1),[T,L]=t.useState({x:0,y:0}),[C,y]=t.useState({x:0,y:0}),N=t.useCallback(x=>{const b={name:x.name,children:[{name:"Layers",children:c.filter(n=>n.project===x.pid).map(n=>({name:n.name,type:"L",id:n._id,children:i.filter(m=>m.layerID===n._id).map(m=>({name:m.name,type:"R",id:m._id,layerID:n._id,layerName:n.name}))}))}]};g(b)},[c,i]),j=(x,b)=>{x.stopPropagation(),f(b),S(!0);const n=230,m=210,k=x.clientX-n,u=x.clientY-m;y({x:k,y:u})},p=x=>{x.stopPropagation(),y({x:x.clientX-230,y:x.clientY-210})};return t.useEffect(()=>{c.length>0&&i.length>0&&N(a)},[c,i,a,N]),t.useEffect(()=>{a&&o(Ka(a.pid,l,a==null?void 0:a.accessLevel))},[a,o,s,l]),{treeData:d,newTreeData:N,handleMouseOver:j,handleMouseMove:p,showModal:r,currentNode:h,translate:T,modalPosition:C,setTranslate:L,setShowModal:S,setModalPosition:y}},Zn=({project:a,nodeData:s})=>{const l=Ee(),{layers:o,repositories:c}=te(h=>h.platypus),[i,d]=t.useState(null),g=()=>{switch(s.type){case"R":{const h=i;return e.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:h==null?void 0:h.name}),e.jsxs("span",{className:"mt-2 text-sm text-gray-500",children:["ID: ",h==null?void 0:h._id]}),e.jsxs("div",{className:"flex space-x-2 mt-3",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"mt-1",children:e.jsx(Ts,{})}),e.jsxs("span",{className:"inline-flex items-center text-sm text-gray-500",children:[" ",h==null?void 0:h.visibility]})]}),e.jsx("button",{onClick:f=>{f.preventDefault(),l(`../${we(h==null?void 0:h.layerName)}/${we(h==null?void 0:h.name)}`,{state:{project:{ID:a.ID,name:a.name},layer:{layerID:h==null?void 0:h.layerID,layerName:h.layerName},repository:{repoID:h==null?void 0:h._id,repoName:h==null?void 0:h.name}}})},className:"ml-4 text-sm text-blue-500 hover:underline",children:"Go to Repository"})]})]}),e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(wt,{color:"#80ed99",className:"text-4xl text-gray-400"})})]}),e.jsx("div",{className:"mt-5 border-t border-gray-200 pt-5",children:e.jsxs("div",{className:"flex space-x-4 justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Pending Tasks:"}),e.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"57"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Last Updated:"}),e.jsx("span",{className:"ml-2 text-sm text-gray-500",children:lt(h.updatedAt)})]})]})})]})}case"L":{const h=i;return e.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:h.name}),e.jsxs("span",{className:"mt-2 text-sm text-gray-500",children:["ID: ",h._id]}),e.jsxs("div",{className:"flex space-x-2 mt-3",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"mt-1",children:e.jsx(Ts,{})}),e.jsxs("span",{className:"inline-flex items-center text-sm text-gray-500",children:[" ",h.visibility]})]}),e.jsx("button",{onClick:f=>{f.preventDefault(),l(`../${we(h.name)}`,{state:{project:{ID:a.ID,name:a.name},layer:{layerID:h._id,layerName:h.name}}})},className:"ml-4 text-sm text-blue-500 hover:underline",children:"Go to Layer"})]})]}),e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(Ht,{color:"#ffafcc",className:"text-5xl"})})]}),e.jsx("div",{className:"mt-5 border-t border-gray-200 pt-5",children:e.jsxs("div",{className:"flex space-x-4 justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Repositories"}),e.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"10"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Last Updated:"}),e.jsx("span",{className:"ml-2 text-sm text-gray-500",children:lt(h.updatedAt)})]})]})})]})}default:return"Node"}};return t.useEffect(()=>{switch(s.type){case"L":{const h=o.find(f=>f._id===s.id);if(h){const f={...h,createdAt:new Date(h.createdAt).toLocaleDateString("en-US"),updatedAt:new Date(h.updatedAt).toLocaleDateString("en-US")};d(f)}}break;case"R":{const h=c.find(f=>f._id===s.id);if(h){const f={...h,layerID:s.layerID,layerName:s.layerName,createdAt:new Date(h.createdAt).toLocaleDateString("en-US"),updatedAt:new Date(h.updatedAt).toLocaleDateString("en-US")};d(f)}}break;default:d(null)}},[s,o,c]),e.jsx("div",{className:`flex justify-between items-center p-4 rounded-lg shadow-lg w-full border border-gray-600 ${s.type==="L"?"glass3":"glass4"}`,children:i&&g()})},Kn="http://localhost:3000/api",Vn=ut().shape({name:Ne().required("Layer name is required"),description:Ne().required("Description is required"),visibility:Ne().required("Visibility is required")}),ei=({isLayerFormOpen:a,setIsLayerFormOpen:s})=>{const l=ye(),{uid:o}=te(b=>b.auth),[c,i]=t.useState(!1),{ID:d}=l.state.project,[g,h]=t.useState(!1),[f,r]=t.useState(!1),[S,T]=t.useState(""),[L,C]=t.useState(""),y=()=>{const b=document.getElementById("layerFormModal");b&&(b.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{s(!1)},500))},N=({values:b})=>(t.useEffect(()=>{const n=b.name===""&&b.description===""&&b.visibility==="";r(n)},[b]),null),j=(b,n)=>{C(b),T(n)},p=()=>{T("")},x=async(b,{setSubmitting:n,resetForm:m})=>{var k;i(!0),n(!0);try{const u=await U.post(`${Kn}/layer/create-layer/${d}`,b,{withCredentials:!0,params:{uid:o},headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}});m(),n(!1),i(!1),X.fire({icon:"success",title:"Success",text:u.data.message})}catch(u){const D=u;n(!1),i(!1),D.response?((k=D==null?void 0:D.response.data)==null?void 0:k.type)==="layers-limit"?X.fire({icon:"info",title:`Project layers limit reached
 ( 3 layers )`,text:D.response.data.message}):X.fire({icon:"error",title:"Oops...",text:D.response.data.message||"An unexpected error occurred"}):X.fire({icon:"error",title:"Error",text:"An unexpected error occurred"})}};return t.useEffect(()=>{const b=new Image;b.src=Ae,b.onload=()=>{h(!0)}},[]),t.useEffect(()=>{if(a){const b=setTimeout(()=>{var n,m;(n=document.getElementById("layerFormModal"))==null||n.classList.remove("opacity-0"),(m=document.getElementById("layerFormModal"))==null||m.classList.add("opacity-100")},20);return()=>clearTimeout(b)}},[a]),e.jsx("div",{className:"fixed flex w-screen h-full top-0 right-0 justify-center items-center bg-black/30 z-50",children:e.jsxs("div",{id:"layerFormModal",style:{backgroundImage:g?`url(${Ae})`:"none",backgroundPosition:"top center"},className:`flex flex-col w-[70%]  md:w-[580px] md:h-[455px] pb-5 rounded-2xl glass2 border-[1px] border-gray-400 transition-opacity duration-300 ease-in-out opacity-0 ${a?"":"pointer-events-none"}`,children:[e.jsxs("div",{className:"flex justify-between w-[95%] h-12 ml-auto mr-auto mt-2 p-2 border-b-2 border-b-gray-500",children:[e.jsx("p",{className:"text-xl text-black",children:"Create a new Layer"}),e.jsx("button",{onClick:y,children:e.jsx($e,{})})]}),c||!g?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:"#32174D",size:50})}):e.jsx(st,{initialValues:{name:"",description:"",visibility:"",creator:o},validationSchema:Vn,onSubmit:x,children:({isSubmitting:b,values:n,handleChange:m,handleBlur:k,errors:u,touched:D})=>e.jsxs(at,{className:"flex flex-col ml-auto mr-auto w-[95%] h-full mt-5 ",children:[e.jsx(N,{values:n}),e.jsxs("div",{className:"flex flex-col pt-2 space-y-4 w-full h-[300px] ",children:[e.jsx(Q,{InputLabelProps:{shrink:!!(u.name&&D.name)},name:"name",label:u.name&&D.name?u.name:"Layer Name",fullWidth:!0,value:n.name,onChange:m,onBlur:k,error:!!u.name&&D.name}),e.jsx(Q,{InputLabelProps:{shrink:!!(u.description&&D.description)},name:"description",label:u.description&&D.description?u.description:"Description",multiline:!0,rows:4,fullWidth:!0,value:n.description,onChange:m,onBlur:k,error:!!u.description&&D.description}),e.jsxs(ht,{fullWidth:!0,error:!!u.visibility&&D.visibility,children:[e.jsx(mt,{id:"visibility",children:u.visibility&&D.visibility?u.visibility:"Visibility"}),e.jsxs(Ie,{labelId:"visibility-label",label:u.visibility&&D.visibility?u.visibility:"Visibility",id:"visibility",name:"visibility",value:n.visibility,onChange:m,onBlur:k,children:[e.jsx(J,{value:"open",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Open"}),e.jsx(he,{title:L,open:S==="open",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>j("The open layer allows access to all users in PrJManager.","open"),onMouseLeave:p,children:e.jsx(Be,{})})})]})}),e.jsx(J,{value:"internal",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Internal"}),e.jsx(he,{title:L,open:S==="internal",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>j("The internal layer only allows access to all collaborators in the project.","internal"),onMouseLeave:p,children:e.jsx(Be,{})})})]})}),e.jsx(J,{value:"restricted",children:e.jsxs("div",{className:"flex flex-grow justify-between",children:[e.jsx(ce,{children:"Restricted"}),e.jsx(he,{title:L,open:S==="restricted",arrow:!0,placement:"right",enterTouchDelay:50,leaveTouchDelay:400,leaveDelay:200,enterDelay:100,children:e.jsx("div",{onMouseEnter:()=>j("The restricted layer only allows access to users who are supported as collaborators on the layer.","restricted"),onMouseLeave:p,children:e.jsx(Be,{})})})]})})]})]})]}),e.jsx("div",{className:"flex flex-grow space-x-2 px-4",children:e.jsx("button",{className:`w-full h-[55px] rounded-extra p-2 ${f?"backdrop-blur-sm":"backdrop-blur-sm bg-green-400/20 shadow-sm"} border-[1px] border-gray-400 transition-colors duration-300 ease-in-out transform active:translate-y-[2px]`,type:"submit",disabled:f||b,children:"Create Layer"})})]})})]})})},ti=()=>{var k;const a=ye(),s=Ls(),l=t.useRef(),o=(k=a.state)==null?void 0:k.project,{uid:c}=te(u=>u.auth),[i,d]=t.useState(!1),{currentProject:g,fetchingResources:h,errorWhileFetching:f,errorMessage:r,errorType:S}=te(u=>u.platypus),T=g,{treeData:L,handleMouseMove:C,handleMouseOver:y,currentNode:N,showModal:j,translate:p,modalPosition:x,setTranslate:b,setShowModal:n}=Qn(T,o,c),m=()=>{j&&n(!1)};return t.useEffect(()=>{if(l.current){const u=l.current.getBoundingClientRect().width,D=l.current.getBoundingClientRect().height;b({x:u/2-20,y:D/8})}},[b]),t.useEffect(()=>{const u=D=>{l.current&&!l.current.contains(D.target)&&j&&n(!1)};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[j,n]),f?e.jsxs("div",{className:"flex flex-col flex-grow glass2 items-center justify-center",children:[e.jsx("h1",{className:"text-xl text-red-500",children:r}),S!=="collaborator-validation"&&S!=="token-validation"?e.jsx("button",{onClick:()=>{s(hs({fetchingResources:!0,errorWhileFetching:!1,errorMessage:null,errorType:null})),s(Ka(o.ID,o.accessLevel,c))},className:"hover:text-blue-500 transition-colors duration-100",children:"Try Again"}):null]}):h?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:"#32174D",size:50})}):e.jsxs("div",{className:"flex flex-grow relative",children:[i&&e.jsx(ei,{isLayerFormOpen:i,setIsLayerFormOpen:d}),vt(c,T)&&e.jsx(Qr,{onClick:()=>d(!0),className:"absolute w-10 h-10 z-10 right-5 top-5  text-pink-300 hover:text-pink-400 cursor-pointer transition-colors duration-200",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsxs("div",{ref:l,onClick:m,className:"glassi w-full h-full rounded-b-3xl",id:"treeWrapper",children:[j&&N&&e.jsx("div",{style:{position:"absolute",left:x.x,top:x.y,zIndex:100},children:e.jsx(Zn,{project:o,nodeData:N})}),e.jsx($o,{data:L,translate:p,pathFunc:"straight",orientation:"vertical",nodeSize:{x:200,y:100},initialDepth:5,zoom:.6,enableLegacyTransitions:!0,transitionDuration:500,renderCustomNodeElement:({nodeDatum:u,toggleNode:D})=>{const I=u,F=I.__rd3t.depth===0;let R;return F?R="black":R=I.type==="R"?"#c7f9cc":"#ffafcc",e.jsx("g",{children:F?e.jsxs(e.Fragment,{children:[e.jsx("text",{fill:"black",strokeWidth:"1",x:I.__rd3t.depth===0?"80":"0",y:"-20",textAnchor:"middle",children:I.name}),e.jsxs("g",{transform:"translate(-35, -55)",children:[" ",e.jsx("polygon",{className:"node-class",points:"45,15 55,30 45,45 25,45 15,30 25,15",fill:"skyblue",stroke:"slategray",strokeWidth:"1px",onClick:D})]})]}):I.name==="Layers"?e.jsxs(e.Fragment,{children:[e.jsx("text",{fill:"black",strokeWidth:"1",x:"0",y:"-45",textAnchor:"middle",children:I.name}),e.jsx("foreignObject",{x:"-20",y:"-35",width:"40",height:"40",children:e.jsx("div",{style:{fontSize:"40px"},children:e.jsx(Yt,{color:"#ffafcc"})})})]}):I.type==="R"?e.jsxs(e.Fragment,{children:[e.jsx("text",{fill:"black",strokeWidth:"1",x:I.__rd3t.depth===0?"80":"0",y:"-20",textAnchor:"middle",children:I.name}),e.jsx("circle",{className:"node-class",r:"10",fill:R,stroke:"black",strokeWidth:"1px",onClick:D,onMouseOver:I.name!=="Layers"?Y=>y(Y,u):void 0,onMouseMove:C})]}):e.jsxs(e.Fragment,{children:[e.jsx("text",{fill:"black",strokeWidth:"1",x:I.__rd3t.depth===0?"80":"0",y:"-20",textAnchor:"middle",children:I.name}),e.jsx("rect",{className:"node-class",width:"20",height:"20",x:"-10",y:"-10",fill:R,stroke:"black",strokeWidth:"1px",onClick:D,onMouseOver:I.name!=="Layers"?Y=>y(Y,u):void 0,onMouseMove:C})]})})}})]})]})},na="http://localhost:3000/api",si=(a,s)=>{const[l,o]=t.useState(!1),[c,i]=t.useState(null),[d,g]=t.useState(null),[h,f]=t.useState(!1),[r,S]=t.useState([]),[T,L]=t.useState([]),[C,y]=t.useState([]),N=async(b,n)=>{o(!0);const m=await Promise.all(b.map(async u=>{const{contributorsIds:D,...I}=u;return{...I,contributors:D}})),k=await Promise.all(n.map(async u=>{const{contributorsIds:D,...I}=u;return{...I,contributors:D}}));L(m),y(k),o(!1)},j=t.useCallback(async()=>{try{const{data:{completedTasks:b,approvalTasks:n}}=await U.get(`${na}/tasks/activity-data/${a.pid}`,{params:{uid:s},headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}});N(b,n)}catch(b){const n=b;n.response?(g(n.response.data.message||"An error occurred while fetching data"),i(n.response.data.type||"Error")):(g("An unexpected error occurred"),i("Unknown Error")),f(!0)}},[a,s]),p=t.useCallback(async()=>{try{const{data:{commits:b}}=await U.get(`${na}/commits/activity-data/${a.pid}`,{params:{uid:s},headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}});S(b)}catch(b){const n=b;n.response?(g(n.response.data.message||"An error occurred while fetching data"),i(n.response.data.type||"Error")):(g("An unexpected error occurred"),i("Unknown Error")),f(!0)}},[a,s]),x=()=>{o(!0),j(),p()};return t.useEffect(()=>{o(!0),j(),p()},[a,j,p]),{isLoading:l,setIsLoading:o,tasksCompleted:T,wFApprovalTasks:C,setWFApprovalTasks:y,setTasksCompleted:L,commits:r,errorMessage:d,errorWhileFetching:h,errorType:c,fetchData:x}},ai=({collaborators:a})=>{const s=a.length,l=0,o=s-l;return e.jsxs("div",{className:"flex space-x-1 items-center ",children:[a.map((c,i)=>e.jsx(Te,{alt:c.username,src:c.photoUrl||c.username,sx:{width:20,height:20,opacity:i>=l?1-(i-l)/o:1}},i)),a.length>3&&e.jsx("span",{children:"..."})]})},ls="http://localhost:3000/api",ia=({projectLayers:a,projectRepositories:s,tasksCompleted:l,setTasksCompleted:o,wFApprovalTasks:c,setWFApprovalTasks:i,setRender:d,render:g})=>{const h=t.useRef({}),[f,r]=t.useState(null),[S,T]=t.useState(null),[L,C]=t.useState(null),[y,N]=t.useState(null),[j,p]=t.useState(null),[x,b]=t.useState([]),[n,m]=t.useState(null),[k,u]=t.useState(null),[D,I]=t.useState(null),[F,R]=t.useState(""),[Y,A]=t.useState(!1),[_,$]=t.useState({}),[E,w]=t.useState(!0),[v,P]=t.useState(null),[M,B]=t.useState(null),[W,q]=t.useState(null),[G,oe]=t.useState("completed"),[ge,ae]=t.useState(null),[le,ee]=t.useState(null),{layers:K,repositories:fe}=te(z=>z.platypus),{uid:re}=te(z=>z.auth),de=(z,ue,ne)=>{const ve=f===z;r(ve?null:z),N(ve?null:ue),p(ve?null:ne),ve||setTimeout(()=>{const Oe=h.current[z],De=document.querySelector("#container-scroll");if(Oe&&De){const We=De.getBoundingClientRect(),me=Oe.getBoundingClientRect().top-We.top+De.scrollTop;De.scrollTo({top:me,behavior:"smooth"})}},0)},Z=z=>{$({..._,[z]:!0})},pe=z=>{const ue={..._};delete ue[z],$(ue)},O=t.memo(({infoDialogOpen:z,setInfoDialogOpen:ue,description:ne,goals:ve})=>e.jsxs(Fe,{open:z,onClose:()=>ue(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(Me,{id:"alert-dialog-title",children:"Task Information and Goals"}),e.jsx(Re,{children:e.jsxs("div",{className:"flex space-x-8 p-2",children:[e.jsx(Q,{sx:{width:"600px","& .Mui-disabled":{color:"black","text-fill-color":"black"}},label:"Task Description",variant:"outlined",value:ne,fullWidth:!0,multiline:!0,rows:7,disabled:!0}),e.jsx(Ra,{variant:"outlined",sx:{maxHeight:"194px",overflow:"auto",width:"400px"},children:e.jsx(pt,{dense:!0,component:"ul",children:ve&&ve.map((Oe,De)=>e.jsx(Ke,{component:"li",children:e.jsx(tt,{primary:Oe,primaryTypographyProps:{fontSize:"0.875rem"}})},De))})})]})}),e.jsx(ze,{children:e.jsx(xe,{onClick:()=>ue(!1),autoFocus:!0,children:"Close"})})]})),H=t.useCallback((z,ue)=>{w(!0);const ne=K.filter(We=>We._id===z),ve=fe.filter(We=>We._id===ue),Oe=`${ls}/repos/${ue}`,De=`${ls}/layer/get-layer/${z}`;!ne[0]&&!ve[0]?U.all([U.get(Oe,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}),U.get(De,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}})]).then(U.spread((We,ie)=>{C(We.data.repo),T(ie.data.layer),w(!1)})):ne[0]&&!ve?U.get(Oe,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}).then(We=>{C(We.data.repo),T(ne[0]),w(!1)}):!ne&&ve[0]?U.get(De,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}).then(We=>{T(We.data.layer),C(ve[0]),w(!1)}):(T(ne[0]),C(ve[0]),w(!1))},[K,fe]),se=async(z,ue,ne,ve)=>{const Oe=c.filter(De=>De._id===z)[0];I(z),U.put(`${ls}/tasks/update-task-status/${Oe.project}/${z}`,{approved:ue,status:ne,reasons:ve},{params:{uid:re,layerID:Oe.layer_related_id,repositoryID:Oe.repository_related_id},headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}).then(De=>{b([De.data.success,De.data.message]),u(null),setTimeout(()=>{I(null),m(z)},2e3),setTimeout(()=>{i(c.filter(We=>We._id!==z)),De.data.type==="task-approved"&&o([{...Oe,status:"completed"},...l])},5e3)}).catch(De=>{b([De.response.data.success,De.response.data.message]),u(null),setTimeout(()=>{I(null),m(z)},2e3)})},V=t.useMemo(()=>{const z=ue=>ue.filter(ne=>{const ve=v?ne.layer_related_id===v:!0,Oe=M?ne.repository_related_id===M:!0,De=W?ne.contributors.filter(We=>We._id===W).length>0:!0;return ve&&Oe&&De});switch(G){case"completed":return z(l);case"approval":return z(c);default:return[...l,...c]}},[l,c,v,M,W,G]);return t.useEffect(()=>{f&&y&&j&&H(y,j)},[f,y,j,H]),e.jsxs("div",{className:"flex flex-col  flex-grow px-7 h-full",children:[e.jsxs("div",{className:"flex justify-between h-[70px]",children:[e.jsxs("div",{className:"flex space-x-4 items-center h-full",children:[e.jsxs(Ie,{size:"small",value:G,onChange:z=>oe(z.target.value),sx:{width:140},MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},children:[e.jsx(J,{value:"completed",children:"Completed"}),e.jsx(J,{value:"approval",children:"Waiting for approval"})]}),e.jsx(Xe,{size:"small",options:a,getOptionLabel:z=>z.label,onChange:(z,ue)=>{P(ue==null?void 0:ue.value),ae(ue==null?void 0:ue.label)},renderInput:z=>e.jsx(Q,{...z,label:"Layer"}),onInputChange:(z,ue,ne)=>{ne!=="reset"&&(P(ue),ae(ue))},inputValue:ge||"",sx:{width:120}}),e.jsx(Xe,{size:"small",options:s,getOptionLabel:z=>z.label,onChange:(z,ue)=>{B(ue==null?void 0:ue.value),ee(ue==null?void 0:ue.label)},onInputChange:(z,ue,ne)=>{ne!=="reset"&&(B(ue),ee(ue))},inputValue:le||"",renderInput:z=>e.jsx(Q,{...z,label:"Repository"}),sx:{width:140}}),e.jsx(Q,{size:"small",label:"User ID",value:W,onChange:z=>q(z.target.value),sx:{width:120}})]}),e.jsx("div",{className:"flex h-full items-center",children:e.jsxs(Ie,{size:"small",value:g,onChange:z=>d(z.target.value),sx:{width:140},MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},children:[e.jsx(J,{value:"tasks",children:"Tasks"}),e.jsx(J,{value:"commits",children:"Commits"})]})})]}),e.jsx("div",{id:"task-container-scroll",className:"flex flex-col space-y-4 pb-6 flex-grow overflow-y-auto",children:V.length===0?e.jsx("div",{className:"flex flex-col items-center mt-2 border-t-[1px]  border-gray-400  w-full h-full",children:e.jsx("h1",{className:"text-xl mt-[22%] text-gray-400",children:"No Data Available"})}):V.map((z,ue)=>e.jsxs(jt,{expanded:f===z._id,ref:ne=>h.current[z._id]=ne,children:[e.jsx("div",{className:"flex w-full",children:e.jsxs("div",{className:"w-full p-4 rounded shadow-lg bg-white hover:bg-gray-100 transition-colors border-[1px] border-blue-500",children:[e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsx("h3",{className:"text-lg font-bold text-blue-600",children:z.task_name}),e.jsxs("div",{className:"flex space-x-4",children:[z.status==="approval"&&e.jsx("div",{className:"flex items-center justify-center space-x-1 rounded-extra",children:D===z._id?e.jsx("div",{className:"sweet-loading",children:e.jsx(Bt,{color:"#bbdefb",loading:!0,size:10})}):n===z._id?e.jsx("span",{className:`${x[0]===!0?"text-green-500":"text-red-500"} text-sm font-semibold`,children:x[1]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{A(!0),u(z._id)},className:"flex justify-center items-center w-[55px] bg-red-300 hover:bg-red-500 transition-colors duration-100 h-full rounded-l-extra font-semibold border-[1px] border-black",children:e.jsx($a,{className:"w-7 h-7",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})}),e.jsx("button",{onClick:()=>se(z._id,!0,"completed"),className:"flex justify-center items-center w-[55px] bg-blue-300 hover:bg-blue-500 transition-colors duration-100 h-full rounded-r-extra font-semibold border-[1px] border-black",children:e.jsx(Ea,{className:"w-5 h-5",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})]})}),e.jsx("div",{className:`${z.status==="completed"?"bg-blue-500 text-white":"bg-yellow-200"} rounded-full px-3 py-1 text-sm font-semibold text-black ml-2`,children:e.jsx(Se,{size:24,children:z.status==="completed"?e.jsx(qt,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}):e.jsx(Gt,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})})]})]}),e.jsxs(Fe,{open:Y,onClose:()=>A(!1),children:[e.jsx(Me,{children:"Provide at least one reason to reject the task"}),e.jsx(Re,{children:e.jsx("div",{className:"p-4",children:e.jsx(Q,{size:"small",label:"Reason",variant:"outlined",value:F,onChange:ne=>R(ne.target.value),fullWidth:!0,multiline:!0,rows:4,placeholder:"Provide at least one reason to reject the task"})})}),e.jsxs(ze,{children:[e.jsx(xe,{onClick:()=>{A(!1)},children:"Cancel"}),e.jsx(xe,{onClick:()=>{A(!1),se(k,!1,"pending",[F])},disabled:F.length===0,children:"Send"})]})]}),e.jsx("p",{className:"text-[14px] text-gray-700 line-clamp-2 w-[82%]",children:z.task_description}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("span",{className:"inline-block bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2",children:["#",z.repository_number_task]}),e.jsx("span",{className:`inline-block ${z.type==="open"?"bg-pink-100 text-gray-700":"bg-black text-white"} rounded-full  px-3 py-1 text-[13px] font-semibold mr-2`,children:z.type}),e.jsxs("span",{className:"inline-block bg-yellow-300 rounded-full px-3 py-1 text-sm font-semibold text-black mr-2",children:["Commits: ",z.commits_hashes.length]}),e.jsxs("span",{className:`inline-block ${z.status==="completed"?"bg-blue-500 text-white":"bg-yellow-200 text-black"} rounded-full px-3 py-1 text-sm font-semibold  mr-2`,children:[" ",z.status==="completed"?"Completed":"Waiting for Approval"," "]})]}),e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[z.assigned_to&&z.contributors.filter(ne=>ne._id===z.assigned_to).map((ne,ve)=>e.jsxs("div",{className:"flex items-center space-x-2 mt-[1px]",children:[e.jsx(Te,{alt:ne.username,src:ne.photoUrl||ne.username,sx:{width:20,height:20}}),e.jsx("span",{className:"text-[14px]",children:ne.username})]},ve)),z.assigned_to&&z.contributors.length===0||z.assigned_to&&!z.contributors.some(ne=>ne._id!==z.assigned_to)?null:!z.assigned_to&&z.contributors.length===0?e.jsx("span",{className:"text-[12px]",children:"No contributors yet"}):e.jsxs("div",{className:"flex space-x-2 items-center pt-[2px]",children:[z.assigned_to&&e.jsx("span",{className:"text-[15px] text-black",children:"·"}),!z.assigned_to&&e.jsx("span",{className:"text-sm",children:"Contributors:"}),e.jsx(ai,{collaborators:z.contributors})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(he,{title:"Copy Task ID",arrow:!0,placement:"left",children:e.jsx(bs,{onClick:()=>navigator.clipboard.writeText(z._id),className:"w-5 h-5 cursor-pointer hover:text-blue-500 transition-colors duration-200 ease-in-out transform active:translate-y-[2px]",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})}),e.jsx(ws,{onClick:()=>Z(z._id),className:"w-5 h-5 cursor-pointer hover:text-blue-500 transition-colors duration-200 ease-in-out transform active:translate-y-[2px]",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx(_t,{onClick:()=>de(z._id,z.layer_related_id,z.repository_related_id),className:"w-5 h-5 cursor-pointer mr-2 hover:text-blue-500 transition-colors duration-200",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})]}),e.jsx(O,{infoDialogOpen:_[z._id],setInfoDialogOpen:()=>pe(z._id),description:z.task_description,goals:z.goals})]})]},ue)}),e.jsx(bt,{children:e.jsx("div",{className:"flex justify-between mt-2 w-full h-[250px]",children:E?e.jsx(Tt,{}):e.jsxs("div",{className:"flex justify-between w-full p-2 h-full overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col p-2 px-8 rounded-lg space-y-6 ",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h2",{className:"font-bold text-2xl text-blue-600 flex items-center",children:" Task Details"}),e.jsx("h3",{className:"text-sm ml-1",children:z._id})]}),e.jsxs("div",{className:"flex flex-col ",children:[e.jsxs("div",{className:"flex space-x-2 items-center ",children:[e.jsx(Ht,{})," ",e.jsx("span",{className:"text-lg font-semibold",children:S==null?void 0:S.name})," "]}),e.jsxs("div",{className:"text-[13px] ml-6",children:[S==null?void 0:S._id," "]}),e.jsx("div",{children:" "})]}),e.jsxs("div",{className:"flex flex-col ",children:[e.jsxs("div",{className:"flex space-x-2 items-center ",children:[e.jsx(wt,{})," ",e.jsx("span",{className:"text-lg font-semibold",children:L==null?void 0:L.name})," "]}),e.jsx("div",{className:"text-[13px] ml-6",children:L==null?void 0:L._id})]})]}),e.jsxs("div",{className:"flex flex-grow space-x-6 justify-center",children:[e.jsxs("div",{className:"flex flex-col bg-gray-50 shadow-lg p-4 w-[200px] rounded-lg space-y-3 border-[1px] border-gray-400",children:[e.jsx("div",{className:"text-sm font-semibold flex items-center",children:" Commits:"}),e.jsx("ul",{className:"list-disc pl-5 max-h-[180px] overflow-y-auto",children:z.commits_hashes.length===0?e.jsx("li",{className:"text-sm",children:"No commits yet"}):z.commits_hashes.map((ne,ve)=>e.jsx("li",{className:"text-sm w-[140px]",children:e.jsx("span",{className:"truncate block w-full cursor-pointer hover:text-yellow-500 transition-colors duration-100",children:ne})},ve))})]}),e.jsxs("div",{className:"flex flex-col bg-gray-50 shadow-lg p-4 w-[200px] rounded-lg space-y-3 border-[1px] border-gray-400",children:[e.jsx("h4",{className:"text-sm font-semibold flex items-center",children:z.additional_info.notes.length===0?"Goals:":"Notes:"}),e.jsx("ul",{className:"list-disc pl-5 max-h-[180px] overflow-y-auto",children:z.additional_info.notes.length===0||z.status==="pending"?z.goals.map((ne,ve)=>e.jsx("li",{className:"text-sm break-words max-w-[200px]",children:ne},ve)):z.additional_info.notes.map((ne,ve)=>e.jsx("li",{className:"text-sm break-words max-w-[200px]",children:ne},ve))})]}),e.jsxs("div",{className:"flex flex-row space-x-4 ",children:[e.jsxs("div",{className:"bg-gray-50 shadow-lg p-4 rounded-lg w-[150px] border-[1px] border-gray-400",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Estimated Hours:"}),e.jsxs("h6",{className:"text-sm",children:[z.additional_info.estimated_hours,"h"]}),z.status!=="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm font-semibold mt-2",children:"Actual Hours:"}),e.jsxs("h6",{className:"text-sm",children:[z.additional_info.actual_hours,"h"]})]})]}),e.jsxs("div",{className:"bg-gray-50 shadow-lg p-4  pr-8 w-[150px] rounded-lg flex flex-col border-[1px] border-gray-400",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Contributors:"}),e.jsx("div",{className:"flex flex-wrap gap-1 max-w-[104px] max-h-[180px] overflow-y-auto mt-2",children:z.contributors.map((ne,ve)=>e.jsx(Te,{alt:ne.username,src:ne.photoUrl||ne.username,sx:{width:20,height:20}},ve))})]})]})]})]})})})]},z._id))})]})},ca="http://localhost:3000/api",ri=({projectLayers:a,projectRepositories:s,commits:l,setRender:o,render:c})=>{const i=t.useRef({}),{layers:d,repositories:g}=te(v=>v.platypus),[h,f]=t.useState(!0),[r,S]=t.useState(null),[T,L]=t.useState(null),[C,y]=t.useState(null),[N,j]=t.useState(null),[p,x]=t.useState(null),[b,n]=t.useState(null),[m,k]=t.useState(null),[u,D]=t.useState(null),[I,F]=t.useState(null),[R,Y]=t.useState(null),[A,_]=t.useState(null),$=(v,P,M)=>{const B=r===v;S(B?null:v),L(B?null:P),y(B?null:M),B||setTimeout(()=>{const W=i.current[v],q=document.querySelector("#container-scroll");if(W&&q){const G=q.getBoundingClientRect(),ge=W.getBoundingClientRect().top-G.top+q.scrollTop;q.scrollTo({top:ge,behavior:"smooth"})}},0)},E=t.useCallback((v,P)=>{f(!0);const M=d.filter(G=>G._id===v),B=g.filter(G=>G._id===P),W=`${ca}/repos/${P}`,q=`${ca}/layer/get-layer/${v}`;!M[0]&&!B[0]?U.all([U.get(W,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}),U.get(q,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}})]).then(U.spread((G,oe)=>{x(G.data.repo),j(oe.data.layer),f(!1)})):M[0]&&!B?U.get(W,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}).then(G=>{console.log("Respuesta desde el thunk R:",G),x(G.data.repo),j(M[0]),f(!1)}):!M&&B[0]?U.get(q,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}).then(G=>{j(G.data.layer),x(B[0]),f(!1)}):(j(M[0]),x(B[0]),f(!1))},[d,g]),w=t.useMemo(()=>l?(P=>P.filter(M=>{const B=A?M.layer===A:!0,W=u?M.repository===u:!0,q=I?M.author.uid===I:!0,G=R?M.uuid===R:!0;return B&&W&&q&&G}))(l):[],[l,A,u,I,R]);return t.useEffect(()=>{r&&T&&C&&E(T,C)},[r,T,C,E]),e.jsxs("div",{className:"flex flex-col  flex-grow px-7 h-full overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between h-[70px]",children:[e.jsxs("div",{className:"flex space-x-4 items-center h-full",children:[e.jsx(Xe,{size:"small",options:a,getOptionLabel:v=>v.label,onChange:(v,P)=>{_(P==null?void 0:P.value),k(P==null?void 0:P.label)},renderInput:v=>e.jsx(Q,{...v,label:"Layer"}),onInputChange:(v,P,M)=>{M!=="reset"&&(_(P),k(P))},inputValue:m||"",sx:{width:120}}),e.jsx(Xe,{size:"small",options:s,getOptionLabel:v=>v.label,onChange:(v,P)=>{D(P==null?void 0:P.value),n(P==null?void 0:P.label)},onInputChange:(v,P,M)=>{M!=="reset"&&(D(P),n(P))},inputValue:b||"",renderInput:v=>e.jsx(Q,{...v,label:"Repository"}),sx:{width:140}}),e.jsx(Q,{size:"small",label:"User ID",value:I,onChange:v=>F(v.target.value),sx:{width:120}}),e.jsx(Q,{size:"small",label:"Hash",value:R,onChange:v=>Y(v.target.value),sx:{width:120}})]}),e.jsx("div",{className:"flex h-full items-center",children:e.jsxs(Ie,{size:"small",value:c,onChange:v=>o(v.target.value),sx:{width:140},MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},children:[e.jsx(J,{value:"tasks",children:"Tasks"}),e.jsx(J,{value:"commits",children:"Commits"})]})})]}),e.jsx("div",{id:"container-scroll",className:"flex flex-col space-y-4 pb-6 flex-grow max-h-[750px] overflow-y-auto",children:w.length===0?e.jsx("div",{className:"flex flex-col items-center mt-2 border-t-[1px]  border-gray-400  w-full h-full",children:e.jsx("h1",{className:"text-xl mt-[22%] text-gray-400",children:"No Data Available"})}):w.map(v=>e.jsxs(jt,{expanded:r===v.uuid,onChange:()=>S(r===v.uuid?null:v.uuid),ref:P=>i.current[v.uuid]=P,children:[e.jsx("div",{className:"flex w-full p-4 rounded shadow-lg  bg-white hover:bg-gray-100 transition-colors border-[1px] border-yellow-300",children:e.jsxs("div",{className:"flex flex-col justify-between w-full",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h3",{className:"text-sm font-semibold text-yellow-600 truncate",title:v.uuid,children:v.uuid}),e.jsxs("span",{className:"text-gray-600 text-sm",children:["Committed on ",new Date(v.createdAt).toLocaleDateString()]})]}),e.jsx("h2",{className:"text-lg font-bold text-gray-800",children:v.message})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx(Te,{alt:v.author.name,src:v.author.photoUrl||v.author.name,sx:{width:24,height:24}}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:v.author.name})]}),e.jsx("button",{onClick:()=>$(v.uuid,v.layer,v.repository),className:"mr-3",children:e.jsx(Se,{size:24,children:e.jsx(_t,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})})]})]})}),e.jsx(bt,{children:e.jsx("div",{className:"rounded-lg max-h-[160px]",children:h?e.jsx(Tt,{}):e.jsxs("div",{className:"flex p-4 justify-between",children:[e.jsxs("div",{className:"flex flex-col space-y-4 ",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h4",{className:"font-bold text-xl text-yellow-600",children:"Commit Details"}),e.jsx("p",{className:"text-sm text-gray-800",children:v.uuid})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h4",{className:"text-sm font-bold",children:"Commit Message"}),e.jsxs("p",{className:"text-sm max-w-[300px] max-h-[40px] overflow-y-auto break-words text-gray-800",children:['"',v.message,'"']})]})]}),e.jsxs("div",{className:"flex space-x-16 pr-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h5",{className:"text-md font-semibold",children:"Layer Information"}),e.jsx("p",{className:"text-sm truncate w-[150px] text-pink-500",children:(N==null?void 0:N.name)||"Layer name not available"}),e.jsx("p",{className:"text-xs text-gray-600",children:(N==null?void 0:N._id)||"ID not available"})]}),e.jsxs("div",{className:"flex flex-col ",children:[e.jsx("h5",{className:"text-md font-semibold",children:"Repository Information"}),e.jsx("p",{className:"text-sm truncate w-[150px] text-green-500",children:(p==null?void 0:p.name)||"Repository name not available"}),e.jsx("p",{className:"text-xs text-gray-600",children:(p==null?void 0:p._id)||"ID not available"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h5",{className:"text-md font-semibold",children:"Associated Task"}),e.jsx("p",{className:"text-sm truncate w-[150px] text-blue-500",children:typeof(v==null?void 0:v.associated_task)=="object"&&(v==null?void 0:v.associated_task)!==null?v.associated_task.task_name:"No associated Task"}),e.jsx("p",{className:"text-xs text-gray-600",children:typeof(v==null?void 0:v.associated_task)=="object"&&(v==null?void 0:v.associated_task)!==null?v.associated_task._id:null})]}),e.jsxs("div",{className:"flex flex-col space-y-2 ",children:[e.jsx("h5",{className:"text-md font-semibold",children:"Committed By"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Te,{alt:v.author.name,src:v.author.photoUrl||v.author.name,sx:{width:24,height:24}}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:v.author.name})]})]})]})]})})})]},v.uuid))})]})},oi=()=>{var k;const s=(k=ye().state)==null?void 0:k.projectId,{uid:l}=te(u=>u.auth),{currentProject:o,repositories:c,layers:i}=te(u=>u.platypus),[d,g]=t.useState("tasks"),[h,f]=t.useState([]),[r,S]=t.useState([]),{fetchData:T,isLoading:L,tasksCompleted:C,setTasksCompleted:y,wFApprovalTasks:N,setWFApprovalTasks:j,commits:p,errorMessage:x,errorWhileFetching:b,errorType:n}=si(o,l);t.useEffect(()=>{f(i.map(u=>({label:u.name,value:u._id}))),S(c.map(u=>({label:u.name,value:u._id})))},[i,c,s]);const m=()=>{switch(d){case"tasks":return e.jsx(ia,{projectLayers:h,projectRepositories:r,tasksCompleted:C,setTasksCompleted:y,wFApprovalTasks:N,setWFApprovalTasks:j,setRender:g,render:d});case"commits":return e.jsx(ri,{projectLayers:h,projectRepositories:r,commits:p,setRender:g,render:d});default:return e.jsx(ia,{projectLayers:h,projectRepositories:r,tasksCompleted:C,setTasksCompleted:y,wFApprovalTasks:N,setWFApprovalTasks:j,setRender:g,render:d})}};return b?e.jsxs("div",{className:"flex flex-col flex-grow items-center justify-center",children:[e.jsx("h1",{className:"text-xl text-red-500",children:x}),n!=="collaborator-validation"&&n!=="token-validation"?e.jsx("button",{onClick:T,className:"hover:text-blue-500 transition-colors duration-100",children:"Try Again"}):null]}):e.jsx("div",{className:"flex flex-col  w-full h-full",children:L?e.jsx("div",{className:"flex flex-grow items-center justify-center",children:e.jsx(Ce,{color:"#32174D",size:50})}):m()})},zt="http://localhost:3000/api",li=a=>{const[s,l]=t.useState(null),[o,c]=t.useState([]),[i,d]=t.useState([]),[g,h]=t.useState(!0),[f,r]=t.useState(!0),[S,T]=t.useState(null),[L,C]=t.useState(null),[y,N]=t.useState(!1),[j,p]=t.useState(null),[x,b]=t.useState(!1),[n,m]=t.useState(new Date),[k,u]=t.useState(()=>{const _=new Date;return _.setMonth(_.getMonth()-3),_}),D=()=>{u(_=>{const $=new Date(_);return $.setMonth($.getMonth()-3),$}),m(_=>{const $=new Date(_);return $.setMonth($.getMonth()-3),$})},I=()=>{u(_=>{const $=new Date(_);return $.setMonth($.getMonth()+3),$}),m(_=>{const $=new Date(_);return $.setMonth($.getMonth()+3),$})},F=()=>{r(!0);const _=`${zt}/users/project-timeline-activity/${s==null?void 0:s.pid}`;U.get(_,{params:{uid:a,startDate:k,endDate:n}}).then($=>{d($.data),r(!1)}).catch($=>{b(!0),p($.response.data.message||"An error occurred while fetching the data"),r(!1)})},R=()=>{h(!0);const _=`${zt}/projects/get-projects/${a}`;U.get(_).then($=>{console.log($),c($.data),h(!1)}).catch($=>{N(!0),C($.response.data.message||"An error occurred while fetching the data"),h(!1)})},Y=()=>{r(!0);const _=`${zt}/users/timeline-activity/${a}`;U.get(_,{params:{startDate:k,endDate:n}}).then($=>{d($.data),r(!1)}).catch($=>{b(!0),p($.response.data.message||"An error occurred while fetching the data"),r(!1)})},A=()=>{U.get(`${zt}/users/get-followers-length/${a}`).then(_=>{T(_.data.followersLength)}).catch(_=>{console.log(_)})};return t.useEffect(()=>{R(),A()},[]),t.useEffect(()=>{s||Y()},[k,n,s]),t.useEffect(()=>{s&&F()},[k,n,s]),{timelineData:i,projects:o,followersLength:S,selected:s,setSelected:l,endDate:n,startDate:k,handlePrevious:D,handleNext:I,fetchingProjects:g,fetchingTimelineData:f,projectsErrorMessage:L,projectsErrorWhileFetching:y,timelineErrorMessage:j,timelineErrorWhileFetching:x}},ni=({projects:a,selected:s,setSelected:l})=>{const o=Ee(),c=(d,g=2)=>d.length<=g?d:[...d.slice(0,g),`+${d.length-g}`],i=({projectName:d,projectID:g})=>e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("h1",{className:"text-lg font-semibold hover:underline cursor-pointer",onClick:()=>{o(`/projects/${we(d)}`,{state:{project:{ID:g,name:d}}})},children:d})});return e.jsx(e.Fragment,{children:a.map((d,g)=>e.jsxs("div",{onClick:()=>{l({pid:d.pid,name:d.name})},className:`flex space-x-2 justify-between py-5 px-2 hover:bg-blue-100 
                      transition-colors duration-100 cursor-pointer ${s&&s.pid===d.pid?"bg-blue-100":""}
                      ${g!==a.length-1?"border-b border-gray-400":""}`,children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("div",{className:"border-[1px] border-gray-400 rounded-lg min-w-[80px] h-[80px] w-[80px]",style:{backgroundImage:`url(${ft})`,backgroundSize:"cover"}}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(i,{projectName:d.name,projectID:d.pid}),e.jsx("p",{className:"text-sm line-clamp-2",children:d.description}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:c(d.tags).map((h,f)=>h.startsWith("+")?e.jsx("span",{className:"text-xs text-gray-500",children:h},f):e.jsx(ot,{label:h,size:"small",variant:"outlined",style:{borderColor:"rgba(0, 0, 0, 0.5)",fontSize:"0.75rem"}},f))})]})]}),e.jsxs("p",{className:"flex text-[12px]",children:[d.praises||0," ",e.jsx(_a,{className:"ml-2 w-4 h-4",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})]})]},d.pid))})},Ut="http://localhost:3000/api",ii=a=>{const[s,l]=t.useState(!0),[o,c]=t.useState(!1),[i,d]=t.useState(!1),[g,h]=t.useState(!1),[f,r]=t.useState(0),[S,T]=t.useState(0),[L,C]=t.useState(0),[y,N]=t.useState([]),[j,p]=t.useState([]),[x,b]=t.useState([]),[n,m]=t.useState(0),[k,u]=t.useState(0),[D,I]=t.useState(0),[F,R]=t.useState(0),[Y,A]=t.useState(0),[_,$]=t.useState(0),[E,w]=t.useState(new Map),[v,P]=t.useState(null),[M,B]=t.useState(!1),W=()=>{d(!0),U.get(`${Ut}/users/get-flly/${a}?page=${D}`).then(le=>{const{following:ee}=le.data;oe(ee,"following"),p([...j,...ee]),l(!1)}).catch(()=>{l(!1)})},q=()=>{c(!0),U.get(`${Ut}/users/get-fll/${a}?page=${k}`).then(le=>{const{followers:ee}=le.data;N([...y,...ee]);const K=ee.filter(fe=>fe.mutualFollow);oe(K,"followers"),c(!1)}).catch(()=>{c(!1)})},G=()=>{h(!0),U.get(`${Ut}/users/get-friends/${a}?page=${n}`).then(le=>{const{friends:ee}=le.data;b([...x,...ee]),h(!1)}).catch(()=>{h(!1)})},oe=(le,ee)=>{const K=new Map(E);switch(ee){case"followers":le.forEach(fe=>{K.set(fe.followerId.uid,!0)});break;case"following":le.forEach(fe=>{K.set(fe.uid.uid,!0)});break}w(K)},ge=le=>{const ee=new Map;le.forEach(K=>{ee.set(K.uid.uid,!0)}),w(ee)},ae=()=>{U.get(`${Ut}/users/get-fll-flly-friends/${a}`).then(le=>{const{followers:ee,following:K,friends:fe,followersLength:re,followingLength:de,friendsLength:Z,totalFollowersPages:pe,totalFollowingPages:O,totalFriendsPages:H}=le.data;N(ee),p(K),b(fe),l(!1),ge(K),A(pe),$(O),R(H),u(1),I(1),m(1),r(re),T(de),C(Z)}).catch(le=>{l(!1),B(!0),P(le.response.data.message||"An error occurred while fetching the data")})};return t.useEffect(()=>{k>1&&q()},[k]),t.useEffect(()=>{D>1&&W()},[D]),t.useEffect(()=>{n>1&&G()},[n]),t.useEffect(()=>{ae()},[]),{fetchingUsers:s,fetchingMoreFollowers:o,fetchingMoreFollowing:i,fetchingMoreFriends:g,followers:y,following:j,friends:x,followingMap:E,setFollowingMap:w,setFollowing:p,setFriends:b,totalFollowersPages:Y,totalFollowingPages:_,totalFriendsPages:F,FollowingPage:D,FollowersPage:k,FriendsPage:n,setFollowingPage:I,setFollowersPage:u,setFriendsPage:m,followersLength:f,followingLength:S,friendsLength:L,setfollowersLength:r,setfollowingLength:T,setfriendsLength:C,errorMessage:v,errorWhileFetching:M}},da="http://localhost:3000/api",ci=({isFollowersModalOpen:a,setIsFollowersModalOpen:s})=>{const[l,o]=t.useState(null),{uid:c,username:i,photoUrl:d}=te(O=>O.auth),{fetchingUsers:g,fetchingMoreFollowers:h,fetchingMoreFollowing:f,fetchingMoreFriends:r,followers:S,following:T,friends:L,followingMap:C,setFollowingMap:y,setFollowing:N,setFriends:j,followersLength:p,followingLength:x,friendsLength:b,setfollowingLength:n,setfriendsLength:m,totalFollowersPages:k,totalFollowingPages:u,totalFriendsPages:D,FollowingPage:I,FollowersPage:F,FriendsPage:R,setFollowingPage:Y,setFollowersPage:A,setFriendsPage:_,errorMessage:$,errorWhileFetching:E}=ii(c),[w,v]=t.useState(""),[P,M]=t.useState("followers"),[B,W]=t.useState("followers"),q=t.useRef(null),G=Ee(),oe=()=>{const O=document.getElementById("followersModal");O&&(O.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{s(!1)},500))},ge=(O,H,se)=>{const V=new Map(C);V.set(O,!1),y(V),H==="friendship"?(j(L.filter(z=>z._id!==se)),N(T.filter(z=>z.uid.uid!==O)),n(x-1),m(b-1),o(null)):(N(T.filter(z=>z.uid.uid!==O)),n(x-1),o(null))},ae=(O,H,se,V)=>{const z=new Map(C);z.set(O,!0),y(z),H==="friendship"?(j([V,...L]),N([{...se,mutualFollow:!0},...T]),n(x+1),m(b+1),o(null)):(N([{...se,mutualFollow:!1},...T]),n(x+1),o(null))},le=O=>{C.get(O)?fe(O):K(O)},ee=O=>{const{ids:H,createdAt:se}=O;return{...H.filter(z=>z.uid!==c)[0],createdAt:se}},K=O=>{U.post(`${da}/users/follow-profile`,{profileUID:O,uid:c,username:i,photoUrl:d}).then(H=>{const{followedProfile:se,friendship:V,type:z}=H.data;ae(O,z,se,V)}).catch(()=>{o(null)})},fe=O=>{U.delete(`${da}/users/unfollow-profile/${O}`,{params:{uid:c}}).then(H=>{ge(O,H.data.type,H.data.friendshipRef)}).catch(()=>{o(null)})},re=O=>{switch(O){case"followers":return p;case"following":return x;case"friends":return b;default:return 0}},de=()=>{const O=q.current;O&&(O.scrollTop=0)},Z=O=>{switch(O){case"followers":return pe.length>0?pe.map((H,se)=>e.jsxs("div",{className:"flex space-x-4 w-full items-center border-b-2 py-3 px-3 hover:bg-gray-200 transition-colors duration-200 cursor-pointer",onClick:()=>G(`/profile/${we(H.username)}`,{state:{user:{uid:H.uid,username:H.username}}}),children:[e.jsxs("div",{className:"flex space-x-4 w-[85%]  h-full items-center",children:[e.jsx("img",{src:H.photoUrl||Ye(H.username),alt:"profile",className:"w-10 h-10 rounded-full cursor-pointer"}),e.jsxs("h4",{className:"",children:[e.jsx("span",{className:"font-semibold",children:"@"}),H.username]})]}),e.jsx("button",{disabled:l===H.uid,onClick:V=>{V.stopPropagation(),o(H.uid),le(H.uid)},className:"py-[10px] text-[13px] text-white w-[15%] rounded-xl h-full bg-black border-[1px] border-gray-400 transition-all duration-150 ease-in-out transform active:translate-y-[2px]",children:C.get(H.uid)?"Unfollow":"Follow Back"})]},se)):e.jsx("div",{className:"flex w-full h-full  items-center justify-center",children:e.jsx("p",{children:"No followers"})});case"following":return pe.length>0?pe.map((H,se)=>e.jsxs("div",{className:"flex space-x-4 w-full items-center border-b-2 py-3 px-3 hover:bg-gray-200 transition-colors duration-200 cursor-pointer",onClick:()=>G(`/profile/${we(H.username)}`,{state:{user:{uid:H.uid,username:H.username}}}),children:[e.jsxs("div",{className:"flex space-x-4 w-[85%]  h-full items-center",children:[e.jsx("img",{src:H.photoUrl||Ye(H.username),alt:"profile",className:"w-10 h-10 rounded-full cursor-pointer"}),e.jsxs("h4",{children:[e.jsx("span",{className:"font-semibold",children:"@"}),H.username]})]}),e.jsx("button",{disabled:l===H.uid,onClick:V=>{V.stopPropagation(),o(H.uid),le(H.uid)},className:"py-[10px] text-[13px] text-white w-[15%] rounded-xl h-full bg-black border-[1px] border-gray-400 transition-all duration-150 ease-in-out transform active:translate-y-[2px]",children:C.get(H.uid)?"Unfollow":"Follow"})]},se)):e.jsx("div",{className:"flex w-full h-full  items-center justify-center",children:e.jsx("p",{children:"No following"})});case"friends":return pe.length>0?pe.map((H,se)=>e.jsxs("div",{className:"flex space-x-4 w-full items-center border-b-2 py-3 px-3 hover:bg-gray-200 transition-colors duration-200 cursor-pointer",onClick:()=>G(`/profile/${we(H.username)}`,{state:{user:{uid:H.uid,username:H.username}}}),children:[e.jsxs("div",{className:"flex space-x-4 w-[80%]  h-full items-center ",children:[e.jsx("img",{src:H.photoUrl||Ye(H.username),alt:"profile",className:"w-10 h-10 rounded-full cursor-pointer"}),e.jsxs("h4",{children:[e.jsx("span",{className:"font-semibold",children:"@"}),H.username]})]}),e.jsxs("p",{className:"text-[13px] font-semibold",children:["Since ",e.jsx("span",{children:new Date(H.createdAt).toLocaleDateString()})]})]},se)):e.jsx("div",{className:"flex w-full h-full  items-center justify-center",children:e.jsx("p",{children:"No friends"})})}},pe=t.useMemo(()=>{let O=[];return B==="followers"?O=S.map(H=>H.followerId):B==="following"?O=T.map(H=>H.uid):B==="friends"&&(O=L.map(H=>ee(H))),O.filter(H=>H.username.toLowerCase().includes(w.toLowerCase()))},[w,S,T,L,B]);return t.useEffect(()=>{if(a){const O=setTimeout(()=>{var H,se;(H=document.getElementById("followersModal"))==null||H.classList.remove("opacity-0"),(se=document.getElementById("followersModal"))==null||se.classList.add("opacity-100")},20);return()=>clearTimeout(O)}},[a]),t.useEffect(()=>{if(a){const O=()=>{const se=q==null?void 0:q.current;se&&se.scrollTop+se.clientHeight>=se.scrollHeight-5&&(B==="followers"&&F<k&&!h?A(V=>V+1):B==="following"&&I<u&&!f?Y(V=>V+1):B==="friends"&&R<D&&!r&&_(V=>V+1))},H=q.current;return H&&H.addEventListener("scroll",O),()=>{H&&H.removeEventListener("scroll",O)}}},[a,B,F,I,R,k,u,D,h,f,r]),e.jsx("div",{className:"fixed flex w-screen h-full pb-5 top-0 right-0 justify-center items-center bg-black/30 z-50",children:e.jsxs("div",{id:"followersModal",className:`flex flex-col space-y-3 w-[70%] md:w-[50%] md:max-h-[635px] md:h-[635px] overflow-hidden items-center rounded-2xl bg-white glassi border-[1px] border-gray-400 transition-opacity duration-300 ease-in-out opacity-0 ${a?"":"pointer-events-none"}`,children:[e.jsxs("div",{className:"flex justify-between w-[95%] h-12 ml-auto mr-auto mt-2 p-2",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:[e.jsxs("span",{children:[" ",dt(re(P))," "]}),"  ",xt(P)]}),e.jsx("button",{onClick:oe,children:e.jsx($e,{})})]}),e.jsxs("div",{className:"flex flex-col w-full h-full",children:[e.jsxs("div",{className:"flex w-[92%] mx-auto h-11 border-b-2",children:[e.jsx("button",{onClick:()=>{de(),M("friends"),W("friends")},className:` ${P==="friends"?"bg-gray-200":""} flex w-1/2 justify-center items-center  text-center text-sm hover:bg-gray-200 transition-colors duration-200 `,children:e.jsx("h4",{children:"Friends"})}),e.jsx("button",{onClick:()=>{de(),M("following"),W("following")},className:` ${P==="following"?"bg-gray-200":""} flex w-1/2 justify-center items-center text-center text-sm hover:bg-gray-200 transition-colors duration-200`,children:e.jsx("h4",{children:"Following"})}),e.jsx("button",{onClick:()=>{de(),M("followers"),W("followers")},className:` ${P==="followers"?"bg-gray-200":""} flex w-1/2 justify-center items-center text-center text-sm hover:bg-gray-200 transition-colors duration-200`,children:e.jsx("h4",{children:"Followers"})})]}),e.jsxs("div",{className:"flex flex-grow space-y-4 flex-col w-full h-full overflow-y-auto  pt-5 px-8",children:[e.jsx(Q,{variant:"outlined",label:"Search",size:"small",className:"w-full",value:w,onChange:O=>v(O.target.value)}),e.jsxs("div",{ref:q,id:"renderPAreaFollowers",className:"flex flex-col flex-grow  overflow-y-auto max-h-[445px]",children:[e.jsx("div",{className:"flex flex-col flex-grow",children:g?e.jsx("div",{className:"flex w-full h-full items-center justify-center",children:e.jsx(_e,{color:"#000",loading:g})}):E?e.jsx("div",{className:"flex w-full h-full items-center justify-center",children:e.jsx("p",{children:$})}):Z(P)}),h||f||r&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(_e,{color:"#000",loading:!0,className:"w-8 h-8"})})]})]})]})]})})},di="http://localhost:3000/api",xi=ut().shape({website:Ne().url("Invalid URL").matches(/^(https?:\/\/)?([\w-]+(\.[\w-]+)+)\/?/,"Invalid Website URL"),github:Ne().url("Invalid URL").matches(/^(https?:\/\/)?(www\.)?github\.com\/[A-Za-z0-9_-]+\/?/,"Invalid GitHub URL"),linkedin:Ne().url("Invalid URL").matches(/^(https?:\/\/)?(www\.)?linkedin\.com\/in\/[A-Za-z0-9_-]+\/?/,"Invalid LinkedIn URL"),twitter:Ne().url("Invalid URL").matches(/^(https?:\/\/)?(www\.)?twitter\.com\/[A-Za-z0-9_-]+\/?/,"Invalid Twitter URL")}),ui=({isMyLinksModalOpen:a,setIsMyLinksModalOpen:s})=>{const{website:l,github:o,linkedin:c,twitter:i,uid:d}=te(y=>y.auth),[g,h]=t.useState(!1),[f,r]=t.useState(!0),S={website:l,github:o,linkedin:c,twitter:i},T=()=>{const y=document.getElementById("linksModal");y&&(y.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{s(!1)},500))},L=({values:y})=>(t.useEffect(()=>{const N=y.website===S.website&&y.github===S.github&&y.linkedin===S.linkedin&&y.twitter===S.twitter;r(N)},[y]),null),C=(y,{setSubmitting:N})=>{h(!0),N(!0),U.put(`${di}/users/update-my-links/${d}`,y,{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("x-token")}}).then(()=>{X.fire({icon:"success",title:"Your links have been updated!",showConfirmButton:!1,timer:1500}),h(!1),N(!1)}).catch(()=>{X.fire({icon:"error",title:"Oops...",text:"Something went wrong!"})}).finally(()=>{N(!1)})};return t.useEffect(()=>{if(a){const y=setTimeout(()=>{var N,j;(N=document.getElementById("linksModal"))==null||N.classList.remove("opacity-0"),(j=document.getElementById("linksModal"))==null||j.classList.add("opacity-100")},20);return()=>clearTimeout(y)}},[a]),e.jsx("div",{className:"fixed flex w-screen h-full pb-5 top-0 right-0 justify-center items-center bg-black/30 z-50",children:e.jsxs("div",{id:"linksModal",className:`bg-white flex flex-col min-w-[28%] h-[535px] items-center rounded-2xl glass2 border-[1px] border-gray-400 transition-opacity duration-300 ease-in-out opacity-0 ${a?"":"pointer-events-none"}`,children:[e.jsxs("div",{className:"flex justify-between w-[95%] h-12 ml-auto mr-auto mt-2 p-2 border-b-2 border-b-gray-500 px-",children:[e.jsx("p",{className:"text-xl text-black",children:"My Links"}),e.jsx("button",{onClick:T,children:e.jsx($e,{})})]}),e.jsx(st,{validationSchema:xi,initialValues:S,onSubmit:C,children:({values:y,handleChange:N,isSubmitting:j,touched:p,errors:x})=>e.jsxs(at,{className:"flex flex-grow w-full h-full mt-4 px-5",children:[e.jsx(L,{values:y}),g?e.jsx("div",{className:"flex flex-grow justify-center items-center",children:e.jsx(_e,{color:"#0c4a6e"})}):e.jsxs(Nt,{style:{width:"100%",height:"100%"},spacing:2,children:[e.jsxs(Nt,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Aa,{className:"w-20 h-20",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx(Dt,{as:Q,fullWidth:!0,id:"website",name:"website",label:p.website&&x.website?"Invalid Website URL":"Website",variant:"outlined",value:y.website,onChange:N,error:p.website&&!!x.website})]}),e.jsxs(Nt,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Fa,{className:"w-20 h-20",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx(Dt,{as:Q,fullWidth:!0,id:"github",name:"github",label:p.github&&x.github?"Invalid Github URL":"Github",variant:"outlined",value:y.github,onChange:N,error:p.github&&!!x.github})]}),e.jsxs(Nt,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Ma,{className:"w-20 h-20",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx(Dt,{as:Q,fullWidth:!0,id:"linkedin",name:"linkedin",label:p.linkedin&&x.linkedin?x.linkedin:"LinkedIn",variant:"outlined",value:y.linkedin,onChange:N,error:p.linkedin&&!!x.linkedin})]}),e.jsxs(Nt,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(ya,{className:"w-20 h-20"}),e.jsx(Dt,{as:Q,fullWidth:!0,id:"twitter",name:"twitter",label:p.twitter&&x.twitter?"Invalid Twitter URL":"Twitter",variant:"outlined",value:y.twitter,onChange:N,error:p.twitter&&!!x.twitter})]}),e.jsx(Nt,{direction:"row",justifyContent:"flex-end",children:e.jsx("button",{type:"submit",disabled:f||j||Object.keys(x).length>0,className:`text-[14px] w-full h-[55px] rounded-extra ${f||Object.keys(x).length>0?"backdrop-blur-sm":"backdrop-blur-sm bg-green-400/20 shadow-sm"} border-[1px] border-gray-400 transition-colors duration-300 ease-in-out transform active:translate-y-[2px]`,children:"Save Changes"})})]})]})})]})})},hi={project_created:e.jsx(mr,{}),layer_created:e.jsx(Yt,{}),repo_created:e.jsx(pr,{}),task_created:e.jsx(Pa,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),task_review_submission:e.jsx(fr,{}),task_completed:e.jsx(gr,{}),task_contributor_review_submission:e.jsx(Zt,{}),task_contributor_completed:e.jsx(Zt,{}),task_contributor_marked_ready:e.jsx(Zt,{}),commit:e.jsx(jr,{}),commit_with_task:e.jsx(br,{})},mi=a=>{switch(a){case"project_created":return{background:"#e2eafc",color:"#000000"};case"layer_created":return{background:"rgb(255, 179, 198)",color:"#fff"};case"repo_created":return{background:"rgb(16, 204, 82)",color:"#fff"};case"task_created":return{background:"rgb(33, 150, 243)",color:"#fff"};case"task_review_submission":return{background:"rgb(0, 123, 255)",color:"#fff"};case"task_completed":return{background:"rgb(40, 167, 69)",color:"#fff"};case"task_contributor_review_submission":return{background:"rgb(255, 193, 7)",color:"#fff"};case"task_contributor_completed":return{background:"rgb(23, 162, 184)",color:"#fff"};case"task_contributor_marked_ready":return{background:"rgb(108, 117, 125)",color:"#fff"};case"commit":return{background:"rgb(255, 165, 0)",color:"#fff"};case"commit_with_task":return{background:"rgb(102, 16, 242)",color:"#fff"};default:return{background:"rgb(0, 0, 0)",color:"#fff"}}},pi=a=>{switch(a){case"project_created":return e.jsx("h3",{className:"vertical-timeline-element-title text-[15px] nav-button text-[#6492ff] font-bold",children:"Project Created"});case"layer_created":return e.jsx("h3",{className:"flex flex-col vertical-timeline-element-title text-[15px] nav-button text-[#ff3f6c] font-bold",children:"Layer Created"});case"repo_created":return e.jsx("h3",{className:"flex flex-col vertical-timeline-element-title text-[15px] nav-button text-green-600 font-bold",children:"Repository Created"});case"task_created":return e.jsx("h3",{className:"flex flex-col vertical-timeline-element-title text-[15px] nav-button text-blue-500 font-bold",children:"Task Created"});case"task_review_submission":return e.jsx("h3",{className:"vertical-timeline-element-title text-[15px] nav-button text-[#007bff] font-bold",children:"Task Review Submission"});case"task_completed":return e.jsx("h3",{className:"vertical-timeline-element-title text-[15px] nav-button text-[#28a745] font-bold",children:"Task Approved"});case"task_contributor_review_submission":return e.jsx("h3",{className:"vertical-timeline-element-title text-[15px] nav-button text-yellow-600 font-bold",children:"Contributions Submitted"});case"task_contributor_completed":return e.jsx("h3",{className:"vertical-timeline-element-title text-[15px] nav-button text-[#17a2b8] font-bold",children:"Contributions Approved"});case"task_contributor_marked_ready":return e.jsx("h3",{className:"vertical-timeline-element-title text-[15px] nav-button text-[#6c757d] font-bold",children:"Contributions Finished"});case"commit":return e.jsx("h3",{className:"vertical-timeline-element-title text-[15px] nav-button text-yellow-600 font-bold",children:"Commit "});case"commit_with_task":return e.jsx("h3",{className:"vertical-timeline-element-title text-[15px] nav-button text-[#8664ff] font-bold",children:"Task Commit"});default:return"Unknown Event"}},fi=(a,s)=>{var l;switch(a){case"project_created":{const o=s;return e.jsxs("div",{className:" nav-button text-[14px] mt-2",children:["You have created a new project: ",e.jsxs("span",{className:"font-semibold text-[#6492ff] text-[14px]",children:[o.name,"."]})]})}case"layer_created":{const o=s;return e.jsxs("div",{className:"nav-button text-[14px] mt-2",children:["You have created a new layer: ",e.jsxs("span",{className:"font-semibold text-[#ff3f6c] text-[14px]",children:[o.name,"."]}),e.jsxs("h4",{className:"text-semibold text-[12px] text-[#6492ff] mt-2",children:["Project: ",e.jsx("span",{className:"font-bold text-black",children:o.project.name})]})]})}case"repo_created":{const o=s;return e.jsxs("div",{className:"nav-button text-[14px] mt-2",children:["You have created a new repository: ",e.jsxs("span",{className:"font-semibold text-green-600 text-[14px]",children:[o.name,"."]}),e.jsxs("h4",{className:"mt-1 text-[12px] text-pink-400",children:["Layer: ",e.jsx("span",{className:"font-bold text-black",children:o.layerID.name})," "]}),e.jsxs("h4",{className:"text-semibold text-[12px] text-[#6492ff]",children:["Project: ",e.jsx("span",{className:"font-bold text-black",children:o.projectID.name})," "]})]})}case"task_created":{const o=s;return e.jsxs("div",{className:"nav-button text-[14px] mt-2",children:["You have created a new task: ",e.jsx("span",{className:"font-semibold text-blue-500 text-[14px]",children:o.task_name})," on  ",e.jsx("span",{className:"font-semibold text-green-600 text-[14px]",children:o.repository_related_id.name})," repository."]})}case"task_review_submission":{const o=s;return e.jsxs("div",{className:"nav-button text-[14px] mt-2",children:["You submitted the assigned task: ",e.jsx("span",{className:"font-semibold text-[#007bff] text-[14px]",children:o.task_name})," on the repository ",e.jsx("span",{className:"font-semibold text-green-600 text-[14px]",children:o.repository_related_id.name})," for review."]})}case"task_completed":{const o=s;return e.jsxs("div",{className:"nav-button text-[14px] mt-2",children:["Your assigned task: ",e.jsx("span",{className:"font-semibold text-blue-500 text-[14px]",children:o.task_name})," on the repository ",e.jsx("span",{className:"font-semibold text-green-600 text-[14px]",children:o.repository_related_id.name}),", has been approved."]})}case"task_contributor_review_submission":{const o=s;return e.jsxs("div",{className:"nav-button text-[14px] mt-2",children:["The task you participated in: ",e.jsx("span",{className:"font-semibold text-blue-500 text-[14px]",children:o.task_name})," on the repository ",e.jsx("span",{className:"font-semibold text-green-600 text-[14px]",children:o.repository_related_id.name}),", has been submitted for review."]})}case"task_contributor_completed":{const o=s;return e.jsxs("div",{className:"nav-button text-[14px] mt-2",children:["The task you participated in: ",e.jsx("span",{className:"font-semibold text-blue-500 text-[14px]",children:o.task_name})," on the repository ",e.jsx("span",{className:"font-semibold text-green-600 text-[14px]",children:o.repository_related_id.name}),", has been approved."]})}case"task_contributor_marked_ready":{const o=s;return e.jsxs("div",{className:"nav-button text-[14px] mt-2",children:["You have marked your contributions ready at the task: ",e.jsx("span",{className:"font-semibold text-blue-500 text-[14px]",children:o.task_name})," on the repository ",e.jsx("span",{className:"font-semibold text-green-600 text-[14px]",children:o.repository_related_id.name}),"."]})}case"commit":{const o=s;return e.jsxs("div",{className:"nav-button text-[14px] mt-2",children:["You committed on repository: ",e.jsxs("span",{className:"font-semibold text-green-600",children:[o.repository.name,"."]}),e.jsxs("h4",{className:"text-sm mt-2",children:["Hash:  ",e.jsx("span",{className:"text-[12px]",children:o.uuid})," "]})]})}case"commit_with_task":{const o=s;return e.jsxs("div",{className:"nav-button text-[14px] mt-2",children:["you committed on task: ",e.jsx("span",{className:"font-semibold text-blue-500 text-[14px]",children:((l=o.associated_task)==null?void 0:l.task_name)||"No task"}),", repository: ",e.jsxs("span",{className:"font-semibold text-green-600 text-[14px]",children:[o.repository.name,"."]}),e.jsxs("h4",{className:"text-sm mt-2",children:["Hash:  ",e.jsx("span",{className:"text-[12px]",children:o.uuid})," "]})]})}default:return""}},gi=()=>{const{uid:a,username:s,photoUrl:l,email:o,followers:c}=te(D=>D.auth),{followersLength:i,projects:d,timelineData:g,selected:h,setSelected:f,timelineErrorMessage:r,timelineErrorWhileFetching:S,projectsErrorMessage:T,projectsErrorWhileFetching:L,endDate:C,startDate:y,fetchingProjects:N,fetchingTimelineData:j,handleNext:p,handlePrevious:x}=li(a),[b,n]=t.useState(!1),[m,k]=t.useState(!1),u=D=>{const I={year:"numeric",month:"long"};return new Date(D).toLocaleDateString("en-US",I)};return e.jsxs("div",{className:"flex min-h-screen h-full w-full p-6 bg-blue-50",children:[m&&e.jsx(ui,{isMyLinksModalOpen:m,setIsMyLinksModalOpen:k}),b&&e.jsx(ci,{isFollowersModalOpen:b,setIsFollowersModalOpen:n}),e.jsxs("div",{className:"flex flex-col w-1/2 space-y-3 ",children:[e.jsxs("div",{className:"flex space-x-4 ",children:[e.jsx("img",{src:l||Ye(s||"N A"),alt:s||"Avatar",className:"rounded-lg w-[100px] h-[100px] object-cover"}),e.jsxs("div",{className:"flex flex-col pt-1",children:[e.jsxs("h1",{className:"text-2xl font-bold nav-button",children:["@",s||"Unknown User"]}),e.jsx("p",{className:"text-black text-sm font-semibold",children:o||"No email"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("p",{className:"text-black text-sm font-semibold",children:[dt(i||c)," ",e.jsx("span",{onClick:()=>n(!0),className:"font-normal cursor-pointer hover:text-gray-700 transition-colors duration-200",children:"followers"})," "]}),e.jsx("p",{onClick:()=>k(!0),className:"ttext-black text-sm cursor-pointer hover:text-gray-700 transition-colors duration-200r",children:"My Links"})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-3 h-full pt-4 ",children:[e.jsx("h2",{className:"font-bold text-xl text-sky-950",children:"Projects"}),e.jsx("div",{className:"flex flex-col flex-grow rounded-xl pr-4 overflow-y-auto ",children:N?e.jsx("div",{className:"flex h-full w-full justify-center items-center",children:e.jsx(_e,{color:"#0c4a6e"})}):L?e.jsx("div",{className:"flex h-full w-full justify-center items-center",children:e.jsx("p",{className:"text-red-500 text-lg",children:T})}):d.length===0?e.jsx("div",{className:"flex h-full w-full justify-center items-center",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"You do not participate or own any project yet."})}):e.jsx(ni,{projects:d,selected:h,setSelected:f})})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2 w-1/2 ",children:[e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("h2",{className:"flex items-center text-center font-bold text-xl text-sky-950 mx-auto",children:[h&&e.jsx("button",{onClick:()=>f(null),children:e.jsx(he,{title:"Go back to general activity",arrow:!0,children:e.jsx(Zr,{className:"w-3 h-3 mr-2 hover:text-slate-500 transition-colors duration-200",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})}),"Timeline",h&&e.jsxs("span",{className:"ml-1 text-sm text-gray-500 font-semibold",children:[" - ",h.name]}),!h&&e.jsx("span",{className:"ml-1 text-sm text-gray-500 font-semibold",children:" - General Activity"})]}),e.jsxs("div",{id:"heatMapOpt",className:"flex w-full h-10 space-x-3 justify-between ",children:[e.jsx("button",{onClick:x,className:"dashboard-buttons hover:bg-[#1f26870e] rounded-l-extra flex items-center justify-center w-[10%] h-8 transition-all duration-300 ease-in-out transform active:translate-y-[2px]",children:e.jsx(Se,{size:22,children:e.jsx(Ca,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})}),e.jsxs("div",{className:"dates text-sm h-8 w-[75%] flex items-center justify-center nav-button",children:[u(y)," - ",u(C)]}),e.jsx("button",{onClick:p,className:"dashboard-buttons hover:bg-[#1f26870e] rounded-r-extra flex items-center justify-center w-[10%] h-8 transition-all duration-300 ease-in-out transform active:translate-y-[2px]",children:e.jsx(Se,{size:22,children:e.jsx(ka,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})})]})]}),e.jsx("div",{className:"flex flex-grow border-gray-400 glassi max-h-[800px] rounded-2xl overflow-y-auto overflow-x-hidden",children:j?e.jsx("div",{className:"flex h-full w-full justify-center items-center",children:e.jsx(_e,{color:"#0c4a6e"})}):S?e.jsx("div",{className:"flex h-full w-full justify-center items-center",children:e.jsx("p",{className:"text-red-500 text-lg",children:r})}):g.length===0?e.jsx("div",{className:"flex h-full w-full justify-center items-center",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"No activity was found between the dates."})}):e.jsx("div",{className:"w-full min-h-[100vh]",children:e.jsx(Ys.VerticalTimeline,{children:g.map((D,I)=>e.jsxs(Ys.VerticalTimelineElement,{date:new Date(D.date).toLocaleString(),icon:hi[D.type],iconStyle:mi(D.type),children:[pi(D.type),fi(D.type,D.data)]},I))})})})]})]})},Et="http://localhost:3000/api",ji=a=>{const{uid:s}=te(x=>x.auth),[l,o]=t.useState(!0),[c,i]=t.useState(null),[d,g]=t.useState(!1),[h,f]=t.useState(null),[r,S]=t.useState(null),[T,L]=t.useState(null),[C,y]=t.useState(null),[N,j]=t.useState({followsMe:!1,iFollow:!1,friendship:!1}),p=x=>{o(!0),U.all([U.get(`${Et}/projects/get-profile-public-projects/${x}`),U.get(`${Et}/projects/get-profile-top-projects/${x}`),U.get(`${Et}/repos/get-top-profile-repos/${x}`),U.get(`${Et}/users/get-profile/${x}`),U.get(`${Et}/users/get-users-relation`,{params:{profileUID:x,uid:s}})]).then(U.spread((b,n,m,k,u)=>{f(b.data.projects),S(n.data.topProjects),L(m.data.topRepos),y(k.data.user),j(u.data),o(!1)})).catch(b=>{var n;i(((n=b==null?void 0:b.response)==null?void 0:n.data.message)||"An error occurred while fetching user data"),g(!0),o(!1)})};return t.useEffect(()=>{p(a.state.user.uid)},[a]),{usersRelation:N,profile:C,topRepos:T,topProjects:r,profileProjects:h,fetchingUserData:l,errorMessage:c,errorWhileFetching:d}},xa="http://localhost:3000/api",bi=({firstTime:a,setFirstTime:s,setTabToRender:l,tabs:o,setTabs:c,active:i,setActive:d,setHovering:g,usersRelation:h,user:f,setIsProfileFollowersModalOpen:r,containerClassName:S,activeTabClassName:T,tabClassName:L})=>{const{uid:C,username:y,photoUrl:N}=te(F=>F.auth),[j,p]=t.useState(h.iFollow||!1),[x,b]=t.useState(h.friendship||!1),n=h.followsMe||!1,m=F=>{switch(F){case"friendship":b(!1),p(!1);break;case"follower":p(!1);break;default:p(!1);break}},k=F=>{switch(F){case"friendship":b(!0),p(!0);break;case"follower":p(!0);break;default:p(!0);break}},u=F=>{U.post(`${xa}/users/follow-profile`,{profileUID:F,uid:C,username:y,photoUrl:N}).then(R=>{k(R.data.type)}).catch(R=>{console.log(R)})},D=F=>{U.delete(`${xa}/users/unfollow-profile/${F}`,{params:{uid:C}}).then(R=>{m(R.data.type)}).catch(R=>{console.log(R)})},I=F=>{const R=[...o],Y=R.splice(F,1);R.unshift(Y[0]),c(R),d(R[0]),l(R[0].value)};return e.jsxs("div",{className:Le("bg-blue-50 absolute top-14 left-8 pb-4 z-10 px-1 flex flex-row justify-between [perspective:1000px] overflow-auto sm:overflow-visible no-visible-scrollbar max-w-full w-[95%]",S),children:[e.jsxs("div",{id:"profile",className:"flex space-x-4 h-full ",children:[e.jsx("img",{src:f.photoUrl||Ye(f.username),alt:f.username,className:"h-[120px] w-[120px] rounded-2xl"}),e.jsxs("div",{className:"flex flex-col pt-1",children:[e.jsxs("h3",{className:"text-2xl",children:["@",f.username]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-semibold",children:dt(f.followers||0)})," ",e.jsx("span",{onClick:()=>r(!0),className:"cursor-pointer hover:text-gray-700 transition-colors duration-200",children:"Followers"})]}),e.jsxs("div",{className:"links  space-y-1  mt-1",children:[e.jsxs("div",{className:"set1 flex space-x-2",children:[(f==null?void 0:f.website)&&e.jsxs("a",{href:f==null?void 0:f.website,target:"_blank",rel:"noreferrer",className:"flex items-center space-x-1",children:[e.jsx(Aa,{className:"w-4 h-4 text-gray-700",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx("span",{className:"text-[13px] text-gray-700",children:"Website"})]}),(f==null?void 0:f.github)&&e.jsxs("a",{href:f==null?void 0:f.github,target:"_blank",rel:"noreferrer",className:"flex items-center space-x-1",children:[e.jsx(Fa,{className:"w-4 h-4 text-gray-700",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx("span",{className:"text-[13px] text-gray-700",children:"Github"})]})]}),e.jsxs("div",{className:"set2 flex space-x-2",children:[(f==null?void 0:f.linkedin)&&e.jsxs("a",{href:f==null?void 0:f.linkedin,target:"_blank",rel:"noreferrer",className:"flex items-center space-x-1",children:[e.jsx(Ma,{className:"w-4 h-4 text-gray-700",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx("span",{className:"text-[13px] text-gray-700",children:"Linkedin"})]}),(f==null?void 0:f.twitter)&&e.jsxs("a",{href:f==null?void 0:f.twitter,target:"_blank",rel:"noreferrer",className:"flex items-center space-x-1",children:[e.jsx(ya,{className:"w-4 h-4 text-gray-700"}),e.jsx("span",{className:"text-[13px] text-gray-700",children:"Twitter"})]})]})]})]})]})]}),e.jsxs("div",{id:"profile-interactive-buttons",className:"flex space-x-8",children:[f.uid===C?e.jsx("p",{className:"text-[13px] text-gray-700",children:"This is your public profile."}):e.jsx("div",{id:"profile-actions",className:"flex space-x-6 justify-center h-full",children:e.jsx("div",{className:"flex flex-col justify-center items-center h-12 mt-1",children:x?e.jsx(he,{title:"Unfollow",placement:"left",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("button",{onClick:()=>D(f.uid),className:"flex items-center justify-center w-10 h-8 rounded-xl glassi border-1 border-black mx-auto hover:bg-blue-300/40 transition-all duration-150 ease-in-out transform active:translate-y-[2px]",children:e.jsx(Se,{children:e.jsx(Kr,{className:"text-green-600",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})}),e.jsx("p",{className:"text-[9px] mx-auto text-center",children:"Friends"})]})}):n?e.jsx(he,{title:"Follow back?",placement:"left",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("button",{onClick:()=>u(f.uid),className:"flex items-center justify-center w-10 h-8 rounded-xl glassi border-1 border-black mx-auto hover:bg-blue-300/40 transition-all duration-150 ease-in-out transform active:translate-y-[2px]",children:e.jsx(Se,{children:e.jsx(Vr,{className:"text-green-600",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})}),e.jsx("p",{className:"text-[9px] mx-auto text-center",children:"Follows you"})]})}):j?e.jsx(he,{title:"Unfollow",placement:"left",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("button",{onClick:()=>D(f.uid),className:"flex items-center justify-center w-10 h-8 rounded-xl glassi border-1 border-black mx-auto hover:bg-blue-300/40 transition-all duration-150 ease-in-out transform active:translate-y-[2px]",children:e.jsx(Se,{children:e.jsx(eo,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})}),e.jsx("p",{className:"text-[9px] mx-auto text-center",children:"Following"})]})}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>u(f.uid),className:"w-10 h-8 rounded-xl glassi border-1 border-black mx-auto hover:bg-blue-300/40 transition-all duration-150 ease-in-out transform active:translate-y-[2px]",children:e.jsx(Se,{children:e.jsx(to,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})})}),e.jsx("p",{className:"text-[9px] mx-auto text-center",children:"Follow"})]})})}),e.jsx("div",{id:"profile-nav",className:"",children:o.map((F,R)=>e.jsxs("button",{onClick:()=>{I(R),a===!0&&s(!1)},onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),className:Le("relative px-4 py-2 rounded-full",L),style:{transformStyle:"preserve-3d"},children:[i.value===F.value&&e.jsx(Ue.div,{layoutId:"clickedbutton",transition:{type:"spring",bounce:.3,duration:.6},className:Le("absolute inset-0 bg-slate-600 dark:bg-zinc-800 rounded-full ",T)}),e.jsx("span",{className:`relative block ${i.value===F.value?"text-white":"text-black dark:text-black"}`,children:F.title})]},F.title))})]})]})},yi=({firstTime:a,tabToRender:s,render:l,className:o,tabs:c,hovering:i})=>{const d=g=>g.value===c[0].value&&!a;return e.jsx("div",{className:"w-full h-full",children:c.map((g,h)=>e.jsx(Ue.div,{layoutId:g.value,style:{scale:1-h*.1,top:i?h*-50:0,zIndex:-h,opacity:h<3?1-h*.1:0},animate:{y:d(g)?[0,10,0]:0},className:Le("flex w-full h-full items-end absolute rounded-2xl border-[1px] border-gray-400 bg-blue-50 treechart-container",o),children:l(s)},g.value))})},ua="http://localhost:3000/api",vi=(a,s)=>{const[l,o]=t.useState([]),[c,i]=t.useState(new Map),[d,g]=t.useState(null),[h,f]=t.useState(!1),[r,S]=t.useState(!0),T=t.useMemo(()=>a.state.user.uid,[a.state.user.uid]),L=t.useCallback(p=>{const x=new Date(p),b=x.getUTCFullYear(),n=String(x.getUTCMonth()+1).padStart(2,"0"),m=String(x.getUTCDate()).padStart(2,"0");return`${b}/${n}/${m}`},[]),C=t.useCallback(p=>{const x=p.split("/"),b=x[0],n=x[1].padStart(2,"0"),m=x[2].padStart(2,"0");return`${b}/${n}/${m}`},[]),y=t.useCallback((p,x)=>{const b={},n={};p.forEach(k=>{const u=L(k.createdAt);b[u]||(b[u]={count:0,commits:0,tasks:0},n[u]={commits:0,tasks:0}),b[u].commits+=1,b[u].count+=1,n[u].commits+=1}),x.forEach(k=>{const u=L(k.completed_at);b[u]||(b[u]={count:0,commits:0,tasks:0},n[u]={commits:0,tasks:0}),b[u].tasks+=1,b[u].count+=1,n[u].tasks+=1});const m=Object.keys(b).map(k=>({date:k,count:b[k].count}));o(m),i(new Map(Object.entries(n))),S(!1)},[L]),N=t.useCallback(async p=>{S(!0);try{const x=await U.get(`${ua}/tasks/get-profile-tasks/${p}`,{params:{year:s},headers:{Authorization:localStorage.getItem("x-token")}}),b=await U.get(`${ua}/commits/get-profile-commits/${p}`,{params:{year:s},headers:{Authorization:localStorage.getItem("x-token")}});y(b.data.commits,x.data.tasks)}catch(x){const b=x;b.response?(console.error("Error fetching notifications:",x),g(b.response.data.message||"An error occurred while fetching data"),f(!0),S(!1)):(g("An error occurred while fetching data"),f(!0),S(!1))}},[s,y]);return t.useEffect(()=>{N(T)},[T,s,N]),t.useMemo(()=>({data:l,detailsMap:c,fetchingUserActivity:r,formatDateFromHeatMap:C,errorMessage:d,errorWhileFetching:h}),[l,c,r,C,d,h])},wi=({user:a,year:s,setYear:l,data:o,detailsMap:c,formatDateFromHeatMap:i,fetchingUserActivity:d,errorWhileFetching:g,errorMessage:h})=>{const f=new Date(a.createdAt).getFullYear(),r=new Date().getFullYear(),S=Array.from({length:r-f+1},(y,N)=>f+N),T=new Date(`${s}/01/01`),L=new Date(`${s}/12/31`),C=({formattedDate:y,details:N})=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("h3",{children:[y," |"]}),e.jsxs("span",{className:"hover:text-yellow-200 transition-colors duration-100",children:["Commits: ",N.commits]}),e.jsxs("span",{className:"hover:text-blue-200 transition-colors duration-100",children:["Tasks: ",N.tasks]})]});return e.jsx("div",{className:"flex flex-col h-full rounded-2xl bg-blue-200/40 border-[1px] border-gray-400",children:d?e.jsx("div",{className:"flex flex-grow justify-center items-center",children:e.jsx(_e,{color:"#0c4a6e",loading:!0})}):g?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsxs("h2",{className:"text-lg font-semibold text-red-400",children:[" ",h," "]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex w-full h-[65px] items-center pt-2 px-[60px] justify-between",children:[e.jsx("div",{className:"flex space-x-3 ",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Activity"})}),e.jsx(Q,{select:!0,value:s,onChange:y=>l(y.target.value),variant:"standard",size:"small",className:"w-40",children:S.map(y=>e.jsx(J,{value:y.toString(),children:y},y))})]}),e.jsx("div",{className:"flex flex-grow justify-center mx-auto  pt-3",children:e.jsx(At,{rectSize:15,value:o,width:1e3,startDate:T,endDate:L,panelColors:{0:"#eff7ff",2:"#90e0ef",4:"#0096c7",10:"#0077b6",20:"#03045e",30:"black"},rectRender:(y,N)=>{const j=i(N.date),p=c.get(j)||{commits:0,tasks:0};return e.jsx(he,{title:e.jsx(C,{formattedDate:j,details:p}),placement:"right",children:e.jsx("rect",{...y})})}})})]})})},Ni=({className:a,children:s,mouseEnter:l})=>e.jsxs("div",{className:Le("bg-[linear-gradient(110deg,#333_0.6%,#222)] p-4 max-h-[20rem] h-full w-full rounded-xl border border-[#eaeaea] dark:border-neutral-600",a),children:[e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(Si,{mouseEnter:l})}),e.jsx("div",{className:"px-2 pb-6",children:s})]}),Ci=({className:a,children:s})=>e.jsx("p",{className:Le("text-base text-white w-[90%] line-clamp-2",a),children:s}),ki=({className:a,children:s,setMouseEnter:l,currentProject:o,navigate:c})=>{const i=()=>{c(`/projects/${we(o.name)}`,{state:{project:{ID:o.pid,name:o.name}}})};return e.jsx("h2",{onClick:(o==null?void 0:o.type)!=="empty"?i:()=>{},onMouseEnter:()=>{l(!0)},onMouseLeave:()=>{l(!1)},className:Le("font-bold text-2xl inline-block text-[#eaeaea] cursor-pointer transition-colors duration-300 hover:text-blue-300 ",a),children:s})},Si=({mouseEnter:a})=>{const[o,c]=t.useState([]),i=t.useRef([]);return t.useEffect(()=>{const d=setInterval(()=>{i.current=Array.from({length:5},()=>Math.floor(Math.random()*90)),c([...i.current])},3e3);return()=>clearInterval(d)},[]),e.jsx("div",{className:"h-[180px] p-1 w-full",style:{display:"grid",gridTemplateColumns:"repeat(18, 1fr)",gap:"1px"},children:[...Array(90)].map((d,g)=>{const h=o.includes(g),f=g%10*.1,r=g*.01;return e.jsxs("div",{className:"relative flex items-center justify-center",children:[e.jsx(Di,{isGlowing:a?!0:h,delay:a?r:f}),a&&e.jsx(ha,{delay:r}),e.jsx(Qe,{mode:"wait",children:h&&e.jsx(ha,{delay:f})})]},`matrix-col-${g}}`)})})},Di=({isGlowing:a,delay:s})=>e.jsx(Ue.div,{initial:{scale:1},animate:{scale:a?[1,1.2,2.5,2.2,1.5]:1,background:a?"#fff":"#666"},transition:{duration:2,ease:"easeInOut",delay:s},className:Le("bg-[#666] h-[1px] w-[1px] rounded-full relative z-20")},s),ha=({delay:a})=>e.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:2,ease:"easeInOut",delay:a},exit:{opacity:0},className:"absolute  left-1/2 -translate-x-1/2 z-10 h-[4px] w-[4px] rounded-full bg-blue-500 blur-[1px] shadow-2xl shadow-blue-400"});function Li({topProjects:a}){const s=Ee(),[l,o]=t.useState(!1),[c,i]=t.useState(0),d=()=>{i(f=>(f+1)%a.length)},g={name:"No projects",description:"This user has no featured projects to show yet.",type:"empty"},h=a.length>0?a[c]:g;return e.jsxs(Ni,{mouseEnter:l,children:[e.jsx(ki,{setMouseEnter:o,currentProject:h,navigate:s,children:h.name}),e.jsxs("div",{className:"flex flex-grow w-full justify-between  min-h-[55px] items-end",children:[e.jsx(Ci,{children:h.description}),a.length>0&&e.jsx("div",{onClick:a.length>0?d:()=>{},className:"h-8 w-8 rounded-full bg-[hsla(0,0%,100%,.1)] flex items-center justify-center cursor-pointer",children:e.jsx(Ti,{})})]})]})}const Ti=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"h-4 w-4 text-white stroke-2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3"})}),$i=({user:a,topRepos:s,topProjects:l,location:o})=>{const[c,i]=t.useState(0),[d,g]=t.useState(new Date().getFullYear().toString()),{data:h,detailsMap:f,formatDateFromHeatMap:r,fetchingUserActivity:S,errorWhileFetching:T,errorMessage:L}=vi(o,d),C=Ee();return t.useEffect(()=>{let N=0;const j=setInterval(()=>{N++,i(N),N>1&&clearInterval(j)},1e3);return()=>clearInterval(j)},[]),e.jsxs("div",{className:"flex flex-col h-[82%] w-[95%] mx-auto justify-end overflow-hidden relative rounded-2xl pb-6  text-xl md:text-4xl",children:[e.jsxs("div",{className:"flex flex-grow min-h-[390px] max-h-[390px] w-full mx-auto",children:[e.jsx("div",{id:"Destacados",className:"flex items-center w-1/2  rounded-lg",children:e.jsx(Li,{topProjects:l})}),e.jsx("div",{id:"Destacados",className:"flex justify-center flex-col w-1/2 rounded-lg space-y-2 px-4",children:s.length===0?e.jsx("div",{className:"p-4 rounded-lg border-[1px] border-gray-400 treechart-container",children:e.jsx("h2",{className:"text-sm font-bold line-clamp-1",children:"No featured repositories to show yet."})}):s.map(y=>e.jsxs("div",{className:"min-h-[95px] p-4 rounded-lg border-[1px] border-gray-400 treechart-container hover:bg-blue-100 transition-colors duration-200 cursor-pointer",onClick:()=>C(`/projects/${we(y.projectID.name)}/${we(y.layerID.name)}/${we(y.name)}`,{state:{project:{ID:y.projectID._id,name:y.projectID.name},layer:{layerID:y.layerID._id,layerName:y.layerID.name},repository:{repoID:y._id,repoName:y.name}}}),children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold line-clamp-1",children:y.name}),e.jsx(wt,{color:"#80ed99",className:"text-2xl"})]}),e.jsx(ce,{className:"line-clamp-2",variant:"body2",children:y.description})]},y._id))})]}),e.jsx("div",{className:"flex min-h-[280px]",children:c>=1&&e.jsx(Qe,{children:e.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},className:"w-full",children:e.jsx(wi,{user:a,year:d,setYear:g,data:h,detailsMap:f,formatDateFromHeatMap:r,fetchingUserActivity:S,errorWhileFetching:T,errorMessage:L})})})})]})},Ei=({projects:a})=>{const s=Ee();return e.jsx("div",{className:"flex items-end h-[80%] w-[95%] mx-auto overflow-hidden rounded-2xl p-2 text-xl md:text-4xl font-bold text-black bg-blue-50",children:e.jsx("div",{className:"flex flex-col flex-grow max-h-[680px] min-h-[680px] w-[95%] mx-auto space-y-4 py-2",children:a.length===0?e.jsx("div",{className:"p-4 rounded-lg border-[1px] border-gray-400 treechart-container",children:e.jsx("h2",{className:"text-sm font-bold line-clamp-1",children:"No projects to show yet."})}):a.map(l=>e.jsxs("div",{className:"flex min-h-[100px] p-4 rounded-lg border-[1px] border-gray-400 treechart-container hover:bg-blue-100 transition-colors duration-200 cursor-pointer",onClick:()=>s(`/projects/${we(l.name)}`,{state:{project:{ID:l.pid,name:l.name}}}),children:[e.jsxs("div",{className:"flex flex-col w-1/2",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h2",{className:"text-lg font-bold line-clamp-1",children:l.name})}),e.jsx(ce,{className:"line-clamp-2 ",variant:"body2",children:l.description})]}),e.jsxs("div",{className:"flex w-1/2 justify-between px-[80px]",children:[e.jsxs("div",{className:"flex space-x-1 items-center",children:[e.jsx(Yt,{className:"w-5 h-5 text-pink-400 mr-3"}),e.jsx("span",{className:"font-semibold text-[15px] text-pink-400 mr-3",children:l.layers})]}),e.jsxs("div",{className:"flex space-x-1 items-center",children:[e.jsx(wt,{className:"w-5 h-5 text-green-400 mr-3"}),e.jsx("span",{className:"font-semibold text-[15px] text-green-400 mr-3",children:l.repositories})]}),e.jsxs("div",{className:"flex space-x-1 items-center",children:[e.jsx(vs,{className:"w-5 h-5 text-yellow-500 mr-3",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx("span",{className:"font-semibold text-[15px] text-yellow-500 mr-3",children:l.commits})]}),e.jsxs("div",{className:"flex space-x-1 items-center",children:[e.jsx(Sa,{className:"w-5 h-5 text-blue-500 mr-3",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),e.jsx("span",{className:"font-semibold text-[15px] text-blue-500 mr-3",children:l.completedTasks})]})]})]},l.pid))})})},ns=[{title:"Overview",value:"overview"},{title:"Projects",value:"projects"}];function Pi({firstTime:a,setFirstTime:s,usersRelation:l,user:o,projects:c,topRepos:i,topProjects:d,location:g,isProfileFollowersModalOpen:h,setIsProfileFollowersModalOpen:f}){const[r,S]=t.useState("overview"),[T,L]=t.useState(ns),[C,y]=t.useState(ns[0]),[N,j]=t.useState(!1),p=t.useMemo(()=>e.jsx($i,{user:o,topRepos:i,topProjects:d,location:g}),[o,g,i,d]),x=b=>{switch(b){case"overview":return p;case"projects":return e.jsx(Ei,{projects:c});default:return p}};return e.jsxs("div",{className:"relative flex h-[97%] flex-col w-[98%] mx-auto  items-start justify-start",children:[e.jsx(bi,{firstTime:a,setFirstTime:s,setTabToRender:S,tabs:ns,setTabs:L,usersRelation:l,user:o,active:C,setActive:y,setHovering:j,isProfileFollowersModalOpen:h,setIsProfileFollowersModalOpen:f}),e.jsx(yi,{firstTime:a,tabToRender:r,render:x,tabs:T,active:C,hovering:N,className:Le("mt-5")},C.value)]})}const is="http://localhost:3000/api",Ii=a=>{const[s,l]=t.useState(!0),[o,c]=t.useState(!1),[i,d]=t.useState(!1),[g,h]=t.useState([]),[f,r]=t.useState([]),[S,T]=t.useState(0),[L,C]=t.useState(0),[y,N]=t.useState(0),[j,p]=t.useState(0),[x,b]=t.useState(0),[n,m]=t.useState(0),[k,u]=t.useState(null),[D,I]=t.useState(!1),F=()=>{d(!0),U.get(`${is}/users/get-flly/${a}?page=${j}`).then(A=>{const{following:_}=A.data;r([...f,..._]),l(!1),d(!1)}).catch(()=>{d(!1)})},R=()=>{c(!0),U.get(`${is}/users/get-fll/${a}?page=${y}`).then(A=>{console.log("fetchMoreFollowers",A);const{followers:_}=A.data;h([...g,..._]),c(!1)}).catch(()=>{c(!1)})},Y=()=>{U.get(`${is}/users/get-profile-followers-following/${a}`).then(A=>{console.log(A);const{followers:_,following:$,followersLength:E,followingLength:w,totalFollowersPages:v,totalFollowingPages:P}=A.data;h(_),r($),T(E),C(w),b(v),m(P),N(1),p(1),l(!1)}).catch(A=>{l(!1),I(!0),u(A.response.data.message||"An error occurred while fetching the data")})};return t.useEffect(()=>{Y()},[]),t.useEffect(()=>{y>1&&R()},[y]),t.useEffect(()=>{j>1&&F()},[j]),{followers:g,following:f,fetchingUsers:s,followersLength:S,followingLength:L,FollowersPage:y,FollowingPage:j,totalFollowersPages:x,totalFollowingPages:n,fetchingMoreFollowers:o,fetchingMoreFollowing:i,setFollowersPage:N,setFollowingPage:p,errorWhileFetching:D,errorMessage:k}},_i=({isProfileFollowersModalOpen:a,setIsProfileFollowersModalOpen:s,profileUID:l})=>{const o=Ee(),[c,i]=t.useState(""),[d,g]=t.useState("followers"),[h,f]=t.useState("followers"),r=t.useRef(null),{followers:S,following:T,fetchingUsers:L,totalFollowersPages:C,totalFollowingPages:y,FollowersPage:N,FollowingPage:j,followersLength:p,followingLength:x,fetchingMoreFollowers:b,fetchingMoreFollowing:n,setFollowersPage:m,setFollowingPage:k,errorWhileFetching:u,errorMessage:D}=Ii(l),I=A=>{switch(A){case"followers":return p;case"following":return x;default:return 0}},F=()=>{const A=document.getElementById("profileFollowersModal");A&&(A.classList.replace("opacity-100","opacity-0"),setTimeout(()=>{s(!1)},500))},R=A=>{switch(A){case"followers":return Y.length>0?Y.map((_,$)=>e.jsx("div",{className:"flex space-x-4 w-full items-center border-b-2 py-3 px-3 hover:bg-gray-200 transition-colors duration-200 cursor-pointer",onClick:()=>{o(`/profile/${Ot(_.username)}`,{state:{user:{uid:_.uid,username:_.username}}}),F()},children:e.jsxs("div",{className:"flex space-x-4 w-[85%]  h-full items-center",children:[e.jsx("img",{src:_.photoUrl||us(_.username),alt:"profile",className:"w-10 h-10 rounded-full cursor-pointer"}),e.jsxs("h4",{className:"",children:[e.jsx("span",{className:"font-semibold",children:"@"}),_.username]})]})},$)):e.jsx("div",{className:"flex w-full h-full  items-center justify-center",children:e.jsx("p",{children:"No followers"})});case"following":return Y.length>0?Y.map((_,$)=>e.jsx("div",{className:"flex space-x-4 w-full items-center border-b-2 py-3 px-3 hover:bg-gray-200 transition-colors duration-200 cursor-pointer",onClick:()=>{o(`/profile/${Ot(_.username)}`,{state:{user:{uid:_.uid,username:_.username}}}),F()},children:e.jsxs("div",{className:"flex space-x-4 w-[85%] h-full items-center",children:[e.jsx("img",{src:_.photoUrl||us(_.username),alt:"profile",className:"w-10 h-10 rounded-full cursor-pointer"}),e.jsxs("h4",{children:[e.jsx("span",{className:"font-semibold",children:"@"}),_.username]})]})},$)):e.jsx("div",{className:"flex w-full h-full  items-center justify-center",children:e.jsx("p",{children:"No following"})})}},Y=t.useMemo(()=>{let A=[];return h==="followers"?A=S.map(_=>_.followerId):h==="following"&&(A=T.map(_=>_.uid)),A.filter(_=>_.username.toLowerCase().includes(c.toLowerCase()))},[c,S,T,h]);return t.useEffect(()=>{if(a){const A=setTimeout(()=>{var _,$;(_=document.getElementById("profileFollowersModal"))==null||_.classList.remove("opacity-0"),($=document.getElementById("profileFollowersModal"))==null||$.classList.add("opacity-100")},20);return()=>clearTimeout(A)}},[a]),t.useEffect(()=>{if(a){const A=()=>{const $=r==null?void 0:r.current;$&&$.scrollTop+$.clientHeight>=$.scrollHeight-5&&(h==="followers"&&N<C&&!b?m(E=>E+1):h==="following"&&j<y&&!n&&k(E=>E+1))},_=r.current;return _&&_.addEventListener("scroll",A),()=>{_&&_.removeEventListener("scroll",A)}}},[a,h,N,j,C,y,b,n]),e.jsx("div",{className:"fixed flex w-screen h-full pb-5 top-0 right-0 justify-center items-center bg-black/30 z-50",children:e.jsxs("div",{id:"profileFollowersModal",className:`flex flex-col space-y-3 w-[70%] md:w-[50%] md:max-h-[635px] md:h-[635px] overflow-hidden items-center rounded-2xl bg-white glassi border-[1px] border-gray-400 transition-opacity duration-300 ease-in-out opacity-0 ${a?"":"pointer-events-none"}`,children:[e.jsxs("div",{className:"flex justify-between w-[95%] h-12 ml-auto mr-auto mt-2 p-2",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:[e.jsxs("span",{children:[" ",dt(I(d))," "]}),"  ",xt(d)]}),e.jsx("button",{onClick:F,children:e.jsx($e,{})})]}),e.jsxs("div",{className:"flex flex-col w-full h-full",children:[e.jsxs("div",{className:"flex w-[92%] mx-auto h-11 border-b-2",children:[e.jsx("button",{onClick:()=>{g("following"),f("following")},className:` ${d==="following"?"bg-gray-200":""} flex w-1/2 justify-center items-center text-center text-sm hover:bg-gray-200 transition-colors duration-200`,children:e.jsx("h4",{children:"Following"})}),e.jsx("button",{onClick:()=>{g("followers"),f("followers")},className:` ${d==="followers"?"bg-gray-200":""} flex w-1/2 justify-center items-center text-center text-sm hover:bg-gray-200 transition-colors duration-200`,children:e.jsx("h4",{children:"Followers"})})]}),e.jsxs("div",{className:"flex flex-grow space-y-4 flex-col w-full h-full overflow-y-auto  pt-5 px-8",children:[e.jsx(Q,{variant:"outlined",label:"Search",size:"small",className:"w-full",value:c,onChange:A=>i(A.target.value)}),e.jsxs("div",{ref:r,id:"render",className:"flex flex-col flex-grow  overflow-y-auto max-h-[445px]",children:[e.jsx("div",{className:"flex flex-col flex-grow",children:L?e.jsx("div",{className:"flex w-full h-full items-center justify-center",children:e.jsx(_e,{color:"#000",loading:L})}):u?e.jsx("div",{className:"flex w-full h-full items-center justify-center",children:e.jsx("p",{children:D})}):R(d)}),b||n&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(_e,{color:"#000",loading:!0,className:"w-8 h-8"})})]})]})]})]})})},Ai=()=>{const a=ye(),[s,l]=t.useState(!0),[o,c]=t.useState(!1),{usersRelation:i,profile:d,topRepos:g,topProjects:h,profileProjects:f,fetchingUserData:r,errorWhileFetching:S,errorMessage:T}=ji(a);return r?e.jsx("div",{className:"flex w-full h-full justify-center items-center",children:e.jsx(_e,{color:"#0c4a6e",loading:!0})}):e.jsxs("div",{className:"flex flex-col w-full h-full py-4",children:[o&&e.jsx(_i,{isProfileFollowersModalOpen:o,setIsProfileFollowersModalOpen:c,profileUID:d==null?void 0:d.uid,profileName:d==null?void 0:d.username}),S?e.jsx("div",{className:"flex w-full h-full justify-center items-center",children:e.jsx("p",{className:"text-xl text-red-500",children:T})}):e.jsx(Pi,{firstTime:s,setFirstTime:l,usersRelation:i,user:d,projects:f,topRepos:g,topProjects:h,location:a,isProfileFollowersModalOpen:o,setIsProfileFollowersModalOpen:c})]})},Fi=()=>e.jsx(Jo,{children:e.jsxs(js,{children:[e.jsxs(Pe,{path:"dashboard",element:e.jsx(ml,{}),children:[e.jsx(Pe,{path:"workspace",element:e.jsx(gl,{}),children:e.jsx(Pe,{path:":taskName",element:e.jsx(El,{})})}),e.jsx(Pe,{path:"resources",element:e.jsx(Fl,{})})]}),e.jsx(Pe,{path:"projects",element:e.jsx(Gl,{}),children:e.jsxs(Pe,{path:":projectName",element:e.jsx(nn,{}),children:[e.jsx(Pe,{path:":layerName",element:e.jsx(yn,{}),children:e.jsx(Pe,{path:":repoName",element:e.jsx(Mn,{}),children:e.jsx(Pe,{path:":commits",element:e.jsx(Bn,{}),children:e.jsx(Pe,{path:":commitHash",element:e.jsx(Wn,{})})})})}),e.jsx(Pe,{path:"activity",element:e.jsx(oi,{})}),e.jsx(Pe,{path:"tree",element:e.jsx(ti,{})}),e.jsx(Pe,{path:"comments",element:e.jsx(Yn,{})})]})}),e.jsx(Pe,{path:"personal-area/:username",element:e.jsx(gi,{})}),e.jsx(Pe,{path:"profile/:username",element:e.jsx(Ai,{})}),e.jsx(Pe,{path:"searcher",element:e.jsx(Xn,{})})]})}),Mi="http://localhost:3000/api",Ri=()=>{const a=gt(),[s,l]=t.useState(!0),o=localStorage.getItem("x-token"),c=async d=>(await U.post(`${Mi}/auth/me`,{},{headers:{Authorization:d}})).data,i=async()=>{if(!o){l(!1),a(ct({}));return}try{const d=await c(o);if(!d.state){l(!1),a(ct({}));return}a(Ao(d)),l(!1)}catch{l(!1),a(ct({}))}};return t.useEffect(()=>{a(Ss()),i()},[a,o]),{loading:s}},zi=a=>a.pathname.startsWith("/callback")&&a.search.includes("code="),Ui=()=>{const{status:a}=Ds(),{loading:s}=Ri(),l=ye();return zi(l)?e.jsx(Oa,{}):s?e.jsx(Tt,{}):a==="checking"?e.jsx(Tt,{}):e.jsxs(js,{children:[e.jsx(Pe,{path:"/user/*",element:e.jsx(Oo,{children:e.jsx(Uo,{})})}),e.jsx(Pe,{path:"/*",element:e.jsx(Bo,{children:e.jsx(Fi,{})})})]})};function Bi(){return e.jsx(rr,{children:e.jsx(Ui,{})})}const Oi=lr({reducer:{auth:za.reducer,projects:Xa.reducer,platypus:Qa.reducer},middleware:a=>a()});ar.createRoot(document.getElementById("root")).render(e.jsx(sr.StrictMode,{children:e.jsx(or,{store:Oi,children:e.jsx(nr,{clientId:"754198416776-tdp7nlbtbav41n4a614ng9330o1a8rb1.apps.googleusercontent.com",children:e.jsx(Bi,{})})})}));
